100 RANDOMIZE
110 GOTO 170
120 FOR I=1 TO LEN(H$)
130 R=ASC(SEG$(H$,I,1))
140 CALL HCHAR(ROW,XCOL+I,R)
150 NEXT I
160 RETURN
170 A=96
180 B=97
190 C=104
200 D=105
210 Z=24
220 COL=16
230 W=0
240 G=0
250 S=J
260 CALL CLEAR
270 GOSUB 1250
280 CALL SCREEN(16)
290 PRINT "        G O B L I N"
300 PRINT
310 PRINT "          HS : "
320 FOR I=1 TO 19
330 PRINT
340 NEXT I
350 PRINT "[=LEFT              ]=RIGHT";
360 ROW=4
370 XCOL=17
380 H$=STR$(HS)
390 GOSUB 120
400 FOR I=1 TO 50
410 X=INT(RND*30)+2
420 Y=INT(RND*16)+6
430 CALL GCHAR(Y,X,L)
440 IF L=B THEN 410
450 CALL HCHAR(Y,X,B)
460 NEXT I
470 FOR I=1 TO 27
480 X=INT(RND*30)+2
490 Y=INT(RND*16)+6
500 CALL GCHAR(Y,X,L)
510 IF (L=B)+(L=C)+(L=D)THEN 480
520 CALL GCHAR(Y+1,X-1,L)
530 CALL GCHAR(Y+1,X,M)
540 CALL GCHAR(Y+1,X+1,N)
550 IF (L<>B)+(M<>B)+(N<>B)THEN 590
560 CALL HCHAR(Y,X,D)
570 G=G+1
580 GOTO 600
590 CALL HCHAR(Y,X,C)
600 NEXT I
610 CALL SOUND(100,500,6)
620 CALL HCHAR(Z,COL,32)
630 IF L<>C THEN 650
640 CALL SOUND(10,880,4)
650 Z=Z-1
660 IF Z>4 THEN 680
670 Z=23
680 CALL KEY(0,L,ST)
690 IF (L<>83)*(L<>68)THEN 740
700 IF L<>83 THEN 730
710 COL=COL-SGN(COL-2)
720 GOTO 740
730 COL=COL+SGN(31-COL)
740 CALL GCHAR(Z,COL,L)
750 IF L=B THEN 1030
760 IF L=C THEN 820
770 CALL HCHAR(Z,COL,A)
780 FOR I=1 TO 25
790 NEXT I
800 IF W=27-G THEN 890
810 GOTO 620
820 W=W+1
830 S=S+25
840 H$=STR$(S)
850 ROW=4
860 XCOL=3
870 GOSUB 120
880 GOTO 770
890 J=S
900 CALL HCHAR(10,1,32,31)
910 GOSUB 120
920 H$="**** ALL RIGHT! ****"
930 XCOL=6
940 ROW=10
950 GOSUB 120
960 FOR I=1 TO 15
970 X=INT(RND*100)+300
980 CALL SOUND(75,X,8)
990 NEXT I
1000 FOR I=1 TO 100
1010 NEXT I
1020 GOTO 210
1030 REM WHOOPS! ...YOU CRASHED...
1040 CALL HCHAR(Z,COL,98)
1050 FOR I=3 TO 30 STEP 3
1060 CALL SOUND(50,-7,I)
1070 NEXT I
1080 CALL CHAR(104,"3C42A581A599423C")
1090 J=0
1100 IF S>HS THEN 1110 ELSE 1120
1110 HS=S
1120 H$="PLAY AGAIN (Y / N)?"
1130 ROW=22
1140 XCOL=2
1150 GOSUB 120
1160 CALL KEY(0,L,ST)
1170 IF ST=0 THEN 1160
1180 H$=CHR$(L)
1190 IF H$="Y" THEN 1230
1200 CALL CLEAR
1210 PRINT "SEE YA!"
1220 STOP
1230 CALL CHAR(104,"3C3CA58199A5423C")
1240 GOTO 210
1250 REM DEFINE CUSTOM CHARS
1260 REM CHAR 96 - GOBLIN
1270 CALL CHAR(96,"7EDBDBFFA55A5AA5")
1280 REM CHAR 97 - BARRIER
1290 CALL CHAR(97,"CCCC3333CCCC3333")
1300 REM CHAR 98 - CRUNCHED GOBLIN
1310 CALL CHAR(98,"CCCC33337EDBFFBD")
1320 REM CHAR - 104 - FROWN
1330 CALL CHAR(104,"3C3CA58199A5423C")
1340 REM CHAR - 105 - SMILE
1350 CALL CHAR(105,"3C42A581A599423C")
1360 CALL COLOR(10,7,1)
1370 CALL CHAR(91,"102040FF40201")
1380 CALL CHAR(93,"080402FF020408")
1390 FOR I=5 TO 8
1400 CALL COLOR(I,2,12)
1410 NEXT I
1420 RETURN
1430 END
