100 REM  TIC-TAC-TOE
110 REM
120 CALL CLEAR
130 PRINT TAB(9);"TIC-TAC-TOE"
140 PRINT : : :"TRY TO GET THREE IN A ROW.": : :
150 FOR C=104 TO 114
160 READ C$
170 CALL CHAR(C,C$)
180 NEXT C
190 DATA 00030C102020404,FF,00C0300804040202,808080808080808,0101010101010101,40402020100C03
200 DATA 00000000000000FF,020204040830C,8040201008040201,010204081020408,8142241818244281
210 CALL COLOR(10,7,1)
220 CALL COLOR(11,5,1)
230 FOR C=1 TO 9
240 READ X(C),Y(C)
250 NEXT C
260 DATA 6,9,6,15,6,21,12,9,12,15,12,21,18,9,18,15,18,21
270 FOR I=1 TO 9
280 T(I)=0
290 NEXT I
300 FL=0
310 PRINT :"PRESS 1 FOR AMATEUR"
320 PRINT TAB(7);"2 FOR PROFESSIONAL"
330 CALL KEY(0,K,S)
340 IF (K<49)+(K>50)THEN 330
350 L=K-48
360 PRINT : :"PRESS 1 -- X, FIRST MOVE"
370 PRINT TAB(7);"2 -- O, SECOND MOVE"
380 CALL SOUND(150,1497,2)
390 CALL KEY(0,K,S)
400 IF (K<49)+(K>50)THEN 390
410 C=K-48
420 CALL CLEAR
430 FOR I=1 TO 11
440 RANDOMIZE
450 CALL SOUND(-100,INT(RND*900+500),2)
460 CALL HCHAR(2,10+I,ASC(SEG$("TIC-TAC-TOE",I,1)))
470 NEXT I
480 CO=INT(RND*8)+9
490 CALL COLOR(9,CO,CO)
500 CALL VCHAR(5,13,96,17)
510 CALL VCHAR(5,19,96,17)
520 CALL HCHAR(10,8,96,17)
530 CALL HCHAR(16,8,96,17)
540 FOR I=1 TO 9
550 CALL HCHAR(X(I)+1,Y(I)+1,48+I)
560 NEXT I
570 IF L=1 THEN 2180
580 IF C=1 THEN 1530
590 A=-1
600 B=1
610 IF T(5)<>0 THEN 650
620 T(5)=-1
630 M=5
640 GOTO 1510
650 IF T(5)<>1 THEN 700
660 IF T(1)<>0 THEN 740
670 T(1)=-1
680 M=1
690 GOTO 1510
700 IF (T(2)=1)+(T(1)=0)=-2 THEN 1390
710 IF (T(4)=1)+(T(1)=0)=-2 THEN 1390
720 IF (T(6)=1)+(T(9)=0)=-2 THEN 1490
730 IF (T(8)=1)+(T(9)=0)=-2 THEN 1490
740 IF A<>1 THEN 830
750 D=3*INT((M-1)/3)+1
760 IF D<>M THEN 780
770 L=1
780 IF D+1<>M THEN 800
790 L=2
800 IF D+2<>M THEN 850
810 L=3
820 GOTO 850
830 FOR D=1 TO 7 STEP 3
840 FOR L=1 TO 3
850 IF T(D)<>A THEN 910
860 IF T(D+2)<>A THEN 970
870 IF T(D+1)<>0 THEN 1020
880 T(D+1)=-1
890 M=D+1
900 GOTO 1510
910 IF T(D)=B THEN 1020
920 IF T(D+2)<>A THEN 1020
930 IF T(D+1)<>A THEN 1020
940 T(D)=-1
950 M=D
960 GOTO 1510
970 IF T(D+2)<>0 THEN 1020
980 IF T(D+1)<>A THEN 1020
990 T(D+2)=-1
1000 M=D+2
1010 GOTO 1510
1020 IF T(L)<>A THEN 1080
1030 IF T(L+6)<>A THEN 1140
1040 IF T(L+3)<>0 THEN 1190
1050 T(L+3)=-1
1060 M=L+3
1070 GOTO 1510
1080 IF T(L)=B THEN 1190
1090 IF T(L+6)<>A THEN 1190
1100 IF T(L+3)<>A THEN 1190
1110 T(L)=-1
1120 M=L
1130 GOTO 1510
1140 IF T(L+6)<>0 THEN 1190
1150 IF T(L+3)<>A THEN 1190
1160 T(L+6)=-1
1170 M=L+6
1180 GOTO 1510
1190 IF A=1 THEN 1230
1200 IF (D=7)+(L=3)=-2 THEN 1230
1210 NEXT L
1220 NEXT D
1230 IF T(5)<>A THEN 1280
1240 IF (T(3)=A)+(T(7)=0)=-2 THEN 1460
1250 IF (T(9)=A)+(T(1)=0)=-2 THEN 1390
1260 IF (T(7)=A)+(T(3)=0)=-2 THEN 1430
1270 IF (T(9)=0)+(T(1)=A)=-2 THEN 1490
1280 IF A<>-1 THEN 1320
1290 A=1
1300 B=-1
1310 GOTO 740
1320 IF (T(9)=1)+(T(3)=0)=-2 THEN 1420
1330 FOR I=2 TO 9
1340 IF T(I)<>0 THEN 1380
1350 T(I)=-1
1360 M=I
1370 GOTO 1510
1380 NEXT I
1390 T(1)=-1
1400 M=1
1410 GOTO 1510
1420 IF T(1)=1 THEN 1330
1430 T(3)=-1
1440 M=3
1450 GOTO 1510
1460 T(7)=-1
1470 M=7
1480 GOTO 1510
1490 T(9)=-1
1500 M=9
1510 CALL SOUND(100,440,2)
1520 GOSUB 1640
1530 CALL SOUND(100,1497,2)
1540 CALL KEY(0,K,S)
1550 IF S<1 THEN 1540
1560 IF (K<49)+(K>57)THEN 1530
1570 M=K-48
1580 IF T(M)<>0 THEN 1530
1590 A=1
1600 T(M)=1
1610 GOSUB 1640
1620 IF L=1 THEN 2190 ELSE 590
1630 STOP
1640 C=ABS(C-1)
1650 ON C+1 GOTO 1660,1720
1660 CALL HCHAR(X(M),Y(M),112) 
1670 CALL HCHAR(X(M),Y(M)+2,113) 
1680 CALL HCHAR(X(M)+1,Y(M)+1,114) 
1690 CALL HCHAR(X(M)+2,Y(M),113) 
1700 CALL HCHAR(X(M)+2,Y(M)+2,112)
1710 GOTO 1810
1720 CALL HCHAR(X(M),Y(M),104)
1730 CALL HCHAR(X(M),Y(M)+1,105)
1740 CALL HCHAR(X(M),Y(M)+2,106)
1750 CALL HCHAR(X(M)+1,Y(M),107)
1760 CALL HCHAR(X(M)+1,Y(M)+2,108)
1770 CALL HCHAR(X(M)+2,Y(M),109)
1780 CALL HCHAR(X(M)+2,Y(M)+1,110)
1790 CALL HCHAR(X(M)+2,Y(M)+2,111)
1800 CALL HCHAR(X(M)+1,Y(M)+1,32)
1810 FOR I=1 TO 7 STEP 3
1820 IF T(I)<>T(I+1)THEN 1860
1830 IF T(I)<>T(I+2)THEN 1860
1840 IF T(I)=-1 THEN 2050
1850 IF T(I)=1 THEN 2030
1860 NEXT I
1870 FOR I=1 TO 3
1880 IF T(I)<>T(I+3)THEN 1920
1890 IF T(I)<>T(I+6)THEN 1920
1900 IF T(I)=-1 THEN 2050
1910 IF T(I)=1 THEN 2030
1920 NEXT I
1930 FOR I=1 TO 9
1940 IF T(I)=0 THEN 1970
1950 NEXT I
1960 FL=1
1970 IF T(5)<>A THEN 2000
1980 IF (T(1)=A)+(T(9)=A)=-2 THEN 2020
1990 IF (T(3)=A)+(T(7)=A)=-2 THEN 2020
2000 IF FL=1 THEN 2070
2010 RETURN
2020 IF A=-1 THEN 2050
2030 PRINT "YOU WON!!"
2040 GOTO 2080
2050 PRINT "COMPUTER WINS!!"
2060 GOTO 2080
2070 PRINT "IT'S A TIE."
2080 FOR I=1 TO 20
2090 CALL SOUND(100,INT(RND*500)+500,2)
2100 NEXT I
2110 PRINT :"TRY AGAIN? (Y/N)"
2120 CALL SOUND(100,1497,2)
2130 CALL KEY(0,K,S)
2140 IF K=89 THEN 270
2150 IF K<>78 THEN 2130
2160 CALL CLEAR
2170 STOP
2180 IF C=1 THEN 1530
2190 M=INT(RND*9)+1
2200 IF T(M)<>0 THEN 2190
2210 A=-1
2220 T(M)=-1
2230 GOSUB 1640
2240 GOTO 1530
2250 END
