110 CALL CLEAR
120 PRINT TAB(7);"** FLIP FLOP **": : : :"USE THE ARROW KEYS TO MOVE": :"THEN PRESS <ENTER>.": :
130 DIM D(3),NX(18),NY(18)
140 FOR C=96 TO 128 STEP 8
150 CALL CHAR(C,"FF818181818181FF")
160 NEXT C
170 CALL COLOR(11,2,16)
180 CALL COLOR(12,2,6)
190 CALL COLOR(13,2,7)
200 C$="          HHHHHHHH"
210 D(1)=-1
220 D(2)=0
230 D(3)=1
240 X=11
250 Y=17
260 PRINT : :"   p YOUR MARKERS": :"   x COMPUTER"
270 PRINT : :"CHOOSE:": :"   1  FIRST MOVE": :"   2  SECOND MOVE"
280 CALL KEY(0,K,S)
290 IF (K<49)+(K>50)THEN 280
300 P=K-48
310 P1=P
320 G1=104+P*8
330 CALL CLEAR
340 PRINT C$:C$:C$:C$:C$:C$:C$:C$: : : : : : : :
350 FOR C=11 TO 14
360 CALL HCHAR(C,15,96,4)
370 NEXT C
380 CALL HCHAR(12,16,112)
390 CALL HCHAR(12,17,120)
400 CALL HCHAR(13,16,120)
410 CALL HCHAR(13,17,112)
420 T=5
430 IF P=2 THEN 1100
440 CALL GCHAR(X,Y,GA)
450 CALL KEY(0,K,S)
460 CALL HCHAR(X,Y,128)
470 CALL HCHAR(X,Y,GA)
480 IF K=13 THEN 690
490 IF K<>69 THEN 520
500 X=X-1
510 GOTO 600
520 IF K<>68 THEN 550
530 Y=Y+1
540 GOTO 600
550 IF K<>83 THEN 580
560 Y=Y-1
570 GOTO 600
580 IF K<>88 THEN 450
590 X=X+1
600 IF X>8 THEN 620
610 X=9
620 IF X<17 THEN 640
630 X=16
640 IF Y>12 THEN 660
650 Y=13
660 IF Y<21 THEN 680
670 Y=20
680 GOTO 440
690 IF GA=96 THEN 730
700 CALL SOUND(50,330,2)
710 CALL SOUND(50,262,2)
720 GOTO 450
730 CALL SOUND(100,1400,2)
740 CALL HCHAR(X,Y,128)
750 GOSUB 1420
760 IF N>0 THEN 860
770 GOSUB 1300
780 IF FL=0 THEN 700
790 CALL SOUND(500,-1,4)
800 FOR C=1 TO 7
810 CALL HCHAR(24,C+2,ASC(SEG$("NO MOVE",C,1)))
820 NEXT C
830 CALL SOUND(1,-1,30)
840 CALL HCHAR(24,3,32,7)
850 GOTO 1060
860 CALL HCHAR(X,Y,G1)
870 CALL SOUND(100,523,4)
880 FOR I=X-1 TO X+1
890 FOR J=Y-1 TO Y+1
900 CALL GCHAR(I,J,G)
910 IF G<>104 THEN 930
920 CALL HCHAR(I,J,96)
930 NEXT J
940 NEXT I
950 GOSUB 1740
960 T=T+1
970 IF T=65 THEN 1780
980 FOR I=9 TO 16
990 FOR J=13 TO 20
1000 CALL GCHAR(I,J,G)
1010 IF G<=104 THEN 1030
1020 IF G<>G1 THEN 1060
1030 NEXT J
1040 NEXT I
1050 GOTO 1780
1060 P=1-SGN(P-2)
1070 G1=P*8+104
1080 ON P GOTO 440,1100
1090 REM  COMPUTER
1100 Z=-1
1110 FOR X=9 TO 16
1120 FOR Y=13 TO 20
1130 X1=X-8
1140 Y1=Y-12
1150 CALL GCHAR(X,Y,G)
1160 IF G<>96 THEN 1230
1170 GOSUB 1420
1180 IF N=0 THEN 1230
1190 IF N<=Z THEN 1230
1200 Z=N
1210 IX=X
1220 IY=Y
1230 NEXT Y
1240 NEXT X
1250 IF Z<=0 THEN 790
1260 X=IX
1270 Y=IY
1280 CALL HCHAR(X,Y,G1)
1290 GOTO 750
1300 FL=0
1310 FOR II=9 TO 16
1320 FOR JJ=13 TO 20
1330 CALL GCHAR(II,JJ,G)
1340 IF G<>96 THEN 1390
1350 GOSUB 1420
1360 IF N=0 THEN 1390
1370 FL=1
1380 GOTO 1410
1390 NEXT JJ
1400 NEXT II
1410 RETURN
1420 N=1
1430 FOR C=1 TO 3
1440 FOR A=1 TO 3
1450 I=X+D(C)
1460 J=Y+D(A)
1470 IF I<>X THEN 1490
1480 IF J=Y THEN 1700
1490 CALL GCHAR(I,J,G)
1500 IF P=1 THEN 1520
1510 IF G=112 THEN 1530 ELSE 1700
1520 IF G<>120 THEN 1700
1530 I=I+D(C)
1540 J=J+D(A)
1550 CALL GCHAR(I,J,G)
1560 IF G<=104 THEN 1700
1570 IF P=1 THEN 1590
1580 IF G=120 THEN 1600 ELSE 1530
1590 IF G<>112 THEN 1530
1600 I=X+D(C)
1610 J=Y+D(A)
1620 CALL GCHAR(I,J,G)
1630 IF G=G1 THEN 1700
1640 NX(N)=I
1650 NY(N)=J
1660 N=N+1
1670 I=I+D(C)
1680 J=J+D(A)
1690 GOTO 1620
1700 NEXT A
1710 NEXT C
1720 N=N-1
1730 RETURN
1740 FOR C=1 TO N
1750 CALL HCHAR(NX(C),NY(C),G1)
1760 NEXT C
1770 RETURN
1780 T1=0
1790 T2=0
1800 FOR I=9 TO 16
1810 FOR J=13 TO 20
1820 CALL GCHAR(I,J,G)
1830 IF G<112 THEN 1900
1840 IF G=120 THEN 1880
1850 T1=T1+1
1860 CALL SOUND(-50,523,4)
1870 GOTO 1900
1880 T2=T2+1
1890 CALL SOUND(-50,262,4)
1900 NEXT J
1910 NEXT I
1920 PRINT CHR$(112);T1
1930 PRINT CHR$(120);T2
1940 IF T1<>T2 THEN 1970
1950 PRINT :"TIE GAME"
1960 GOTO 2010
1970 IF T1>T2 THEN 2000
1980 PRINT :CHR$(120);" COMPUTER WINS"
1990 GOTO 2010
2000 PRINT :CHR$(112);" YOU WIN"
2010 PRINT :"PLAY AGAIN? (Y/N)";
2020 CALL KEY(0,K,S)
2030 IF K=89 THEN 240
2040 IF K<>78 THEN 2020
2050 CALL CLEAR
2060 END
