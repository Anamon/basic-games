100 REM  WORDSEARCH
110 DIM L$(26),N$(20),M$(20,20)
120 CALL CLEAR
130 PRINT TAB(9);"WORDSEARCH": : : :
140 PRINT "YOU MAY ENTER UP TO TWENTY"
150 PRINT :"WORDS.  THEY WILL BE"
160 PRINT :"PLACED HORIZONTALLY,"
170 PRINT :"VERTICALLY, OR DIAGONALLY"
180 PRINT :"IN A WORDSEARCH PUZZLE.": : :
190 FOR C=1 TO 26
200 L$(C)=CHR$(64+C)
210 NEXT C
220 FOR A=1 TO 20
230 FOR C=1 TO 20
240 M$(A,C)="."
250 NEXT C
260 NEXT A
270 INPUT "HOW MANY WORDS? ":W
280 IF W<21 THEN 310
290 PRINT :"SORRY 20 OR LESS.": :
300 GOTO 270
310 FOR C=1 TO W
320 INPUT "WORD: ":N$(C)
330 A=0
340 L=LEN(N$(C))
350 IF L<20 THEN 380
360 PRINT :"SORRY, MUST BE SHORTER."::
370 GOTO 320
380 A=A+1
390 IF A<100 THEN 490
400 PRINT :"COULDN'T FIT WORD IN."
410 PRINT :"CHOOSE:  1 START ALL OVER"
420 PRINT TAB(10);"2 TRY ANOTHER WORD"
430 PRINT TAB(10);"3 STOP NOW"
440 CALL SOUND(150,1497,2)
450 CALL KEY(0,K,S)
460 IF (K<49)+(K>51)THEN 450
470 CALL CLEAR
480 ON K-48 GOTO 220,320,1160
490 D=1
500 E=1
510 F=-1
520 RANDOMIZE
530 IF RND<=.5 THEN 550
540 F=1
550 G=-1
560 IF RND<=.5 THEN 580
570 G=1
580 H=2
590 IF F<>1 THEN 610
600 D=0
610 IF G<>1 THEN 630
620 E=0
630 IF RND<.75 THEN 650
640 H=1
650 IF RND>.25 THEN 670
660 H=0
670 COL=20
680 ROW=20
690 IF H<>1 THEN 710
700 ROW=20-L
710 IF H<>0 THEN 730
720 COL=20-L
730 IF H<=1 THEN 760
740 ROW=20-L
750 COL=20-L
760 IF COL<>20 THEN 780
770 E=0
780 IF ROW<>20 THEN 800
790 D=0
800 II=INT(ROW*RND+1)
810 IJ=INT(COL*RND+1)
820 I=II+D*L
830 J=IJ+E*L
840 IF H=1 THEN 1060
850 IF H=0 THEN 960
860 FOR P=1 TO L
870 IF M$(J+(P-1)*G,I+(P-1)*F)="." THEN 890
880 IF M$(J+(P-1)*G,I+(P-1)*F)<>SEG$(N$(C),P,1)THEN 380
890 NEXT P
900 A=0
910 FOR P=1 TO L-1
920 M$(J+P*G,I+P*F)=SEG$(N$(C),P+1,1)
930 NEXT P
940 M$(J,I)=SEG$(N$(C),1,1)
950 GOTO 1150
960 FOR P=1 TO L
970 IF M$(J+(P-1)*G,I)="." THEN 990
980 IF M$(J+(P-1)*G,I)<>SEG$(N$(C),P,1)THEN 380
990 NEXT P
1000 A=0
1010 FOR P=1 TO L-1
1020 M$(J+P*G,I)=SEG$(N$(C),P+1,1)
1030 NEXT P
1040 M$(J,I)=SEG$(N$(C),1,1)
1050 GOTO 1150
1060 FOR P=1 TO L
1070 IF M$(J,I+(P-1)*F)="." THEN 1090
1080 IF M$(J,I+(P-1)*F)<>SEG$(N$(C),P,1)THEN 380
1090 NEXT P
1100 A=0
1110 FOR P=1 TO L-1
1120 M$(J,I+P*F)=SEG$(N$(C),P+1,1)
1130 NEXT P
1140 M$(J,I)=SEG$(N$(C),1,1)
1150 NEXT C
1160 PRINT :"ONE MOMENT PLEASE."
1170 FOR A=1 TO 20
1180 FOR B=1 TO 20
1190 IF M$(A,B)<>"." THEN 1210
1200 M$(A,B)=L$(INT(26*RND+1))
1210 NEXT B
1220 NEXT A
1230 CALL CLEAR
1240 FOR A=1 TO 20
1250 FOR B=1 TO 20
1260 PRINT M$(A,B);
1270 NEXT B
1280 PRINT
1290 NEXT A
1300 END
