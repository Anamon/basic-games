100 REM  CLOSEOUT
110 CALL CLEAR
120 PRINT TAB(7);"************"
130 PRINT TAB(7);"* CLOSEOUT *"
140 PRINT TAB(7);"************"
150 PRINT : : :"YOU ARE THE RED SHOPPER."
160 PRINT :"USE ARROW KEYS TO MOVE."
170 PRINT :"USE SPACE BAR TO SHOVE."
180 PRINT :"A SHOVE COSTS YOU 25 POINTS.": : : : :
190 CALL CHAR(96,"0000FFFFFFFF")
200 CALL COLOR(9,5,1)
210 CALL CHAR(104,"0000001818")
220 CALL CHAR(112,"383810FE10282828")
230 CALL COLOR(11,7,1)
240 CALL CHAR(120,"383810FE10282828")
250 CALL COLOR(13,3,1)
260 A$=CHR$(96)
270 B$=CHR$(104)
280 FOR I=1 TO 5
290 A$=A$&A$
300 B$=B$&B$
310 NEXT I
320 A$=SEG$(A$,1,28)
330 B$=SEG$(B$,1,28)
340 PRINT "PRESS <ENTER>"
350 CALL KEY(0,K,S)
360 IF K<>13 THEN 350
370 R=0
380 SC=0
390 SH=2
400 FOR L=0 TO 1
410 E(L,0)=6
420 EG(L)=104
430 EX(L)=0
440 NEXT L
450 CALL CLEAR
460 R=R+1
470 SH=SH+1
480 T=0
490 RANDOMIZE
500 CALL COLOR(10,INT(RND*12)+5,1)
510 PRINT "CLOSEOUT";TAB(19);"ROUND";R: :
520 PRINT A$:B$:A$:B$:A$:B$:A$:B$:A$:B$:A$:B$:A$:B$:A$:B$:A$
530 PRINT :"SCORE:";SC,"SHOVES:";SH
540 CALL VCHAR(6,3,45,15)
550 CALL VCHAR(6,30,45,15)
560 FOR I=1 TO 7
570 R1(I)=INT(RND*23)+5
580 FOR J=1 TO I-1
590 IF ABS(R1(J)-R1(I))<2 THEN 570
600 NEXT J
610 R2=(INT(RND*6)+1)*2+6
620 IF R<3 THEN 660
630 R2=R2+2
640 IF R2<=18 THEN 660
650 R2=18
660 IF R2<18 THEN 690
670 R3=3
680 GOTO 730
690 IF R2<16 THEN 720
700 R3=2*(INT(RND*2)+1)+1
710 GOTO 730
720 R3=2*(INT(RND*3)+1)+1
730 CALL VCHAR(R2,R1(I),45,R3)
740 NEXT I
750 X=20
760 Y=4
770 A=32
780 CALL HCHAR(X,Y,112)
790 E(0,1)=INT(RND*8)+4
800 CALL HCHAR(E(0,0),E(0,1),120)
810 E(1,1)=INT(RND*8)+18
820 CALL HCHAR(E(1,0),E(1,1),120)
830 EY(0)=-1
840 EY(1)=1
850 L=0
860 CALL KEY(0,K,S)
870 IF K=32 THEN 1670
880 IF K<>69 THEN 930
890 IF X<=4 THEN 1060
900 DX=-1
910 DY=0
920 GOTO 1060
930 IF K<>68 THEN 980
940 IF Y>=29 THEN 1060
950 DX=0
960 DY=1
970 GOTO 1060
980 IF K<>83 THEN 1020
990 IF Y=3 THEN 1060
1000 DX=0
1010 DY=-1
1020 IF K<>88 THEN 1060
1030 IF X=20 THEN 1060
1040 DX=1
1050 DY=0
1060 CALL GCHAR(X+DX,Y+DY,G)
1070 IF G=120 THEN 1920
1080 IF (G<>45)+(G<>104)+(G<>32)=-3 THEN 1250
1090 CALL HCHAR(X,Y,A)
1100 X=X+DX
1110 Y=Y+DY
1120 CALL HCHAR(X,Y,112)
1130 IF (G=45)+(G=32)THEN 1240
1140 T=T+1
1150 IF T=180 THEN 400
1160 SC=SC+1
1170 A=32
1180 CALL SOUND(100,-5,2)
1190 SC$=STR$(SC)&"  "
1200 FOR I=1 TO LEN(SC$)
1210 CALL HCHAR(23,9+I,ASC(SEG$(SC$,I,1)))
1220 NEXT I
1230 GOTO 1250
1240 A=G
1250 IF (E(L,1)<>3)+(E(L,1)<>30)=-2 THEN 1290
1260 EY(L)=0
1270 EX(L)=SGN(X-E(L,0))
1280 GOTO 1300
1290 IF EG(L)=45 THEN 1260 ELSE 1320
1300 IF EX(L)<>0 THEN 1320
1310 EY(L)=SGN(Y-E(L,1))
1320 DEX=E(L,0)+EX(L)
1330 IF (DEX>=6)+(DEX<=20)=-2 THEN 1360
1340 EX(L)=0
1350 DEX=E(L,0)
1360 DEY=E(L,1)+EY(L)
1370 IF (DEY>=3)+(DEY<=30)=-2 THEN 1400
1380 EY(L)=0
1390 DEY=E(L,1)
1400 CALL GCHAR(DEX,DEY,EG1)
1410 IF EG1=112 THEN 1920
1420 IF EG1<>120 THEN 1510
1430 IF (E(L,2)<>4)+(E(L,2)<>28)=-2 THEN 1470
1440 EX(L)=2*SGN(X-E(L,1))
1450 EY(L)=0
1460 GOTO 1320
1470 EY(L)=2*SGN(Y-E(L,1))
1480 EX(L)=0
1490 IF EY(L)=0 THEN 860
1500 GOTO 1320
1510 IF EG1<>96 THEN 1600
1520 IF FL<>1 THEN 1560
1530 FL=0
1540 GOTO 860
1550 EG(L)=45
1560 EX(L)=0
1570 EY(L)=SGN(Y-E(L,1))
1580 FL=1
1590 GOTO 1320
1600 CALL HCHAR(E(L,0),E(L,1),EG(L))
1610 CALL HCHAR(DEX,DEY,120)
1620 E(L,0)=DEX
1630 E(L,1)=DEY
1640 EG(L)=EG1
1650 L=ABS(L-1)
1660 GOTO 860
1670 CALL SOUND(500,-8,2)
1680 IF SH=0 THEN 1250
1690 CALL SCREEN(7)
1700 CALL SCREEN(12)
1710 CALL SCREEN(14)
1720 CALL SCREEN(16)
1730 CALL SCREEN(4)
1740 FOR I=0 TO 1
1750 IF E(I,0)<>X THEN 1840
1760 CALL HCHAR(E(I,0),E(I,1),EG(I))
1770 E(I,0)=6
1780 E(I,1)=INT(RND*20)+4
1790 IF E(I,1)=E(ABS(I-1),1)THEN 1780
1800 EX(I)=0
1810 EY(I)=SGN(Y-E(I,1))
1820 CALL GCHAR(E(I,0),E(I,1),EG(I))
1830 CALL HCHAR(E(I,0),E(I,1),120)
1840 NEXT I
1850 SH=SH-1
1860 SH$=STR$(SH)&"  "
1870 FOR I=1 TO LEN(SH$)
1880 CALL HCHAR(23,24+I,ASC(SEG$(SH$,I,1)))
1890 NEXT I
1900 SC=SC-25
1910 GOTO 1190
1920 CALL SOUND(1000,-4,4)
1930 PRINT "N A B B E D !!";
1940 CALL HCHAR(X,Y-1,88,3)
1950 FOR D=1 TO 2000
1960 NEXT D
1970 PRINT : :"TRY AGAIN? (Y/N)";
1980 CALL KEY(0,K,S)
1990 IF K=89 THEN 370
2000 IF K<>78 THEN 1980
2010 CALL CLEAR
2020 END
