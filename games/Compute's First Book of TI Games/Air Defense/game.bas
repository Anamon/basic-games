100 DIM BUILDING(32,2)
110 RANDOMIZE
120 REM  BOMB CHARACTERS
130 CALL CHAR(129,"001CBEFFFFBE1C00")
140 CALL CHAR(37,"00000000001CBEFF")
150 CALL CHAR(38,"FFBE1C0000000000")
160 REM  CROSSHAIR CHARACTER
170 CALL CHAR(130,"181818FFFF181818")
180 CALL CLEAR
190 CALL SCREEN(12)
200 FOR J=9 TO 12
210 CALL COLOR(J,2,14)
220 NEXT J
230 T=0
240 P=0
250 Q=0
260 M=0
270 CALL CLEAR
280 PRINT "        AIR DEFENSE"
290 PRINT
300 PRINT
310 PRINT "KEYBOARD OR JOYSTICK(k/j)?"
320 CALL KEY(0,KJ,ST)
330 IF ST=0 THEN 320
340 IF (KJ<>74)*(KJ<>75)THEN 320
350 KJ=KJ-73
360 FOR I=1 TO 4
370 PRINT
380 NEXT I
390 IF KJ=1 THEN 420
400 Z$="SPACE BAR."
410 GOTO 430
420 Z$="FIREBUTTON."
430 PRINT " do you need instructions?"
440 PRINT
450 PRINT "        type Y or N"
460 FOR I=1 TO 4
470 PRINT
480 NEXT I
490 CALL KEY(0,Y,STATUS)
500 IF STATUS=0 THEN 490
510 IF Y=ASC("N")THEN 870
520 IF Y=ASC("Y")THEN 620
530 CALL CLEAR
540 PRINT
550 PRINT "  you did not press Y or N."
560 FOR I=1 TO 13
570 PRINT
580 NEXT I
590 FOR DELAY=1 TO 500
600 NEXT DELAY
610 GOTO 270
620 CALL CLEAR
630 PRINT "   YOU MUST STOP THE FALLING"
640 PRINT "BOMB BY EXPLODING IT IN MID-AIR."
650 PRINT
660 PRINT
670 IF KJ=1 THEN 750
680 PRINT "   -MOVE THE CROSSHAIR-"
690 PRINT
700 PRINT "  left :HOLD THE s KEY"
710 PRINT "  right:HOLD THE d KEY"
720 PRINT "  up   :HOLD THE e KEY"
730 PRINT "  down :HOLD THE x KEY"
740 PRINT
750 PRINT "   WHEN THE BOMB AND THE"
760 PRINT "CROSSHAIR ARE LINED UP,"
770 PRINT "FIRE BY PRESSING THE "
780 PRINT Z$
790 PRINT
800 PRINT "   THE SOONER YOU GET THE"
810 PRINT "BOMB, THE HIGHER YOUR SCORE."
820 PRINT
830 PRINT
840 PRINT "   PRESS any key TO START"
850 CALL KEY(0,S,STATUS)
860 IF STATUS=0 THEN 850
870 CALL CLEAR
880 PRINT "       GOOD LUCK!!!"
890 FOR I=1 TO 10
900 PRINT
910 NEXT I
920 IF R=ASC("R")THEN 950
930 GOSUB 2040
940 GOTO 970
950 FOR I=1 TO 250
960 NEXT I
970 CALL CLEAR
980 GOSUB 2250
990 IF T=20 THEN 1820
1000 T=T+1
1010 CCROSS=16
1020 RCROSS=21
1030 RBOMB=1
1040 CALL SCREEN(6)
1050 CBOMB=INT(RND*29)+2
1060 H$=STR$(T)
1070 ROW=2
1080 COL=3
1090 GOSUB 2410
1100 SCORE=P*Q*10
1110 H$=STR$(SCORE)
1120 ROW=5
1130 GOSUB 2410
1140 FOR I=1 TO 70
1150 NEXT I
1160 FOR I=2 TO 5 STEP 3
1170 CALL HCHAR(I,3,32,6)
1180 NEXT I
1190 CALL VCHAR(I,3,32,6)
1200 RBOMB=RBOMB+1
1210 IF RBOMB=23 THEN 1500
1220 ON KJ GOSUB 2680,2480
1230 CALL VCHAR(RBOMB-1,CBOMB,37)
1240 CALL VCHAR(RBOMB,CBOMB,38)
1250 ON KJ GOSUB 2680,2480
1260 CALL VCHAR(RBOMB-1,CBOMB,32,2)
1270 GOTO 1190
1280 REM  BOMB DESTROYED
1290 RBOMB=RBOMB-1
1300 CALL SCREEN(10)
1310 CALL VCHAR(RBOMB,CBOMB,32,2)
1320 CNT=0
1330 C1=92
1340 C2=47
1350 FOR I=-1 TO 1 STEP 2
1360 CALL VCHAR(RBOMB+I,CBOMB+I,C1)
1370 CALL VCHAR(RBOMB+I,CBOMB-I,C2)
1380 NEXT I
1390 C1=32
1400 C2=32
1410 IF CNT=1 THEN 1470
1420 CNT=1
1430 FOR VOL=10 TO 30 STEP 5
1440 CALL SOUND(100,-6,VOL)
1450 NEXT VOL
1460 GOTO 1350
1470 P=P+1
1480 Q=Q+(23-RBOMB)
1490 GOTO 990
1500 REM  BOMB HITS THE CITY
1510 CALL VCHAR(22,CBOMB,32)
1520 CALL SCREEN(9)
1530 CALL COLOR(12,11,1)
1540 CALL VCHAR(23,CBOMB-1,122)
1550 CALL VCHAR(23,CBOMB,32)
1560 CALL VCHAR(23,CBOMB+1,123)
1570 CALL VCHAR(24,CBOMB-1,124)
1580 CALL VCHAR(24,CBOMB,125)
1590 CALL VCHAR(24,CBOMB+1,126)
1600 FOR I=1 TO 20
1610 NEXT I
1620 CALL COLOR(12,7,1)
1630 CALL SCREEN(12)
1640 FOR I=1 TO 20
1650 NEXT I
1660 CALL SCREEN(7)
1670 FOR VOL=24 TO 1 STEP 4
1680 CALL SOUND(200,-7,VOL)
1690 NEXT VOL
1700 FOR DVOL=1 TO 24 STEP 4
1710 CALL SOUND(200,-7,DVOL)
1720 NEXT DVOL
1730 FOR J=23 TO 24
1740 FOR I=CBOMB-1 TO CBOMB+1
1750 CALL VCHAR(J,I,32)
1760 NEXT I
1770 NEXT J
1780 CALL VCHAR(RCROSS,CCROSS,32)
1790 CALL COLOR(12,2,14)
1800 M=M+1
1810 GOTO 990
1820 CALL CLEAR
1830 CALL SCREEN(4)
1840 PRINT "         GAME OVER"
1850 FOR I=1 TO 4
1860 PRINT
1870 NEXT I
1880 PRINT "   DESTROYED   ";P
1890 PRINT
1900 PRINT "   MISSED      ";M
1910 PRINT
1920 PRINT "   TOTAL POINTS";P*Q*10
1930 FOR I=1 TO 4
1940 PRINT
1950 NEXT I
1960 PRINT "   PRESS r TO PLAY AGAIN"
1970 PRINT
1980 PRINT
1990 CALL KEY(0,R,STATUS)
2000 IF STATUS=0 THEN 1990
2010 IF R=ASC("R")THEN 180
2020 END
2030 REM  READ CITY DATA
2040 FOR ROW=2 TO 1 STEP -1
2050 FOR COL=1 TO 32
2060 READ BUILDING(COL,ROW)
2070 NEXT COL
2080 NEXT ROW
2090 REM  CUSTOM CHAR & COLORS
2100 CALL CHAR(136,"FFABFFABFFABFFFF")
2110 CALL CHAR(128,"003C7EFFFFFF7E42")
2120 CALL CHAR(131,"42665A6642427E66")
2130 CALL CHAR(132,"6060606060606060")
2140 CALL CHAR(133,"607858F8D8F8D8F8")
2150 CALL CHAR(134,"F8A8F8A8F8A8F8F8")
2160 CALL CHAR(135,"C3C3FFABFFABFFFF")
2170 CALL COLOR(14,7,12)
2180 CALL CHAR(122,"8040201008040201")
2190 CALL CHAR(123,"0102040810204080")
2200 CALL CHAR(124,"80E0F8FEFFFFFFFF")
2210 CALL CHAR(125,"814224180081C3E7")
2220 CALL CHAR(126,"01071F7FFFFFFFFF")
2230 RETURN
2240 REM  SET UP CITY
2250 FOR ROW=2 TO 1 STEP -1
2260 FOR COL=1 TO 32
2270 CALL HCHAR(ROW+22,COL,BUILDING(COL,ROW))
2280 NEXT COL
2290 NEXT ROW
2300 RETURN
2310 REM  CITY DATA
2320 DATA 136,134,131,135,133,136,136,133
2330 DATA 135,136,136,136,133,136,136,135
2340 DATA 135,136,136,134,133,136,136,136
2350 DATA 135,132,136,32,131,135,132,135
2360 DATA 134,133,128,32,132,32,135,32
2370 DATA 32,32,134,132,132,32,133,32
2380 DATA 32,32,128,32,132,32,133,135
2390 DATA 32,132,132,32,128,32,132,32
2400 REM  HORIZONTAL # PRINTER
2410 FOR I=1 TO LEN(H$)
2420 DIG=ASC(SEG$(H$,I,1))
2430 CALL HCHAR(ROW,COL+I,DIG)
2440 NEXT I
2450 RETURN
2460 REM  CROSSHAIR SUB
2470 REM  KEYBOARD ROUTINE
2480 OLDRCROSS=RCROSS
2490 OLDCCROSS=CCROSS
2500 CALL KEY(0,K,S)
2510 IF K<>69 THEN 2530
2520 RCROSS=RCROSS-SGN(RCROSS-1)
2530 IF K<>88 THEN 2550
2540 RCROSS=RCROSS+SGN(22-RCROSS)
2550 IF K<>68 THEN 2570
2560 CCROSS=CCROSS+SGN(32-CCROSS)
2570 IF K<>83 THEN 2590
2580 CCROSS=CCROSS-SGN(CCROSS-2)
2590 IF S=0 THEN 2610
2600 CALL VCHAR(OLDRCROSS,OLDCCROSS,32)
2610 CALL VCHAR(RCROSS,CCROSS,130)
2620 IF (RCROSS=RBOMB)+(RCROSS=RBOMB-1)THEN 2630 ELSE 2660
2630 IF CCROSS<>CBOMB THEN 2660
2640 CALL KEY(0,K,S)
2650 IF K=32 THEN 1290
2660 RETURN
2670 REM  JOYSTICK ROUTINE - RELEASE ALPHA-LOCK KEY
2680 OLDRCROSS=RCROSS
2690 OLDCCROSS=CCROSS
2700 CALL JOYST(1,XRET,YRET)
2710 CCROSS=CCROSS+XRET/4
2720 IF CCROSS>32 THEN 2740
2730 IF CCROSS<1 THEN 2760 ELSE 2770
2740 CCROSS=32
2750 GOTO 2770
2760 CCROSS=1
2770 RCROSS=RCROSS-YRET/4
2780 IF RCROSS>22 THEN 2800
2790 IF RCROSS<1 THEN 2820 ELSE 2830
2800 RCROSS=22
2810 GOTO 2830
2820 RCROSS=1
2830 IF (RCROSS=OLDRCROSS)*(CCROSS=OLDCCROSS)THEN 2850
2840 CALL VCHAR(OLDRCROSS,OLDCCROSS,32)
2850 CALL VCHAR(RCROSS,CCROSS,130)
2860 IF (RCROSS=RBOMB)+(RCROSS=RBOMB-1)THEN 2870 ELSE 2900
2870 IF CCROSS<>CBOMB THEN 2900
2880 CALL KEY(1,K,S)
2890 IF K=18 THEN 1290
2900 RETURN
2910 END
