100 REM * QUESTIGIAN TORTURE * TRS-80 EXTENDED COLOR BASIC *110 REM * SORCERER'S PUZZLES #5 * RICHARD RAMELLA120 CLS130 PRINT @ 128,"";140 PCLS150 PMODE 3,1160 SCREEN 1,1170 U$=CHR$(94)180 D$=CHR$(10)190 L$=CHR$(8)200 R$=CHR$(9)210 FOR Y=0 TO 192 STEP 24220 LINE(0,Y)-(192,Y),PSET230 NEXT Y240 FOR X=0 TO 192 STEP 24250 LINE(X,0)-(X,192),PSET260 NEXT270 A=RND(2)280 IF A=1 THEN X=74 ELSE X=50290 PAINT(X,50),3,8300 PAINT(122,122),8,8310 Y=50320 Z$=INKEY$330 IF X>25 AND X<147 AND Y>25 AND Y<147 AND Z$="D" AND SS=0 GOSUB 630340 IF Y=2 THEN 350 ELSE IF Z$=U$ AND PPOINT(X,Y-24)<>7 THEN Y=Y-24: N=N+1350 IF Y=170 GOTO 360 ELSE IF Z$=D$ AND PPOINT(X,Y+24)<>7 THEN Y=Y+24: N=N+1360 IF X=2 GOTO 370 ELSE IF Z$=L$ AND PPOINT(X-24,Y)<>7 THEN X=X-24: N=N+1370 IF X=170 GOTO 400 ELSE IF Z$=R$ AND PPOINT(X+24,Y)<>7 THEN X=X+24: N=N+1380 H=PPOINT(X,Y)390 IF H=8 AND N<63 GOSUB 420 ELSE IF H=8 AND N=63 GOSUB 530400 PAINT(X,Y),3,8410 GOTO 320420 FOR T=1 TO 500430 NEXT440 PRINT "YOU ARRIVE AT ORANGE TOO SOON."450 PRINT460 PRINT "L-O-S-E-R"470 GOTO 480480 FOR T=1 TO 3000490 NEXT500 SCREEN 1,1510 SOUND RND(13)*8,1520 GOTO 510530 FOR T=1 TO 1000540 NEXT T550 PRINT "YOU DID IT!"560 PRINT570 PRINT "W-I-N-N-E-R!"580 FOR T=1 TO 3000590 NEXT T600 SCREEN 1,1610 PLAY STR$(RND(6)*2)620 GOTO 610630 CLS640 SS=1650 PRINT "YOU MAY HAVE ONE DIAGONAL MOVE."660 PRINT "CHOOSE:"670 PRINT "SW -- SOUTHWEST"680 PRINT "SE -- SOUTHEAST"690 PRINT "NW -- NORTHWEST"700 PRINT "NE -- NORTHEAST"710 PRINT720 PRINT "TO VIEW BOARD, POSITION MARKED, TAP ENTER"730 INPUT K$740 IF K$="" THEN PAINT(X,Y),2,8: SCREEN 1,1: FOR T=1 TO 1500: NEXT T: CLS: PAINT(X,Y),3,8 : GOTO 630750 IF K$="SE" AND PPOINT(X+24,Y+24)=5 THEN Y=Y+24: X=X+24: GOTO 800760 IF K$="SW" AND PPOINT(X-24,Y+24)=5 THEN Y=Y+24: X=X-24: GOTO 800770 IF K$="NE" AND PPOINT(X+24,Y-24)=5 THEN Y=Y-24: X=X+24: GOTO 800780 IF K$="NW" AND PPOINT(X-24,Y-24)=5 THEN Y=Y-24: X=X-24: GOTO 800790 IF K$<>"NE" AND K$<>"NW" AND K$<>"SE" AND K$<>"SW" THEN CLS: PRINT "TRY AGAIN -- NW NE SW SE": FOR T=1 TO 1500: NEXT T: CLS: GOTO 630800 CLS810 SCREEN 1,1820 N=N+1830 RETURN840 END