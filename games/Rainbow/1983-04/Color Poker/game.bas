
10 GOTO30000
20 '24DEC82
30 'COLOR POKER
40 'JOSEPH KOHN
50 '1343 BLOSSOM AVE
60 'REDLANDS,CA 92373
70 CLS:DIM A$(89):X=RND(-TIMER)
80 '---DRAW STRINGS
90 A$(33)="U4E2F2D2NL4D2BR3" 'A
100 A$(35)="BR3E1BU4H1L2G1D4F1R2BR4"'C
110 A$(36)="U6R3F1D4G1L3BR7" 'D
120 A$(37)="R4BU6L4D3NR2D3BR7" 'E
130 A$(38)="U6NR4D3NR2D3BR7" 'F
140 A$(39)="BR4BU5H1L2G1D4F1R3U2NL1D2BR3" 'G
150 A$(40)="U6D3R4U3D6BR3" 'H
160 A$(41)="BU6BR1R2L1D6L1R2BR4" 'I
170 A$(42)="BU1F1R2E1U5BD6BR3"  'J
180 A$(43)="U6D3R1NE3F3BR3" 'K
190 A$(44)="NU6R4BR3" 'L
200 A$(45)="U6F2ND1E2D6BR3" 'M
210 A$(46)="U6F4U4D6BR3" 'N
220 A$(47)="BU1U4E1R2F1D4G1L2NH1BR6" 'O
230 A$(48)="U6R3F1D1G1L3BF3BR4" 'P
240 A$(49)="BU1U4E1R2F1D3G1NH1NF1G1L1NH1BR6" 'Q
250 A$(50)="U6R3F1D1G1L3R1F3BR3" 'R
260 A$(51)="R3E1U1H1L2H1U1E1R3BD6BR3" 'S
270 A$(52)="BU6R4L2D6BR5" 'T
280 A$(53)="BU1U5BR4D5G1L2NH1BR6" 'U
290 A$(54)="BU4NU2F1D1F1ND1E1U1E1U2BD6BR3" 'V
300 A$(55)="NU6E2F2NU6BR3" 'W
310 A$(57)="BU6D1F2E2U1D1G2D3BR5" 'Y
320 A$(65)="BU4R2F1D1L2G1F1R2NU2R1BR3" 'a
330 A$(66)="U6D2R3F1D2G1L3BR7" 'b  
340 A$(67)="BU4BR2NF1L2G1D2F1R2NE1BR4" 'c
350 A$(68)="BU4BR4L3G1D2F1R3NU6BR3" 'd
360 A$(69)="BR3L2H1U2E1R2F1D1NL4BD2BR3" 'e
370 A$(72)="U6D3E1R2F1D3BR3" 'h
380 A$(73)="BU6BR1R1BD2NL1D4L1R2BR4" 'i
390 A$(79)="BU1U2E1R2F1D2G1L2NH1BR7" 'o
400 A$(82)="U4D1E1R2F1BD3BR3" 'r
410 A$(83)="R3E1H1L2H1E1R3BD4BR3" 's
420 A$(84)="BU5R4L2U1D5F1E1BD1BR3" 't
430 A$(85)="BU4D3F1R2NU4R1BR3" 'u
440 A$(86)="BU4F1D1F1ND1E1U1E1BD4BR3" 'v
450 A$(87)="BU4D3F1E1NU2F1E1U3BD4BR3" 'w
460 A$(89)="BU4D3F1R3U4D5G1L3BU2BR7" 'y
470 A$(0)="BR3"'SPACE
480 A$(1)="BR1R1BU2U4BD6BR5" '!
490 A$(4)="BR2U6D1R2L3G1F1R2F1G1L3BD1BR7" '$
500 A$(12)="U1R1D1NL1D1G1BU2BR7" 'COMMA
510 A$(13)="BU3R4BD3BR3" '-
520 A$(16)="BU1U4E1R1F1D4G1L1NH1BR6" '0
530 A$(17)="BU6BR2NG1D6L1R2BR4" '1
540 A$(18)="BU5E1R2F1D1G1L2G1D2R4BR3" '2
550 A$(19)="BU5E1R2F1D1G1NL1F1D1G1L2NH1BR6" '3
560 A$(20)="BU2U1E3D4NR1NL3D2BR4" '4
570 A$(21)="BU1F1R2E1U2H1L3U2R4BD6BR3" '5
580 A$(22)="BU6BR3L1G2D3F1R2E1U1H1L3BD3BR7" '6
590 A$(23)="BU6R4D1G4D1BR7" '7
600 A$(24)="BU1U1E1R2E1U1H1L2G1D1F1R2F1D1G1L2NH1BR6" '8
610 A$(25)="BR1R1E2U3H1L2G1D1F1R3BD3BR3" '9
620 A$(26)="BU6NG1D6L1R2BR2BU1U4E1F1D4G1NH1"  '10
630 A$(27)="U1R1D1L1BU3U1R1D1L1BD5E1U1BR6" ';
640 A$(29)="BU2NR4BU2R4BD4BR3" '=
650 A$(31)="BR1R1BU2E2U1H1L2G1BD5BR7" '? 
660 GOTO680
670 FORX1=1TO LEN(X$):Y1=ASC(MID$(X$,X1,1))-32:DRAW"XA$(Y1);":NEXT:RETURN
680 PMODE1,1:PCLS2:DRAW"BM36,52;S16C1":X$="COLOR":GOSUB670:DRAW"BM40,52;C3":GOSUB670:DRAW"BM72,112;C1":X$="POKER":GOSUB670:DRAW"BM76,112;C3":GOSUB670
690 '---CREATE DECK
700 Z=0:DIMCS(52),CV(52),DD(52),C(12),H(12),S(12),D(12)
710 FORX=1TO4 '1=CLUB,2=SPADE,3=HEART,4=DIAMOND
720 FORY=1TO13:Z=Z+1:CS(Z)=X:CV(Z)=Y:NEXTY,X
730 '---CREATE SYMBOLS
740 DRAW"BM68,156;S8C3R1U1R1D1R2U2L1U1R1U1R3D1R1D1L1D2R2U1R1D1R1D3L1D1L1U1L3D2L1U2L3D1L1U1L1U3"
750 PAINT(80,152),3,3:GET(68,148)-(91,167),C,G
760 DRAW"BM100,156;C4BR1R1U1R1U1R1U1R1U1D1R1D1R1D1R1D1R1D1L1D1L1D1L1D1L1D1U1L1U1L1U1L1U1L1U1"
770 PAINT(114,156),4,4:GET(100,148)-(123,167),D,G
780 DRAW"BM132,156;C3BR1R1U1R1U1R1U1R1U1R1D1R1D1R1D1R1D1R1D2L1D1L1U1L2D3L1U3L2D1L1U1L1U2"
790 PAINT(146,156),3,3:GET(132,148)-(155,167),S,G
800 DRAW"BM164,156;C4BR1U2R1U1R1U1D1R1D1R3U1R1U1D1R1D1R1D2L1D2L1D1L1D1L1D1L1U1L1U1L1U1L1U2L1"
810 PAINT(170,152),4,4:GET(164,148)-(187,167),H,G
820 SCREEN1,0:FORX=1TO3000:NEXT
830 '---ODDS DISPLAY
840 PRINTSTRING$(8,"*")"C0C0 CASINO ODDS"STRING$(8,"*")"
850 DATA 1   ONE-PAIR,2   TWO-PAIR,3   THREE-OF-A-KIND,4   STRAIGHT,6   FLUSH,9   FULL-HOUSE,25  FOUR-OF-A-KIND,50  STRAIGHT-FLUSH,250 ROYAL-FLUSH
860 FORX=5TO10:READA$(X):PRINTMID$(A$(X),4);TAB(24)VAL(A$(X))"TO 1":NEXT:FORX=27TO28:READA$(X):PRINTMID$(A$(X),4);TAB(23)VAL(A$(X))"TO 1":NEXT:READA$(29):PRINTMID$(A$(29),4)TAB(22)VAL(A$(29))"TO 1"
870 PRINT@416,"YOUR INITIAL BANKROLL IS $1000!!":TT=1000:PRINT@480,"READY?";
880 IF INKEY$=""THEN880 ELSE CLS
890 '---START PLAY
900 COLOR2,1:PCLS:BT=INT(100*10^(-(TT>20000))*RND(10)):BT$=MID$(STR$(BT),2):DRAW"BM20,20;C4":X$="Your bet is $"+BT$+"!":GOSUB670
910 DRAW"BM20,40":X$="GOOD LUCK,PAL!!!":GOSUB670:SCREEN1,0
920 '---CLEAR DECK
930 FOR X=1TO52:DD(X)=0:NEXT
940 FORX=1TO5
950 GOSUB1010
960 Y=12+48*(X-1):Y$=STR$(Y)
970 DRAW"BM"+Y$+",62;C2":X$=CHR$(X+48):GOSUB670
980 GOSUB1140:GOSUB1020
990 NEXT:GOTO1150
1000 '---DEAL
1010 Z=RND(52):IF DD(Z)=1THEN1010ELSECD(X)=Z:DD(Z)=1:RETURN
1020 '---CARD GRAPHICS
1030 IF CS(Z)=1 OR CS(Z)=2 THEN CC$="3" ELSE CC$="4"
1040 IF CV(Z)>1 AND CV(Z)<11 THEN X$=CHR$(CV(Z)+48)
1050 IFCV(Z)=1THENX$="A"
1060 IFCV(Z)=11THENX$="J"ELSEIFCV(Z)=12THENX$="Q"ELSEIFCV(Z)=13THENX$="K"
1070 DRAW"BM"+STR$(Y+4)+",84;S8C"+CC$:GOSUB670
1080 DRAW"BM"+STR$(Y+24)+",130":GOSUB670
1090 ON CS(Z) GOTO 1100,1110,1120,1130
1100 PUT(Y+8,92)-(Y+31,111),C,PSET:RETURN
1110 PUT(Y+8,92)-(Y+31,111),S,PSET:RETURN
1120 PUT(Y+8,92)-(Y+31,111),H,PSET:RETURN
1130 PUT(Y+8,92)-(Y+31,111),D,PSET:RETURN
1140 COLOR2,1:LINE(Y,68)-(Y+39,135),PSET,BF:RETURN
1150 '---DISCARDS
1160 DRAW"BM12,160":X$="Discards?":SOUND100,1:GOSUB670
1170 FORX=1TO4:DC(X)=0:NEXT:A=1
1180 K$=INKEY$:IF K$=CHR$(13)THEN 1240 ELSE IF K$=""THEN1180ELSEK=VAL(K$):IFK<1 OR K>5 THEN 1180
1190 IF K$=CHR$(13)THEN1240
1200 IFA=5THEN1180
1210 FORX=1TO5 :IF DC(X)<>K THEN NEXT ELSE1180
1220 DC(A)=K:A=A+1
1230 LINE(10+48*(K-1),48)-(52+48*(K-1),136),PSET,B:GOTO1180
1240 DRAW"BM12,184":X$="OK?":SOUND100,1:GOSUB670
1250 K$=INKEY$:IFK$=""THEN1250ELSEIFK$="Y"THEN1290ELSEIFK$<>"N"THEN1250
1260 GOSUB1320
1270 FORK=1TO4:IFDC(K)THENGOSUB1310
1280 NEXT:GOTO1160
1290 GOSUB1320:FORK=1TO4:IF DC(K) THEN GOSUB1310:X=DC(K):GOSUB1010:Y=12+48*(X-1):GOSUB1140:GOSUB1020
1300 NEXT:GOTO1330
1310 LINE(10+48*(DC(K)-1),48)-(52+48*(DC(K)-1),136),PRESET,B:RETURN
1320 LINE(0,140)-(255,191),PRESET,BF:RETURN
1330 '---SCORING
1340 LINE(0,0)-(255,67),PRESET,BF
1350 DRAW"BM12,20":X$="How did you do?":GOSUB670
1360 '---SORT
1370 FORX=1TO4:Z3=X:Z1=CV(CD(X)):FORY=X TO5:Z2=CV(CD(Y))
1380 IF Z2<Z1 THEN Z1=Z2:Z3=Y
1390 NEXTY:Z4=CD(X):CD(X)=CD(Z3):CD(Z3)=Z4:NEXTX
1400 '---TEST STRAIGHT
1410 S=1:SA=0:FORX=2TO4:IF CV(CD(X))+1<>CV(CD(X+1))THENS=0:GOTO1440ELSENEXT
1420 IF CV(CD(1))=1 AND CV(CD(5))=13 THEN SA=1:GOTO1440
1430 IFCV(CD(1))+1<>CV(CD(2))THENS=0
1440 '---TEST FLUSH
1450 FL=1:FOR X= 1TO4:IFCS(CD(X))<>CS(CD(X+1))THENFL=0:GOTO1460ELSENEXT
1460 IFFL AND SA THEN X$=A$(29):GOTO1630
1470 IFFL AND S THEN X$=A$(28):GOTO1630
1480 '---TEST 3- OR 4-OF-A-KIND
1490 T(1)=0:T(2)=0:T(3)=0
1500 FORX=1TO3:IFCV(CD(X))=CV(CD(X+1))ANDCV(CD(X+2))=CV(CD(X+1))THENT(X)=1
1510 NEXT
1520 IF(T(1) AND T(2)ANDFL=0)OR(T(2)ANDT(3)ANDFL=0)THEN X$=A$(27):GOTO1630
1530 IF(T(1)ANDCV(CD(4))=CV(CD(5)))OR(T(3)ANDCV(CD(1))=CV(CD(2)))THENX$=A$(10):GOTO1630
1540 IF FL THENX$=A$(9):GOTO1630
1550 IF S THEN X$=A$(8):GOTO1630
1560 IFT(1)ORT(2)ORT(3)THENX$=A$(7):GOTO1630
1570 '---TEST PAIRS
1580 PP=0:FORX=1TO4:IFCV(CD(X))=CV(CD(X+1))THENPP=PP+1
1590 NEXT:IF PP=0 THEN 1620
1600 IF PP=2 THEN X$=A$(6):GOTO1630
1610 X$=A$(5):GOTO1630
1620 IFRND(2)=1THENX$="-1  YOU HAVE NOTHING"ELSEX$="-1  WORTHLESS CARDS"
1630 '---TALLY
1640 OD=VAL(X$):X$=MID$(X$,4)+"!"
1650 DRAW"BM12,50":GOSUB670
1660 DRAW"BM12,160":IF OD>0 THEN X$="YOU WON ":SC=BT*(OD-1):TT=TT+SC:FORX=1TO5:SOUND50,1:SOUND150,1:NEXT  ELSEX$="YOU LOST ":SC=BT:TT=TT-BT:SOUND50,5
1670 SC$="$"+MID$(STR$(SC),2):X$=X$+SC$+"!":IF OD=1 THEN X$="EVEN MONEY!"
1680 GOSUB670:TT$=MID$(STR$(TT),2)
1690 DRAW"BM16,184":IF TT<0 THEN X$="You owe $" ELSE X$="You have $"
1700 X$=X$+TT$+"!":GOSUB670
1710 IFINKEY$=""THEN1710ELSE890
30000 PCLEAR2:GOTO20
