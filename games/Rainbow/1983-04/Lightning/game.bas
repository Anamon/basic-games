10 '        L20 '         I30 '         G40 '          H50 '           T60 '          N  N70 '        I    I80 '         N    N90 '        G       G100 '110 'define variables, display120 DIM X(14),X1(14),Y(14),Y1(14)130 PMODE4,1140 PCLS150 SCREEN1,1200 'generate initial position210 X(0)=150+RND(75)*(((RND(2)>1)*2)+1)220 Y(0)=0230 X1(0)=X(0):Y1(0)=0240 LINE(X,Y)-(X,Y),PRESET300 'generate single bolt portion310 FOR T=1TO RND(13)320 X(T)=X(T-1)+RND(15)*(((RND(2)>1)*2)+1)330 IF X(T)<0THEN X(T)=0340 X1(T)=X(T)350 Y(T)=Y(T-1)+RND(10)360 Y1(T)=Y(T)370 NEXT T400 'generate forked portion410 FOR T=T TO 13420 X(T)=X(T-1)+RND(10)*(((RND(2)>1)*2)+1)430 IF X(T)<0THEN X(T)=0440 X1(T)=X1(T-1)+RND(10)*(((RND(2)>1)*2)*+1)450 IF X1(T)<0THEN X1(T)-0460 Y(T)=Y(T-1)+RND(10)470 Y1(T)=Y1(T-1)+RND(10)480 NEXT T500 'display lightning flash510 FOR T=1TO13520 LINE(X(T-1),Y(T-1))-(X(T),Y(T)),PSET530 LINE(X1(T-1),Y1(T-1))-(X1(T),Y1(T)),PSET540 NEXT T550 FOR S=0TO50:NEXT S600 'remove lightning from sky610 '620 PCLS'use this if nothing    else is on screen, else delete630 '640 FOR T=1TO13650 LINE(X(T-1),Y(T-1))-(X(T),Y(T)),PRESET660 LINE(X1(T-1),Y1(T-1))-(X1(T),Y1(T)),PRESET670 NEXT T680 GOTO2001000 '1010 '1020 'The lightning is generated      in two arrays, one for each     of two forks,1030 'Fourteen co-ordintaes are       generated,X and Y being         independent of each other.1040 'The distance between points     is randomly generated.          the horizontal values can       be + or -, but the vertical     values are always +.1050 'Initially, a random number      of points are duplicated in     both arrays to give the         impression of a single          lightning bolt.1060 'Then, points for each array    are generated to produce        forked lightning.