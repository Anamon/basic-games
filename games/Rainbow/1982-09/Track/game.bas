1 'THE TRACK (C) 1982 BY AL HINE,113 WARD ST., NEW HAVEN, CT 0651910 CLS7:GOTO6099981 PRINT@449,"PRESS ANY KEY TO CONTINUE";82 A$=INKEY$:IFA$=""GOTO82ELSERETURN83 P=PEEK(65280):IFP=126ORP=254THENA$="Y":RETURN ELSEA$="N":RETURN100 'BEGIN LOOP110 FORLP=1TOL115 N1=1:N2=E-8120 FORN=N1 TO N2129 'VW-ORIGINAL W/SLOWER STEERING & LOW SPEED CORRECTION130 J0=JOYSTK(0):A=INT(.5+(J0-31.5)/27)131 J1=JOYSTK(1):J2=J1:IFJ1>30THENJ2=60-J1132 A=A*(J2/50+1)141 C=T(N)150 OX=X:X=X+A:IFX<0THENX=0ELSEIFX>31THENX=31160 Y=POINT(X*2,15)170 IFF1=1THEN SOUND165,5:PRINT@192+OX,GR$; ELSE PRINT@192+OX,R1$;190 PRINT@224+X,CA$;200 PRINT@480+C,RD$220 PLAYSTRING$(J1/10,"A")230 IFY<>5THENIFF1=0THENOC=OC+1:F1=1 ELSE F1=1 ELSE F1=0240 NEXTN243 IFN2<E THENN1=N2:N2=E:PRINT@448+C-1,CHR$(191);:PRINT@448+C+TW,CHR$(191);:GOTO120245 TI=TIMER/60250 LT=TI-TP:IFLT<FT THENFT=LT:FL=LP256 TP=TI270 PRINT@416,"LAP";LP;:PRINT@448,"TIME";:PRINTUSINGPF$;LT;280 GOSUB83:IFA$="Y"THENN=L:L=LP:LP=N:GOTO290282 IFTI>900THENN=L:L=LP:LP=N:PRINT" OUT OF FUEL290 NEXTLP295 FORN=1TO600:NEXTN300 CLS:PRINT"LAPS=";L:PRINT"TIME=";:PRINTUSINGPF$;TI:PRINT"OFF COURSE";OC;"TIMES":PRINT310 PRINT"AVERAGE LAP TIME=";:PRINTUSING PF$;TI/L;:PRINT" SECONDS320 PRINT"FASTEST LAP WAS LAP";FL;"AT";:PRINTUSINGPF$;FT325 IFFT<LR GOSUB400390 PRINT:GOTO1010400 'NEW LAP RECORD410 PRINT"NEW LAP RECORD ";420 IFLR=999THENPRINT" ":ELSEPRINT"BY ";:PRINTUSINGPF$;LR-FT;:PRINT"!"430 LR=INT((FT+.005)*100)/100:F4=1:LB=LB+1440 INPUT"WHAT IS YOUR NAME";DN$:LH$=DN$490 RETURN1000 CLS'RUN RACE1010 GOSUB1100:PRINT:PRINT"YOU ARE IN A ";CM$:PRINT"IN THE PITS AT ";:IFFI$<>""THENPRINTFI$ ELSEPRINT"YOUR NEW TRACK"1020 IFLR<>999THEN PRINT"LAP RECORD IS ";:PRINTUSINGPF$;LR:PRINT"RECORD HELD BY ";LH$1030 PRINT"ENGINE IS RUNNING":INPUT"HOW MANY LAPS";L:IFL=0GOTO10901040 CLS:FORN=1TO15:PRINTTAB(10)RD$:NEXTN:TIMER=61050 GOTO1001090 GOSUB8600:RETURN1100 'INIT VARS1110 N=0:X=13:Y=0:C=10:F1=0:A=0:AF=0:OX=0:J1=0:OC=0:TP=0:TI=01120 R1$=CHR$(207):RD$=STRING$(TW,207):GR$=CHR$(143)1125 CA$=CHR$(175):CM$="VW"1130 FT=999:FL=0:LT=0:LP=0:LO=0:PF$="###.##"1135 IFF2=1GOTO11901140 DIMT(D):GOSUB9000:F2=1:PLAY"T255O1L1"1190 RETURN2000 'SET UP TRACK2005 CLS2007 PRINT"YOU CREATE THE TRACK USING":PRINT"THE RIGHT JOYSTICK FOR CONTROL.":PRINT"MOVE STICK LEFT OR RIGHT TO":PRINT"TURN, FORWARD TO GO FASTER.2008 PRINT:PRINT"WHEN YOU ARE DONE, PRESS 'FIRE' BUTTON TO STOP.":PRINT:PRINT"PLEASE ENTER TRACK WIDTH2009 INPUT"(BETWEEN 5 & 10)";TI:IFTI<5ORTI>10GOTO2090 ELSE TW=TI:RD$=STRING$(TW,207):C=10:T(0)=C:LR=999:LB=0:LH$="":FE$="":FI$="":F4=02010 FORN=1TO9:T(N)=C:PRINT@480+C,RD$:NEXTN2015 FORN=10TOD-202020 J0=JOYSTK(0):DT=INT(.5+(J0-31)/20)2025 T(N)=T(N-1)+DT2026 IFT(N)<1THENT(N)=1ELSEIFT(N)>21THENT(N)=212030 PRINT@480+T(N),RD$2035 J1=JOYSTK(1)2040 FORM=1TO20+J1:NEXTM2050 E=N:P=PEEK(65280):IF P=126ORP=254THENN=10002080 NEXTN2085 IFT(E)>T(1)THENE=E+1:T(E)=T(E-1)-1:PRINT@480+T(E),RD$:GOTO20852086 IFT(E)<T(1)THENE=E+1:T(E)=T(E-1)+1:PRINT@480+T(E),RD$:GOTO20862087 FORN=1TO10:E=E+1:T(E)=T(1):PRINT@480+T(E),RD$:NEXTN2089 F3=1:F4=1:GOSUB10002090 CLS:RETURN3000 'MENU3010 GOSUB11003020 GOSUB31003025 GOSUB823030 IFA$="0"GOTO30903050 A=VAL(A$):IFA=0GOTO30203060 ON A GOSUB10000,7000,5000,2000,10003070 GOTO30103090 GOSUB9500:END3100 'MENU DISPLAY3110 CLS:PRINT@38,"T H E  T R A C K":PRINT3114 PRINT" YOU ARE DRIVING A ";CM$:IFFI$<>""THENPRINT" AT ";FI$3120 PRINT:PRINT" PLEASE SELECT:":PRINT3130 PRINT"  1.INFORMATION3140 PRINT"  2.GO TO A TRACK3142 IFF5=0THENPRINT"  3.CHANGE CARS3145 PRINT"  4.CREATE A NEW TRACK3147 IFFI$<>""THENPRINT"  5.CONTINUE AT ";FI$3150 PRINT3180 PRINT"  0.QUIT3190 RETURN5000 CLS'SELECT CAR5005 IFF5=1THENGOTO50905010 PRINT:PRINT" PLEASE SELECT A CAR:":PRINT5020 PRINT"  1.VW5025 PRINT"  2.DATSUN5030 PRINT"  3.LOTUS5035 PRINT"  4.FERRARI5038 PRINT:PRINT"  0.RETURN TO MENU5040 PRINT:PRINT" NOTE: SELECTING A NEW CAR WILL  SEND YOU TO THE TEAM'S":PRINT" HEADQUARTERS5050 G0SUB82:A=VAL(A$)5055 IFA$="0"THENGOTO50905056 IFA<1ORA>4THENGOTO50005059 GOSUB9500:CLS:PRINT@169,"EN ROUTE TO";:PRINT@235," ";5060 IFA=1THEN PRINT"WOLFSBURG":LOAD "VW",R5065 IFA=2THEN PRINT"JAPAN":LOAD"DATSUN",R5070 IFA=3THEN PRINT"HETHEL":LOAD "LOTUS",R5075 IFA=4THEN PRINT"MARANELLO":LOAD "FERRARI",R5090 RETURN7000 'DISPLAY7010 IFF5=1THEN CLS:INPUT"WHAT TRACK";FI$:GOTO70857020 ER$=""7030 GOSUB71007040 GOSUB82:IFA$="0"GOTO70907050 A=VAL(A$):IFA$=" "THENS=S+9ELSEIFA$="T"THENS=17060 IFA>0GOSUB7200:IFER$=""GOTO7085ELSEIFER$=" "GOTO7040ELSEGOTO70307080 GOTO70007085 G0SUB8100:GOSUB10007090 S=1:RETURN7100 CLS'DISP TRACKS7110 PRINT" #    TRACK    RECORD  SET BY":PRINT7130 IFS>E2 THENS=17140 IFS<1THENS=17150 F=S+8:IFF>E2 THENF=E27160 FORN=S TOF7170 PRINTUSING"##";N;:PRINT" ";LEFT$(TF$(N),27)7180 NEXTN7181 PRINT@352,ER$7183 PRINT@384,"PLEASE SELECT A TRACK #"7185 T$="   OR <":IFF<E2 THENPRINTT$+"SPACE> FOR MORE TRACKS"ELSEIFS>1THENPRINTT$+"T> FOR TOP OF LIST"7188 PRINT"   OR <0> TO RETURN TO MENU7190 RETURN7200 'GET TRACK7205 N$="":ER$="":IFF<10GOTO7211ELSEPRINT@408,A$;7210 N$=A$:GOSUB82:IFA$=CHR$(8)THENPRINT@408," ";:ER$=" ":GOTO72907211 N$=N$+A$:N=VAL(N$)7230 IFN>E2 THENPRINT@352,"SORRY, ";N$;" IS NOT A VALID #";:PRINT@408,"  ";:ER$=" ":GOTO72907240 FI$=MID$(TF$(N),4,8):IFFI$=""THENER$="INVALID NUMBER":GOTO72907290 RETURN8000 'LOAD TRACK FROM DISK8007 CLS:PRINT@169,"EN ROUTE TO ";:PRINT@236,FI$;8010 E=08025 FE$=FI$+"/TRK"8030 OPEN"I",#1,FE$8040 IF EOF(1)=-1GOTO80808050 INPUT#1,T8052 E=E+18055 T(E)=T8070 GOTO80408080 CLOSE#18082 GOSUB91008085 CLS8090 F3=1:F4=0:RETURN8100 'LOAD TRACK FROM TAPE8102 IFF5=0GOSUB8000:GOTO81508105 E=08106 PRINT"TO LOAD IN AN EXISTING TRACK":PRINT"FROM CASSETTE,":PRINT"POSITION TAPE & PRESS <PLAY>":PRINT"THEN PRESS ANY KEY":GOSUB828110 FE$=LEFT$(FI$,8)8115 OPEN"I",#-1,FE$8117 INPUT#-1,FI$,LR,LH$,TW8120 IF EOF(-1)=-1GOTO81458125 INPUT#-1,T8130 E=E+18135 T(E)=T8140 GOTO81208145 CLOSE#-18150 CLS8190 F3=1:F4=0:RETURN8500 'SAVE TRACK TO DISK8503 IFFI$<>""GOSUB9600:GOTO85908505 CLS:PRINT"SAVE TRACK? (Y OR N)":GOSUB82:IFA$="N"GOTO8590:IFA$<>"Y"GOTO85058510 INPUT"NAME OF TRACK";FI$:IFFI$=""GOTO85108520 GOSUB96008522 PRINT@33,"I AM SAVING THE TRACK8525 FE$=LEFT$(FI$,8)+"/TRK"8530 OPEN"O",#1,FE$8540 FORN=1TOE8550 PRINT#1,T(N)8570 NEXTN8580 CLOSE#18590 RETURN8600 'SAVE TRACK TO TAPE8605 IFF5=0GOSUB8500:GOTO86908607 IFF4=0GOTO86908610 CLS:PRINT"DO YOU WANT TO SAVE THE TRACK":PRINT"AND LAP RECORD?":GOSUB82:IFA$="N"GOTO8690:IFA$<>"Y"GOTO86108620 IFFE$=""THENINPUT"NAME OF TRACK";FI$:IFFI$=""GOTO86908625 PRINT"POSITION TAPE & PRESS <RECORD>;":PRINT"THEN PRESS ANY KEY":GOSUB828630 FE$=LEFT$(FI$,8)8640 OPEN"O",#-1,FE$8645 PRINT#-1,FI$,LR,LH$,TW8650 FORN=1TOE8660 PRINT#-1,T(N)8670 NEXTN8680 CLOSE#-18690 RETURN9000 'LOAD RECORDS9005 IFF5=1GOTO90909010 DIMTF$(60)9020 OPEN"I",#1,"TRACKS/DAT"9030 IF EOF(1)=-1GOTO90709040 E2=E2+19050 LINEINPUT#1,TF$(E2)9060 GOTO90309070 CLOSE#19080 GOSUB99009090 RETURN9100 'DECODE RECORDS9110 GOSUB98009120 IFTF$=""THEN LR=999:LM$="":CH$="":GOTO91909125 LR=VAL(MID$(TF$,12,7))9130 LH$=MID$(TF$,20,8)9135 CH$=MID$(TF$,28,8)9137 LB=VAL(MID$(TF$,36,3))9140 TW=VAL(MID$(TF$,39,3)):RD$=STRING$(TW,207)9190 RETURN9500 'SAVE RECORDS9503 IFF5=1GOTO95909505 IFF7=0GOTO95909508 CLS:PRINT@33,"I AM MAILING THE LAP RECORDS    TO PARIS9510 OPEN"O",#1,"TRACKS/DAT"9520 FORN=1TOE29530 PRINT#1,TF$(N)9540 NEXTN9550 CLOSE#19590 RETURN9600 'ENCODE RECORDS9605 IFF4=0GOTO96909607 CLS:PRINT@33,"I AM RECORDING THE LAP RECORD":F7=19610 GOSUB98009625 TF$=STRING$(49," ")+"/"9628 MID$(TF$,1,2)=RIGHT$(STR$(INT(LB+1000*LR/E)),2)9630 MID$(TF$,4,8)=FI$9635 MID$(TF$,12,7)=STR$(LR)9640 MID$(TF$,20,8)=LH$9645 MID$(TF$,28,8)=CH$9648 MID$(TF$,36,3)=STR$(LB)9650 MID$(TF$,39,3)=STR$(TW)9660 TF$(CT)=TF$9680 GOSUB99009690 RETURN9800 'LOOK UP CURRENT TRACK9810 TF$=""9812 IFLEN(FI$)<8 THEN FI$=FI$+STRING$(8-LEN(FI$)," ")9820 FORN=1TOE29830 M$=MID$(TF$(N),4,8):IFM$=FI$ THEN TF$=TF$(N):CT=N:N=E29840 NEXTN9880 IFTF$=""THENE2=E2+1:CT=E29890 RETURN9900 '**SORT**9910 FOR N1=E2 TO1 STEP-19920 HI$=TF$(1):HI=1:F6=19940 FORN=1TON19950 IFTF$(N)>=HI$THEN HI$=TF$(N):HI=N9955 IFTF$(N)<TF$(N-1)THENF6=09960 NEXTN9970 TF$(HI)=TF$(N1):TF$(N1)=HI$9975 IFF6=1THENN1=19980 NEXTN19990 RETURN10000 'INFO10010 GOSUB10100:GOSUB8110020 GOSUB10200:GOSUB8110030 GOSUB10300:GOSUB8110090 RETURN10100 CLS'**INFO1**10101 PRINTTAB( 8)"INFORMATION"10102 PRINT10103 PRINT" YOU ARE READY TO PLAY A"10104 PRINT" UNIQUE COMPUTER GAME."10105 PRINT10106 PRINT" REVOLUTION GIVES YOU CONTROL"10107 PRINT" OF A RACE CAR, USING THE RIGHT"10108 PRINT" JOYSTICK FOR STEERING (LEFT"10109 PRINT" TO RIGHT) AND THROTTLE"10110 PRINT" (FORWARD IS FAST, BACK IS"10111 PRINT" SLOW)."10190 RETURN10200 CLS'**INFO2**10201 PRINT10202 PRINT" FIRST SELECT A TRACK TO"10203 PRINT" DRIVE ON."10204 PRINT10205 PRINT" THE COMPUTER WILL GUIDE YOU"10206 PRINT" THROUGH STARTING YOUR LAPS."10207 PRINT10208 PRINT" IF YOU WANT TO COME INTO THE"10209 PRINT" PITS, HOLD DOWN THE RIGHT"10210 PRINT" JOYSTICK'S 'FIRE' BUTTON AS"10211 PRINT" YOU PASS THE START/FINISH"10212 PRINT" LINE."10290 RETURN10300 CLS'**INFO3**10301 PRINT10302 PRINT" THE OTHER SELECTIONS ON THE"10303 PRINT" MAIN MENU WILL ALLOW YOU"10304 PRINT" TO CHANGE CARS OR CREATE A"10305 PRINT" NEW TRACK OF YOUR OWN, WHICH"10306 PRINT" CAN BE SAVED FOR LATER USE."10307 PRINT10308 PRINT" IF YOU PRESS THE WRONG KEY"10309 PRINT" ANYWHERE, OR WANT TO RETURN"10310 PRINT" TO THE MAIN MENU INSTEAD OF"10311 PRINT" CARRYING OUT THE PRESCRIBED"10312 PRINT" ACTION, PRESS <0> OR <ENTER>."10390 RETURN60000 'BREAK DISABLE60001 C$=CHR$(175)60006 PRINT@ 43,"WELCOME";60007 PRINT@ 141,"TO";60008 PRINT@261,STRING$(18,C$);:PRINT@ 293,C$;"T H E  T R A C K";C$;:PRINT@325,STRING$(18,C$);60009 PRINT@ 453,"(C) 1982 BY AL HINE";60010 POKE&H7EA9,83:IFPEEK(&H7EA9)=83GOTO6003060020 CLEAR700,&H3EB0:GOTO6004060030 CLEAR3000,&H7EB0:J=&H4000:J1=&H4060040 IFPEEK(&H3EB9+J)<> &H32 THEN FORI=&H82B9 TO &H831E:POKE I-&H4400+J,PEEK(I):NEXT ELSE 6008060050 FORI=0 TO 2:POKE &H3EBD+I+J,18:NEXT:I=&H3F1E+J60060 POKEI,&H26:POKEI+1,3:POKEI+2,&H7E:POKEI+3,&H83:POKEI+4,&H22:POKEI+5,&H7E60070 POKEI+6,&HA4:POKEI+7,&H4C60080 POKE&H19B,&H3E+J1:RUN 6008560085 IFPEEK(188)=6THENF5=1:FORN=1TO500:NEXTN60087 IFPEEK(&H7EA9)=83THEND=800ELSED=15060090 TW=10:E=0:GOTO300060999 PMODE0:PCLEAR1:GOTO60000