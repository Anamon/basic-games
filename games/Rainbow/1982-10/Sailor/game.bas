10 REM SAILING BY JOHN FRAYSSE20 PCLEAR 5:PMODE 4,1:PCLS:CLS30 PMODE 4,2:PCLS40 DIM PR(29),CH(15),SH(15),B(20,20),V(2,2),ST(15),CT(15)50 PRINT@164,"* * * S A I L I N G * * * ":PRINT@207,"BY":PRINT@233,"CHRIS CROSS AND":PRINT@265,"JOHN FRAYSSE":PRINT@357,"<ENTER> TO CONTINUE"60 PLAY"D;D;L8;D;L8;C;O2;L8;B;O3;L4;D"70 INPUT Z$:CLS80 PRINT@165,"CONTROL INSTRUCTIONS":PRINT@228,"HIT < TO STEER LEFT":PRINT@260,"HIT > TO STEER RIGHT":PRINT@292,"HIT + TO ADD SAIL AREA":PRINT@324,"HIT - TO REDUCE SAIL AREA":PRINT@356,"HIT R TO RESET OR EXIT":PRINT@420,"<ENTER> TO START THE GAME"90 INPUT Z$:CLS100 PRINT@257,"PRESS <PLAY> ON THE RECORDER.   PROGRAM TAKES APPROX. 60 SEC TO READ. <ENTER> WHEN READY."110 INPUT Z$120 PMODE 4,1130 OPEN "I",#1,"DATA"140 IF EOF(1) THEN 280150 FOR I=0 TO 15160 INPUT#1,SH(I),CH(I),ST(I),CT(I)170 FOR J=0 TO 29 STEP 2180 INPUT#1,PR(J),PR(J+1)190 NEXT J200 INPUT#1,XM,YM210 FOR J=0 TO 27 STEP 4220 LINE(PR(J),PR(J+1))-(PR(J+2),PR(J+3)),PSET230 NEXT J240 LINE (PR(28),PR(29))-(XM,YM),PSET250 NEXT I260 CIRCLE(200,40),2,5,1:GET(199,39)-(201,41),V,G270 GOTO 140280 CLOSE #1290 CLS:PRINT@168,"GAME OPTIONS":PRINT@193,"(A) NO WIND GUSTS/NO CURRENT":PRINT@225,"(B) REAL SAILING (BOTH)":PRINT@257,"(S) STOP"300 A$=INKEY$310 IF A$="" THEN 300320 IF A$="S" THEN 1520330 IF A$="B" THEN 360340 XC=0:YC=0:WG=0350 GOTO 370360 XC=RND(4)-2:YC=RND(4)-2:WG=1370 PMODE 4,2:PCLS:SCREEN 1,1380 CIRCLE(12,12),12,5,1390 CIRCLE(40,12),12,5,1400 IF A$="B" THEN PSET(55,12,5)410 LINE(0,12)-(24,12),PSET420 LINE(28,12)-(52,12),PSET430 LINE(40,12)-(40,4),PSET440 X=20:Y=174:J=1:POKE 65495,0:ET=0450 K=3:D0=8:HW=1.57:VW=10:M=260:KH=.13:V=.5:I=4:WT=10460 A$=INKEY$470 IF A$="," THEN I=I-1480 IF A$="." THEN I=I+1490 IF A$="-" THEN K=K-1500 IF A$=";" THEN K=K+1510 IF A$="R" THEN 290520 IF I<0 THEN I=16+I530 IF I>15 THEN I=I-16540 VW=10550 IF WG=1 THEN 570560 GOTO 630570 IF ET>WT THEN 590580 GOTO 630 590 IF ET>(WT+10) THEN 620600 VW=14:SOUND 1,1610 GOTO 630620 WT=WT+30630 V1=V*V:V2=VW*VW:V3=V1+V2+2*V*VW*CH(I)640 VR=SQR(V3):SW=VW*SH(I)/VR650 C=-(V2-V1-V3)/(2*V*VR)660 CW=ABS(C):W=SGN(SW/CW)670 IF K<3 THEN K=3680 IF K>6 THEN K=6690 L=K*V3700 IF I=4 THEN L=0710 H=KH*L*W*CW/M:BH=.74-.25*H/1.57:EH=.75:AH=ABS(H)720 IF ABS(BH)>ABS(EH) THEN 740730 GOTO 750740 SX=BH:BH=EH:EH=SX+.05750 IF AH>1.10 THEN GOTO 770760 GOTO 790770 SOUND 128,1780 GOTO 450790 DH=5.08*AH800 IF AH>.39 THEN DH=9.8-20*AH810 F=L*ABS(SW)+DH-D0*V1820 IF I>9 AND I<15 THEN F=F+.5*L*CW*K830 VD=F/M:V=V+VD840 IF V<13 THEN 860 850 V=13:VD=0860 BR=.5-.5*VR/30870 IF BR<0 THEN 770880 EB=.5+.5*V/15890 IF V<.5 THEN V=.5900 XO=X:YO=Y910 FOR SI=1 TO 2920 ON SI GOTO 930,980930 SS=ABS(215-X)940 IF SS<=4 THEN 960950 GOTO 1020960 IF ABS(40-Y)<=4 OR ABS(162-Y)<=4 THEN 1040970 GOTO 1020980 SS=ABS(60-X)990 IF SS<=4 THEN 10101000 GOTO 10201010 IF ABS(162-Y)<=4 OR ABS(60-Y)<=4 THEN 10401020 NEXT SI1030 GOTO 10501040 SOUND 128,1:SOUND 100,1:ET=ET+51050 X=X+INT(V*ST(I)+XC):Y=Y-INT(V*CT(I)+YC)1060 IFX<15 THEN X=151070 IFX>242 THEN X=2421080 IF Y<35 AND X<85 THEN Y=351090 IFY<14 THEN Y=141100 IFY>178 THEN Y=1781110 IF X>60 AND X<70 AND Y>162 THEN 11301120 GOTO 11501130 J=J+11140 IF J>2 AND ET<20 THEN J=21150 ON J GOTO 1200,1160,11801160 ET=ET+1:DRAW"BM137,111;U6;L3;R6"1170 GOTO 12001180 CLS:PRINT@167,"YOU FINISHED!":PRINT@199,"ELAPSED TIME= ";ET:PRINT@231,"<ENTER> WHEN READY"1190 INPUT Z$:GOTO 2901200 CIRCLE (12,12),9,0,1,.5,11210 CIRCLE(12,12),9,5,1,.5,EB1220 CIRCLE(40,12),9,0,11230 CIRCLE(40,12),9,5,1,BR,.51240 LINE(12,12)-(12,22),PRESET1250 LINE(12,12)-(19,19),PRESET1260 LINE(12,12)-(5,19),PRESET1270 IF ABS(VD)<.2 THEN LINE(12,12)-(12,22),PSET1280 IF VD>.2 THEN LINE(12,12)-(19,19),PSET1290 IF VD<-.2 THEN LINE(12,12)-(5,19),PSET1300 CIRCLE(40,12),9,0,1,.5,11310 CIRCLE(40,12),9,5,1,BH,EH1320 IF K<KX THEN 13401330 GOTO 13801340 FOR IS=K+1 TO KX1350 LINE(45+IS*5,8)-(45+IS*5,16),PRESET1360 NEXT IS1370 GOTO 13901380 LINE(45+K*5,8)-(45+K*5,16),PSET1390 KX=K1400 PMODE 4,11410 GET(101,25)-(121,45),B,G1420 PMODE4,21430 PUT(XO-10,YO-10)-(XO+10,YO+10),B,PSET1440 PMODE 4,11450 GET((I*20+2),0)-((I*20+22),20),B,G1460 IF I>=12 THEN GET(((I-12)*20+1),21)-(((I-12)*20+21),41),B,G1470 PMODE 4,21480 PUT(X-10,Y-10)-(X+10,Y+10),B,OR1490 PUT(214,39)-(216,41),V,OR:PUT(214,161)-(216,163),V,OR:PUT(59,161)-(61,163),V,OR:PUT(59,59)-(61,61),V,OR:LINE(60,162)-(60,192),PSET1500 LINE(249,96)-(255,90),PSET:LINE(255,102)-(249,96),PSET1510 GOTO 4601520 POKE 65494,0:CLS:STOP