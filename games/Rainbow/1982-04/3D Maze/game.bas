2 '        3DMAZE           '3 '          BY             '4 '     SCOTT L. BAIN       '5 '                         '6 '    P.O. BOX 178114      '7 '     SAN DIEGO, CA       '8 '             92117       '9 '------------------------' 10 PMODE 0,1:PCLEAR4:PCLS:CLS15 POKE65495,020 DIM M(11,11),F(50,2),V(5,2)25 FORI=1TO10:SOUND110,1:NEXTI30 PRINT@331,"\      /":PRINT@395,"/      \":PRINT@364,"3DMAZE"35 PRINT@0,"PLEASE WAIT 1 MINUTE WHILE I    CREATE THE MAZE.";40 FR=0:X=5:Y=5:M(X,Y)=1:FORI=-1TO1:FORJ=-1TO1:IFI<>0ANDJ<>0THEN50ELSEIFI=0ANDJ=0THEN5045 M(X+I,Y+J)=-1:FR=FR+1:F(FR,1)=X+I:F(FR,2)=Y+J50 NEXT J,I55 CR=RND(FR):X=F(CR,1):Y=F(CR,2)60 Z=0:FORI=-1TO1:FORJ=-1TO1:IFI<>0ANDJ<>0THEN7065 IFM(X+I,Y+J)=1THENZ=Z+170 NEXTJ,I75 IFZ<2THEN9580 M(X,Y)=-285 FOR I=CR TO FR90 F(I,1)=F(I+1,1):F(I,2)=F(I+1,2):NEXTI:FR=FR-1:GOTO11095 M(X,Y)=1:FORI=-1TO1:FORJ=-1TO1:IFI<>0ANDJ<>0THEN105100 IFM(X+I,Y+J)=0ANDX+I>0ANDX+I<11ANDY+J>0ANDY+J<11THEN M(X+I,Y+J)=-1:FR=FR+1:F(FR,1)=X+I:F(FR,2)=Y+J105 NEXT J,I:PRINT".";:GOTO85110 IF FR<>0THEN55115 X=5:Y=5120 D=RND(4)125 TX=10:TY=RND(10):IF M(TX,TY)<>1 OR  TY=5 THEN 125130 V(0,1)=0:V(0,2)=1:V(1,1)=1:V(1,2)=0:V(2,1)=0:V(2,2)=-1:V(3,1)=-1:V(3,2)=0:V(4,1)=0:V(4,2)=1:V(5,1)=1:V(5,2)=0135 CLS:PRINT"TURN THE SOUND UP.":PRINT:PRINT"YOUR OBJECT IS TO FIND THE HOLE IN THE FLOOR AND ESCAPE.":PRINT140 PRINT"USE THE ARROW KEYS TO MOVE      YOUR SELF FORWARD, OR TURN RIGHTOR LEFT, OR TO TURN AROUND.":PRINT"USE THE 'C' KEY TO CHANGE       SCREENS.":PRINT145 TIMER=0150 PRINT"WOULD YOU LIKE:":PRINT"1- EASY TIMER, SIMPLE SCREEN.":PRINT"2- HARD TIMER, COMPLETE SCREEN.":INPUT SP: IF SP<>1 AND SP<>2 THEN CLS:GOTO 135155 IF SP=2 THEN TL=0:PRINT"NO HELPER TRAIL POSSIBLE.":FORI=1TO150:NEXTI:GOTO 165160 INPUT"DO YOU WANT A HELPER TRAIL";A$:IF MID$(A$,1,1)="Y" THEN TL=1 ELSE TL=0165 IFPAGE=2THENPAGE=1ELSEPAGE= 2170 PMODE 0,PAGE175 POKE65495,0180 IF X=TX AND Y=TY THEN 440185 RESTORE 190 PCLS:LINE(0,0)-(254,190),PSET:LINE(254,0)-(0,190),PSET195 LINE(10,8)-(244,182),PSET,B:IF M(X+V(D,1),Y+V(D,2))<.1THENC9=1ELSEC9=0200 X1=X:Y1=Y:DR=D-1:DL=D+1205 M(X,Y)=1.1210 FOR I=1 TO 4215 X1=X1+V(D,1):Y1=Y1+V(D,2)220 READ E1,F1,E2,F2,B1,B2,B3,B4,B5,B6,B7,B8,D1,D2,D3,D4,D5,D6,D7,D8,CY,CR225 LINE(E1,F1)-(E2,F2),PSET,B230 IF X1=TX AND Y1=TY THEN CIRCLE (126,CY),CR,,.5235 IF M(X1,Y1)=1.1 AND TL=1 THEN PSET(126,CY,5)240 IF M(X1+(V(DL,1)),Y1+(V(DL,2)))<.1 THEN 255245 IF SP=2 THEN LINE(B1,B2)-(B3,B4),PRESET,B250 LINE(D1,D2)-(D3,D4),PSET,B255 IF M(X1+(V(DR,1)),Y1+(V(DR,2)))<.1 THEN 270260 IF SP=2 THEN LINE (B5,B6)-(B7,B8),PRESET,B 265 LINE(D5,D6)-(D7,D8),PSET,B270 O1=X1+(V(D,1)):O2=Y1+(V(D,2))275 IF O1<1 OR O1>10 OR O2<1 OR O2>10 THEN 290280 IF M(O1,O2)<1 THEN 290285 NEXT I290 IFSP =2 THENLINE(128,8)-(128,96),PRESET,B:LINE(128,98)-(236,188),PRESET:LINE(126,98)-(22,180),PRESET:PAINT(128,5),5,5295 IF C9=1 THEN LINE(12,6)-(242,184),PRESET,BF:GOTO305300 LINE(E1+2,F1-2)-(E2-2,F2+2),PRESET,BF305 SCREEN 1,1310 POKE65494,0315 IFSP=2THEN SOUND 200,2320 A$=INKEY$325 IF A$<>"^" THEN 345330 IF M(X+V(D,1),Y+V(D,2))<.1THEN 345335 X=X+V(D,1):Y=Y+V(D,2)340 SOUND 100,3:GOTO 165345 IF A$<>CHR$(8) THEN 365350 SOUND 100,3355 D=D+1:IF D>4 THEN D=1360 GOTO 165365 IF A$<>CHR$(9) THEN 385370 SOUND 100,3375 D=D-1:IF D<1 THEN D=4380 GOTO 165385 IF A$="C" THEN SOUND200,2:CLS:GOTO 150390 IF A$<>CHR$(10) THEN 320395 SOUND 100,3400 D=D-2:IF D<1 THEN D=D+4405 GOTO 165410 GOTO 320415 CLS:POKE65495,0:GOTO50420 DATA 58,146,196,44,26,16,28,174,224,20,220,170,10,44,58,146,244,44,196,146,166,16425 DATA 90,122,164,68,74,54,78,136,176,56,172,134,58,68,90,122,164,68,196,122,134,12430 DATA 106,110,148,80,102,74,104,116,152,74,150,116,90,80,106,110,148,80,164,110,116,8435 DATA 114,104,140,86,110,82,112,108,144,82,142,108,106,86,114,104,140,86,148,104,107,6440 CLS:PRINT "ESCAPE!  TIME=";TIMER:PRINT:PRINT445 FOR I=10 TO 1 STEP -1:FOR I1=1 TO 10450 IF I=TX AND I1=TY THEN PRINT "O"; ELSE IF M(I,I1)=1 THEN PRINT "X"; ELSE IF M(I,I1)=1.1 THENPRINT"*"; ELSE PRINT " ";455 NEXT I1: PRINT: NEXT I460 PRINT@209,"X= UNEXPLORED":PRINT@241,"*= EXPLORED":PRINT@273,"O= ESCAPE":PRINT@448,"";465 INPUT"ANOTHER MAZE";A$:IF MID$(A$,1,1)="Y" THEN RUN470 POKE65494,0475 END