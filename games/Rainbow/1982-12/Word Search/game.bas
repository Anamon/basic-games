5 CLEAR:CLS:PRINT10 PRINTTAB(13)"PUZZLE"40 PRINT50 PRINT"  WORD SEARCH PUZZLE GENERATOR"160 PRINT@448,"   PRESS ANY KEY TO CONTINUE"170 A$=INKEY$:IF A$=""THEN170200 CLS:PRINT280 CLEAR 3000310 PW=80 :REM PRINTER COLUMN WIDTH330 PRINT"WHAT IS TO BE THE WIDTH OF THE  PUZZLE (";PW/2-1;"MAXIMUM )":INPUTW:MD=W:PRINT340 IF W*2<PW THEN 345343 PRINT"THAT WILL NOT FIT IN";PW;"COLUMNS ":GOTO 330345 IF W<1 THEN 330348 PRINT350 INPUT"WHAT IS TO BE THE LENGTH  OF THEPUZZLE";L :IFL>W THEN MD=L355 IF L<1 THEN 350358 PRINT360 INPUT"WHAT IS THE MAXIMUM NUMBER OF   WORDS IN THE PUZZLE (MUST BE AT LEAST 2 WORDS";M370 IF M<2 THEN 360380 PRINT:INPUT"HOW MANY COPIES OF THE PUZZLE   DO YOU WANT ( 1 IS THE MINIMUM ) ";NP381 IF NP<1 THEN 380390 DIM A$(L,W),W$(M)400 DIM W(M,3),DXY(8,2),DD(28)405 CLS:PRINT410 PRINT"ENTER A HEADING THAT WILL BE    PRINTED OVER THE PUZZLE         (";PW;"CHARACTERS MAXIMUM)":INPUTH$:PRINT430 CLS:PRINT440 PRINT"ENTER A WORD AT EACH QUESTION   MARK" :PRINT450 PRINT"TO REDO THE PREVIOUS            TYPE A HYPHEN (-)" :PRINT460 PRINT"WHEN YOU RUN OUT OF WORDS            TYPE A PERIOD (.)" :PRINT470 FOR I=1 TO M474 PRINT475 IF I=M THEN PRINT"*ONLY ONE MORE WORD CAN BE USED*"479 PRINT480 INPUT T$ : IF T$="-" THEN I=I-1 : PRINT"REDO ";W$(I);"...":GOTO480490 IF T$="." THEN 655500 IF LEN(T$)=0 THEN PRINT"INPUT ERROR; REDO ";W$(I);"...": GOTO 480510 J=1520 TE$=MID$(T$,J,1):IFTE$>="A" AND TE$<="Z" THEN 570525 IF TE$<"A" OR TE$<"Z" THEN 530527 NID$(T$,J,1)=CHR$(ASC(MID$(T$,J,1)+32) :GOTO 570530 IF TE$=T$ THEN T$="": GOTO 580540 IF J=LEN(T$) THEN T$=LEFT$(T$,J-1): GOTO 570550 IF J=1 THEN T$=RIGHT$(T$,LEN(T$)-1): J=J-1 : GOTO 570560 T$=LEFT$(T$,J-1)+RIGHT$(T$,LEN(T$)-J): J=J-1570 J=J+1 : IF J<=LEN(T$) THEN 520580 PRINTI;"-";T$;"-"600 IF LEN(T$)<=MD THEN 610605 PRINT"TOO LONG, TRY A SHORTER WORD":GOTO480610 FOR IZ=1TO I=1 : IF W$(IZ)<>T$ THEN NEXT : GOTO 630620 PRINT"YOU ENTERED THAT ONE ALREADY    TRY ANOTHER WORD":GOTO 480630 W$(I)=T$640 NEXT I655 CLS:PRINT660 PRINT"THINKING"680 FOR I=1 TO M-1685 FOR J=I+1 TO M690 IF LEN(W$(I)) < LEN(W$(J)) THEN HZ$=W$(I): W$(I)=W$(J) :W$(J)=HZ$700 NEXT J : NEXT I710 FOR I=1TO8:READ DXY(I,1),DXY(I,2):NEXTI720 FOR I=1TO28 : READ DD(I) :NEXT I730 DATA 0,1,1,1,1,0,1,-1,0,-1,-1,-1,-1,0,-1,1740 DATA 2,4,6,8,2,4,6,8,2,4,6,8,2,4,6,8,2,4,6,8,2,4,6,8,1,3,5,7750 FOR I= 1 TO M760 LN=LEN(W$(I))770 NT=0790 SD=DD(RND(28))800 SX=RND(W):X1=SX+(LN-1)*DXY(SD,1):IF X1<1 OR X1>W THEN 790810 SY=RND(L):X1=SY+(LN-1)*DXY(SD,2):IF X1<1 OR X1>L THEN 790820 NT=NT+1:IF NT<>W*L*2 THEN 850830 CLS:PRINT:PRINT"COULDN'T FIT ";W$(I):PRINT"IN THE PUZZLE":PRINT831 PRINT"TO CONTINUE MEANS ";W$(I):PRINT"WILL BE LEFT OUT"832 PRINT:PRINT"DO YOU WANT TO CONTINUE (Y/N)"833 A$=INKEY$:IFA$=""THEN833834 IFA$<>"Y"ANDA$<>"N"THEN 832835 IF A$="N" THEN 5 ELSE PRINT:PRINT"CONTINUING"836 W$(I)=" " : GOTO 950850 J=SY:K=SX860 FOR P=1 TO LN870 IF LEN(A$(J,K)) AND A$(J,K) <> MID$(W$(I),P,1) THEN 790880 J=J+DXY(SD,2):K=K+DXY(SD,1):NEXTP900 J=SY : K=SX910 FOR P=1 TO LN : A$(J,K)=MID$(W$(I),P,1)920 J =J+DXY(SD,2) : K=K+DXY(SD,1) : NEXT P940 W(I,1)=SX: W(I,2)=SY: W(I,3)=SD950 NEXT I970 FOR I=1TOL975 FOR J=1TOW980 NZ=RND(90)982 IF NZ<65 THEN GOTO 980985 IF A$(I,J)="" THEN A$(I,J)=CHR$(NZ)990 NEXTJ : NEXTI1010 FOR I=1 TO M-1 : FOR J=I+1 TO M1020 IF W$(I)<W$(J) THEN 10301021 HZ$=W$(I) : W$(I)=W$(J) : W$(J)=HZ$1025 FOR K=1 TO 3: HZ=W(I,K) : W(I,K)=W(J,K) : W(J,K)=HZ : NEXT K1030 NEXT J : NEXT I1040 GOSUB 20001050 CLS:PRINT1060 PRINT"DO YOU WANT AN ANSWER KEY (Y/N)"1070 X$=INKEY$:IFX$=""THEN10701073 IF X$<>"Y"ANDX$<>"N"THEN 10501076 IF X$="N"THEN CLS:PRINT:PRINT"FINISHED":END1080 H$="ANSWER KEY"1090 NP=11100 CLS:PRINT:PRINT"THINKING"1110 FORI=1TOL:FORJ=1TOW:A$(I,J)=". ":NEXTJ:NEXTI1120 FORI=1TOM1130 LN=LEN(W$(I)):J=W(I,2):K=W(I,1)1132 FOR P=1TOLN1134 A$(J,K)=MID$(W$(I),P,1)1140 J=J+DXY(W(I,3),2): K=K+DXY(W(I,3),1):NEXTP1150 NEXT I1160 GOSUB 20001165 PRINT#-2," "1170 CLS:PRINT:PRINT"FINISHED":END2000 FOR H=1TONP2010 T=(PW-2*W)/22020 FORI=1TO3:PRINT#-2," ":NEXTI2030 PRINT#-2,TAB((PW-LEN(H$))/2);H$2040 PRINT#-2," "2050 FOR J=1 TO L2060 PRINT#-2,TAB(T);2070 FOR K= 1 TO W2080 IF A$(J,K)=". " THEN PRINT#-2,". ";2090 IF A$(J,K)=". " THEN 21102100 PRINT#-2,A$(J,K);" ";2110 NEXT K2120 PRINT#-2," "2130 NEXT J2140 PRINT#-2," "2150 PRINT#-2,"FIND THESE HIDDEN WORDS IN THE  ABOVE PUZZLE:"2160 PRINT#-2," "2170 FOR J=1 TO M: IF LEN(W$(J))=0 THEN 22002180 IF POS(-2)+LEN(W$(J)) > PW-2 THEN PRINT#-2," "2190 PRINT#-2,W$(J),2200 NEXT J : PRINT#-2," "2205 NEXT H2210 RETURN