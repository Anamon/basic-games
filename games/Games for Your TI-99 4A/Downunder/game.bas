10 REM  *************
20 REM  * DOWNUNDER *
30 REM  *************
40 REM  BY Kevin Burfitt
50 REM
60 CALL CLEAR
70 PRINT "DOWNUNDER": :"MOVE YOUR KANGAROO WITH THE ARROW KEYS": :"TRY TO REACH THE DOOR (";CHR$(30);")"
80 PRINT "AT THE BOTTOM OF THE SCREEN.DONT RUN INTO THE RIVER (f),DINGO (p),PLATYPUS (h)":"OR THE WOMBAT (e)"
90 PRINT : :"GET POINTS FOR HITTING THE  MAGIC ITEMS (ijklm),BUT MAKESURE YOU DONT RUN OF":"TIME BY EATING";
100 PRINT " VEGEMITE (g)": :"GOOD LUCK": :
110 REM
120 RANDOMIZE
130 DEF BIN(X)=((L/2^X)<>INT(L/2^X))*(((L/2^X)-INT(L/2^X))>=0.5)
140 REM
150 REM  SETUP
160 LIVES=3
170 SCORE=0
180 CALL CHAR(100,"060704070E1E24CF")
190 CALL CHAR(101,"00037FFEFEFC486C")
200 CALL CHAR(99,"183C7E7E3C18183C")
210 CALL CHAR(102,"04E318C6318C6318")
220 CALL CHAR(103,"007E7E66667E3C18")
230 CALL CHAR(104,"0000003FFF123600")
240 CALL CHAR(105,"00424218184242")
250 CALL CHAR(106,"00544554455445")
260 CALL CHAR(107,"007E425A5A427E")
270 CALL CHAR(108,"0042424242422418")
280 CALL CHAR(109,"001818FFFF1818")
290 CALL CHAR(112,"0000027FFC78486C")
300 INPUT "STARTING LEVEL(1..5)?":BL
310 IF (BL>5)+(BL<1)THEN 300
320 L=BL
330 GOSUB 1730
340 CALL HCHAR(23,1,32,32)
350 X=17
360 CALL HCHAR(23,17,100)
370 GOSUB 1300
380 PRINT :
390 FOR I=2 TO 23
400 IF I=R THEN 550
410 CALL HCHAR(24,1,32,32)
420 IF I=D THEN 470
430 FOR J=1 TO -L*(L<11)-10*(L>10)
440 CALL HCHAR(23,RND*31+1,99)
450 NEXT J
460 GOTO 570
470 D=INT(RND*29)+1
480 CALL HCHAR(23,1,102,32)
490 CALL HCHAR(23,D,32,2)
500 D=24-INT(RND*I)
510 CALL HCHAR(D,1,102,32)
520 CALL HCHAR(D,D,32,2)
530 D=1
540 GOTO 570
550 CALL HCHAR(23,1,102,32)
560 CALL HCHAR(23,RND*28+1,32,3)
570 PRINT :
580 NEXT I
590 CALL HCHAR(RND*23+1,RND*31+1,32+71*F)
600 CALL HCHAR(24,1,32,32)
610 CALL HCHAR(24,RND*31+1,30)
620 IF W=0 THEN 650
630 WY=INT(RND*23)+1
640 WX=1
650 IF P=0 THEN 680
660 PY=INT(RND*23)+1
670 PX=1
680 GOSUB 1490
690 CALL KEY(1,K,S)
700 XX=X+(K=2)-(K=3)
710 YY=Y+(K=5)-(K+1=1)
720 IF (XX<1)+(YY<1)+(XX>32)+(YY>24)+(S=0)THEN 800
730 CALL GCHAR(YY,XX,HIT)
740 IF (HIT=32)+(HIT=100)THEN 770
750 IF HIT=103 THEN 1150
760 IF HIT=99 THEN 800 ELSE 1190
770 CALL HCHAR(Y,X,32)
780 Y=YY
790 X=XX
800 CALL HCHAR(Y,X,100)
810 IF W=0 THEN 870
820 CALL HCHAR(WY,WX,32)
830 WX=WX+1+32*(WX=32)
840 CALL GCHAR(WY,WX,HIT)
850 IF HIT=100 THEN 1080
860 CALL HCHAR(WY,WX,101)
870 IF P=0 THEN 930
880 CALL HCHAR(PY,PX,32)
890 PX=PX-1-32*(PX=1)
900 CALL GCHAR(PY,PX,HIT)
910 IF HIT=100 THEN 1080
920 CALL HCHAR(PY,PX,104)
930 IF DD<>1 THEN 970
940 DI=DX
950 DJ=DY
960 GOSUB 1800
970 TIME=TIME-1
980 IF TIME<>50 THEN 1000
990 DD=1
1000 DD=DD-1-(DD<2)
1010 IF TIME>20 THEN 690
1020 CALL SOUND(-100,440,0,441,2,442,4)
1030 IF TIME>1 THEN 690
1040 REM
1050 CALL SOUND(1000,440,0,441,2,442,4)
1060 PRINT "NO VEGEMITE"
1070 PRINT "No VEGEMITE !"
1080 LIVES=LIVES-1
1090 X=17
1100 TIME=200
1110 Y=1
1120 PRINT :"NEXT KANGAROO":
1130 IF LIVES>-1 THEN 370
1140 GOTO 1620
1150 CALL SOUND(100,660,0,880,2,1100,4)
1160 SCORE=SCORE+5
1170 TIME=TIME+20
1180 GOTO 770
1190 IF HIT=30 THEN 1220
1200 IF HIT>104 THEN 1560
1210 GOTO 1080
1220 SCORE=SCORE+10
1230 L=L+1
1240 TIME=TIME+10+(140-TIME)*F
1250 CALL HCHAR(Y,X,32)
1260 Y=1
1270 X=XX
1280 CALL HCHAR(YY,XX,100)
1290 GOTO 370
1300 F=BIN(1)
1310 TIME=-150*(L=BL)+TIME
1320 DX=1
1330 DY=24
1340 W=BIN(2)
1350 R=INT(RND*23)*BIN(3)+1
1360 P=BIN(4)
1370 D=BIN(5)
1380 DD=D
1390 CALL CHAR(32,"55AA55AA55AA55AA")
1400 FG=13-2*D
1410 BG=3+9*D
1420 CALL COLOR(1,FG,BG)
1430 FOR I=2 TO 14
1440 CALL COLOR(I,2,BG)
1450 NEXT I
1460 D=INT(RND*22)*D+1
1470 Y=1
1480 RETURN
1490 REM  SOUND
1500 N=1-(L<10)-(L<5)
1510 FOR I=N TO 5
1520 CALL HCHAR(RND*23+1,RND*31+1,104+I)
1530 NEXT I
1540 REM  CALL SOUND()
1550 RETURN
1560 SCORE=SCORE+110-HIT
1570 CALL HCHAR(YY,XX,48+110-HIT)
1580 CALL SOUND(100,440,1,441,2,442,3)
1590 DD=10+10*(DD=0)
1600 CALL SOUND(80,660,1,661,2,662,3)
1610 GOTO 770
1620 DATA 71,97,109,101,32,111,118,101,114
1630 RESTORE 1620
1640 FOR I=1 TO 9
1650 READ A
1660 CALL HCHAR(9,10+I,A)
1670 NEXT I
1680 PRINT : : : : :"YOUR SCORE ->";SCORE: : :
1690 PRINT "DO YOU WISH TO CONTINUE (CON)OR PLAY A NEW GAME(NEW)"
1700 INPUT "CON or NEW ?":A$
1710 IF A$="CON" THEN 32767
1720 GOTO 32767
1730 DATA DOWNUNDER TUNE
1740 RESTORE 1730
1750 FOR I=1 TO []
1760 READ D,N,L
1770 CALL SOUND(D,N,L)
1780 NEXT I
1790 RETURN
1800 DI=DX+(X<DX)-(X>DX)
1810 CALL GCHAR(DY,DI,HIT)
1820 IF HIT=100 THEN 1080
1830 IF (HIT<>102)*(HIT<>30)*(HIT<>112)THEN 1900
1840 DI=DX
1850 DJ=DY+(Y<DY)-(Y>DY)
1860 CALL GCHAR(DJ,DX,HIT)
1870 IF HIT=100 THEN 1080
1880 IF (HIT<>102)*(HIT<>30)*(HIT<>112)THEN 1900
1890 DJ=DY
1900 CALL HCHAR(DY,DX,32)
1910 DX=DI
1920 DY=DJ
1930 CALL HCHAR(DY,DX,112)
1940 RETURN
