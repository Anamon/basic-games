10 REM  3-D MAZE
20 REM
30 INPUT "FOREGROUND,BACKGROUND COLOR ?":FG,BG
40 DIM ROOM(10,10),HUH(11,4),C(11,4)
50 GOSUB 680
60 A$(1)="SOUTH"
70 A$(2)="WEST"
80 A$(3)="NORTH"
90 A$(4)="EAST"
100 FOR X=1 TO 10
110 FOR Y=1 TO 10
120 READ ROOM(X,Y)
130 NEXT Y
140 NEXT X
150 FOR I=1 TO 11
160 READ HUH(I,3),HUH(I,4),HUH(I,1),HUH(I,2)
170 NEXT I
180 XX=1
190 YY=1
200 FACE=1
210 FOR I=1 TO 11
220 READ C(I,1),C(I,2),C(I,3),C(I,4)
230 NEXT I
240 REM
250 REM   ^SETUP,RUNv
260 GOTO 390
270 CALL SOUND(-500,110,0)
280 CALL KEY(1,K,S)
290 IF S=0 THEN 280
300 K=-(K=5)-2*(K=3)-3*(K+1=1)-4*(K=2)
310 K=K-(K=0)
320 FACE=FACE+(K=4)-2*(K=3)-(K=2)
330 FACE=FACE+4*(FACE>4)-4*(FACE<1)
340 IF K=1 THEN 360
350 GOTO 390
360 IF HUH(ROOM(XX,YY),FACE)=0 THEN 270
370 XX=XX+(FACE=3)-(FACE=1)
380 YY=YY+(FACE=2)-(FACE=4)
390 R=C(ROOM(XX,YY),FACE)
400 CALL CLEAR
410 REM  PRINT UP INFO
420 A=1
430 IF (R=1)+(R=2)+(R=4)+(R=7)THEN 450
440 A=2
450 GOSUB 890
460 A=7
470 IF (R=2)+(R=3)+(R=6)+(R=9)THEN 490
480 A=8
490 GOSUB 890
500 A=11
510 IF (R=4)+(R=5)+(R=6)+(R=10)THEN 520 ELSE 540
520 GOSUB 890
530 GOTO 280
540 R=C(ROOM(XX+(FACE=3)-(FACE=1),YY+(FACE=2)-(FACE=4)),FACE)
550 A=3
560 IF (R=1)+(R=2)+(R=4)+(R=7)THEN 580
570 A=4
580 GOSUB 890
590 A=5
600 IF (R=2)+(R=3)+(R=6)+(R=9)THEN 620
610 A=6
620 GOSUB 890
630 A=10
640 IF (R=4)+(R=5)+(R=6)+(R=10)THEN 660
650 A=9
660 GOSUB 890
670 GOTO 280
680 REM  SEND THE 'SETUP' TO HERE
690 A$(1)="80C0E0F0F8FCFEFF"
700 A$(2)="FFFEFCF8F0E0C080"
710 A$(3)="FF7F3F1F0F070301"
720 A$(4)="0103070F1F3F7FFF"
730 A$(5)="FFFFFFFFFFFFFFFF"
740 A$(6)="0"
750 CALL CHAR(139,A$(1))
760 CALL CHAR(140,A$(2)) 
770 CALL CHAR(141,A$(3))
780 CALL CHAR(142,A$(4))
790 CALL CHAR(143,A$(5))
800 REM CALL CHAR(144,A$(6))
810 CALL COLOR(14,FG,1)
820 CALL SCREEN(BG)
830 IF BG>2 THEN 870
840 FOR I=1 TO 13
850 CALL COLOR(I,16,BG)
860 NEXT I
870 REM  139=\B,140=\T,141=/T,142=/B,143=FULL,144=BLANK
880 RETURN
890 REM  SEND THE MAP TO HERE
900 IF (A<1)+(A>12)THEN 920
910 ON A GOSUB 930,1000,1070,1140,1210,1280,1350,1420,1490,1610,1660,1710
920 RETURN
930 REM  LHS FRONT SOLID, COLOR=N
940 FOR I=1 TO 6
950 CALL HCHAR(I,I,139)
960 CALL HCHAR(25-I,I,140)
970 CALL VCHAR(I+1,I,143,24-2*I)
980 NEXT I
990 RETURN
1000 REM  LHS FRONT DOOR, COLOR=N
1010 FOR I=1 TO 6
1020 CALL VCHAR(6,I,143,14)
1030 NEXT I
1040 CALL HCHAR(6,6,139)
1050 CALL HCHAR(19,6,140)
1060 RETURN
1070 REM  LHS SIDE WALL,COLOR=N
1080 FOR I=7 TO 10
1090 CALL HCHAR(I,I,139)
1100 CALL HCHAR(25-I,I,140)
1110 CALL VCHAR(I+1,I,143,24-I*2)
1120 NEXT I
1130 RETURN
1140 REM  LHS SIDE DOOR, COLOR=N
1150 FOR I=7 TO 10
1160 CALL VCHAR(10,I,143,6)
1170 NEXT I
1180 CALL HCHAR(10,10,139)
1190 CALL HCHAR(15,10,140)
1200 RETURN
1210 REM  RHS SIDE WALL,COLOR=N
1220 FOR I=15 TO 18
1230 CALL HCHAR(I,I,141)
1240 CALL HCHAR(25-I,I,142)
1250 CALL VCHAR(26-I,I,143,I*2-26)
1260 NEXT I
1270 RETURN
1280 REM  RHS SIDE DOOR,COLOR=N
1290 FOR I=15 TO 18
1300 CALL VCHAR(10,I,143,6)
1310 NEXT I
1320 CALL HCHAR(10,15,142)
1330 CALL HCHAR(15,15,141)
1340 RETURN
1350 REM  RHS FRONT WALL,COLOR=N
1360 FOR I=19 TO 24
1370 CALL HCHAR(I,I,141)
1380 CALL HCHAR(25-I,I,142)
1390 CALL VCHAR(26-I,I,143,I*2-26)
1400 NEXT I
1410 RETURN
1420 REM  RHS FRONT DOOR,COLOR=N
1430 FOR I=19 TO 24
1440 CALL VCHAR(6,I,143,14)
1450 NEXT I
1460 CALL HCHAR(6,19,142)
1470 CALL HCHAR(19,19,141)
1480 RETURN
1490 REM  CENTER FOREVER
1500 FOR I=11 TO 12
1510 CALL HCHAR(I,I,139)
1520 CALL HCHAR(25-I,I,140)
1530 NEXT I
1540 FOR I=13 TO 14
1550 CALL HCHAR(I,I,141)
1560 CALL HCHAR(25-I,I,142)
1570 NEXT I
1580 CALL VCHAR(12,11,143,2)
1590 CALL VCHAR(12,14,143,2)
1600 RETURN
1610 REM CENTER WALL
1620 FOR I=10 TO 15 
1630 CALL VCHAR(10,I,143,6)
1640 NEXT I
1650 RETURN
1660 REM  MIDDLE 'BIG' WALL
1670 FOR I=6 TO 19
1680 CALL VCHAR(6,I,143,14)
1690 NEXT I
1700 RETURN
1710 CALL CLEAR
1720 RETURN
1730 DATA 4,5,5,5,5,5,5,5,5,6
1740 DATA 7,8,9,7,8,9,7,8,9,2
1750 DATA 7,1,7,9,1,7,9,4,9,2
1760 DATA 1,8,8,8,8,11,8,8,8,8
1770 DATA 1,3,1,3,1,3,1,3,1,3
1780 DATA 4,6,4,6,4,6,4,6,4,6
1790 DATA 1,3,1,3,1,3,1,3,1,3
1800 DATA 1,1,1,1,1,1,1,1,1,1
1810 DATA 1,1,1,1,1,1,1,1,1,1
1820 DATA 1,1,1,1,1,1,1,1,1,1
1830 DATA 1,1,0,0,1,0,1,0,1,0,0,1,0,1,1,0,0,1,0,1,0,0,1,1,1,1,1,0,1,1,0,1,1,0,1,1
1840 DATA 0,1,1,1,1,1,1,1
1850 DATA 6,4,1,3,2,5,2,5,4,1,3,6,3,6,4,1,5,2,5,2,1,3,6,4,9,10,7,8,10
1860 DATA 7,8,9,7,8,9,10,8,9,10,7,11,11,11,11
