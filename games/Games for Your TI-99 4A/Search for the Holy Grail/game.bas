10 REM SEARCH FOR THE HOLY GRAIL
20 GAMES=1
30 TOTS=387
40 HS=387
50 RANDOMIZE
60 CALL SCREEN(2)
70 SPEED=4
80 Y=23
90 A=8
100 B=8
110 R=10
120 C=16
130 X=2
140 CALL CHAR(131,"FFC3A59999A5C3FF")
150 OP=0
160 X$(0)="0000001"
170 X$(1)="0000001818"
180 X$(2)="000018303018"
190 X$(4)="3C7EFFFFFFFF7E3C"
200 X$(3)="00183C7E7E3C18"
210 X$(5)=X$(4)
220 X$(6)=X$(4)
230 X$(7)=X$(3)
240 CALL CHAR(145,X$(0))
250 X$(8)=X$(2)
260 X$(9)=X$(1)
270 CALL CLEAR
280 CALL HCHAR(24,1,131,64)
290 CALL VCHAR(1,32,131,48)
300 CALL HCHAR(11,16,138)
310 CALL HCHAR(3,3,131,13)
320 CALL HCHAR(3,17,131,10)
330 CALL VCHAR(3,15,131,9)
340 CALL CHAR(133,"00101038101")
350 CALL VCHAR(3,17,131,9)
360 CALL HCHAR(12,15,131,3)
370 CALL HCHAR(2,2,133,1)
380 CALL HCHAR(9,5,131,10)
390 CALL HCHAR(11,5,131,10)
400 CALL HCHAR(10,15,32,4)
410 CALL VCHAR(5,3,131,10)
420 CALL VCHAR(3,30,131,10)
430 CALL HCHAR(22,2,131,8)
440 CALL CHAR(138,"00FF7E3C18187E7E")
450 CALL HCHAR(22,11,131,20)
460 CALL HCHAR(20,5,131,6)
470 CALL HCHAR(20,15,131,10)
480 CALL HCHAR(18,6,131,25)
490 CALL HCHAR(16,3,131,4)
500 CALL HCHAR(16,10,131,10)
510 CALL VCHAR(19,12,131,3)
520 CALL HCHAR(6,4,131,8)
530 CALL HCHAR(11,14,32)
540 CALL CHAR(144,"60E2151838181838")
550 CALL HCHAR(7,3,32)
560 CALL HCHAR(6,2,131,6)
570 CALL VCHAR(5,19,131,12)
580 CALL VCHAR(18,13,32)
590 CALL VCHAR(12,8,131,6)
600 CALL VCHAR(17,3,131,4)
610 CALL VCHAR(20,5,131,3)
620 CALL HCHAR(11,22,133)
630 CALL HCHAR(14,20,131,5)
640 CALL CHAR(150,"003C3C183C3C2424")
650 CALL HCHAR(12,22,131,6)
660 CALL HCHAR(15,8,32)
670 CALL HCHAR(14,10,131,3)
680 CALL VCHAR(14,16,131,2)
690 CALL HCHAR(20,12,32)
700 CALL HCHAR(15,19,32)
710 CALL VCHAR(12,26,131,6)
720 CALL HCHAR(16,4,129)
730 CALL HCHAR(8,15,129)
740 CALL HCHAR(16,15,129)
750 CALL HCHAR(3,14,129)
760 CALL HCHAR(11,7,129,3)
770 CALL HCHAR(19,26,133)
780 FOR I=1 TO 12
790 CALL COLOR (I,16,1)
800 NEXT I
810 CALL COLOR(13,6,1)
820 CALL COLOR(14,11,1)
830 CALL COLOR(15,10,1)
840 CALL COLOR(16,4,1)
850 CALL CHAR(129,"FFC3A59999A5C3FF")
860 CALL HCHAR(Y,X,150)
870 FOR I=1 TO 19-SPEED+(SCORE/15)
880 S=INT(RND*18)+3
890 T=INT(RND*26)+3
900 IF (S=11)*(T=16)THEN 880
910 CALL HCHAR(S,T,129-2*(RND>.8))
920 NEXT I
930 CALL HCHAR(INT(RND*22)+2,INT(RND*30)+2,133)
940 RR=R+(R>Y)-(R<Y)
950 CC=C+(C>X)-(C<X)
960 CALL GCHAR(R,CC,K)
970 IF (K=131)+(K=145)+(K=139)+(K=144)THEN 1020
980 IF K=150 THEN 1590
990 CALL HCHAR(R,C,32)
1000 CALL HCHAR(R,CC,144)
1010 C=CC
1020 CALL GCHAR(RR,C,K)
1030 IF (K=131)+(K=145)+(K=138)+(K=144)THEN 1080
1040 IF K=150 THEN 1590
1050 CALL HCHAR(R,C,32)
1060 CALL HCHAR(RR,C,144)
1070 R=RR
1080 FOR I=1 TO SPEED
1090 CALL KEY(1,K,S)
1100 IF (S=0)+(K>5)+(K=1)THEN 1300
1110 XX=X+(K=2)-(K=3)
1120 YY=Y+(K=5)-(K+1=1)
1130 CALL GCHAR(YY,XX,K)
1140 IF K<>133 THEN 1190
1150 CALL SOUND(20,440,0)
1160 CALL SOUND(40,480,0)
1170 CALL SOUND(20,440,0)
1180 SCORE=SCORE+5
1190 SCORE=SCORE-(K=131)*(SCORE>0)
1200 IF (K<>129)*(K<>131)THEN 1220
1210 CALL SOUND(-10,440,0,-7,7)
1220 IF (K=129)+(K=131)+(K=150)THEN 1300
1230 IF (K=145)+(K=144)THEN 1590
1240 I=I+9*(K=133)
1250 IF K=138 THEN 1420
1260 CALL HCHAR(Y,X,32)
1270 CALL HCHAR(YY,XX,150)
1280 Y=YY
1290 X=XX
1300 NEXT I
1310 IF OP THEN 1390
1320 CALL HCHAR(A,B,32)
1330 A=INT(RND*22)+2
1340 B=INT(RND*30)+2
1350 IF (A=11)*(B=16)THEN 1330
1360 OP=10
1370 CALL HCHAR(A,B,145)
1380 GOTO 940
1390 OP=OP-1
1400 CALL CHAR(145,X$(OP))
1410 GOTO 940
1420 SPEED=SPEED+(SPEED>1)
1430 FOR I=1 TO 15
1440 CALL SOUND(-100,110+20*I,0)
1450 NEXT I
1460 SCORE=SCORE+20
1470 IF SPE=1 THEN 1540
1480 IF SPEED<>3 THEN 1580
1490 PRINT :::::::::::::::::::::::::::::::::::::::::::::::"      BONUS LEVEL":::::::::::::::::::::::::::::::::::
1500 CALL SCREEN(6)
1510 IF SPE=1 THEN 1540
1520 SPE=1
1530 GOTO 80
1540 CALL SCREEN(2)
1550 SPEED=2
1560 SCORE=SCORE+15
1570 SPE=0
1580 GOTO 80
1590 CALL SOUND(100,440,0)
1600 CALL SOUND(20,440,30)
1610 CALL SOUND(100,340,0)
1620 CALL SOUND(20,340,30)
1630 CALL SOUND(100,340,0)
1640 CALL SOUND(20,380,30)
1650 CALL SOUND(100,380,0)
1660 CALL SOUND(20,330,30)
1670 CALL SOUND(100,330,0)
1680 CALL SOUND(80,380,30)
1690 CALL SOUND(100,380,0)
1700 CALL SOUND(20,430,30)
1710 CALL SOUND(100,410,0)
1720 GAMES=GAMES+1
1730 PRINT ::"SCORE --->";SCORE
1740 TOTS=TOTS+SCORE
1750 PRINT "HIGH SCORE ===>";HS
1760 PRINT ::"AVERAGE SCORE ==>":"FROM ";GAMES;" GAMES":"=";TOTS/GAMES:
1770 IF SCORE>HS THEN 1840
1780 INPUT "PLAY AGAIN ?":A$
1790 IF SEG$(A$,1,1)<>"Y" THEN 1830
1800 SCORE=0
1910 SPE=0
1820 GOTO 50
1830 STOP
1840 HS=SCORE
1850 GOTO 1780
