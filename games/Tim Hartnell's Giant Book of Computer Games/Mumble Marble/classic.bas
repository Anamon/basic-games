5 DIM A(87)
10 REM Mumble Marble
20 GOSUB 400
30 GOSUB 250
40 REM ACCEPT MOVE
50 PRINT "Which marble do you want to move";
60 INPUT A
70 IF A = 99 THEN GOTO 240
80 IF A < 11 OR A > 77 THEN GOTO 50
90 IF A(A) <> 79 THEN GOTO 50
100 PRINT A; "to where";
110 INPUT B
120 IF B < 11 OR B > 77 THEN GOTO 110
130 IF A(B) <> E THEN GOTO 110
140 LET A((A + B) / 2) = E: LET A(A) = E: LET A(B) = 79
150 LET MOVE = MOVE + 1
160 LET COUNT = 0
170 FOR F = 11 TO 15
180 IF A(F) = 79 THEN LET COUNT = COUNT + 1
190 NEXT F
200 GOSUB 250
210 PRINT "There are"; COUNT; "marbles on the board"
220 IF COUNT <> 1 THEN GOTO 40
230 IF A(44) = 79 THEN PRINT "You did it, in just"; MOVE; "moves!": END
240 PRINT "The game is over, and you've failed!": END
250 REM print out
260 CLS: REM Put HOME here if your computer supports it
270 PRINT "Enter side co-ordinate first"
280 PRINT TAB(5); "Enter 99 to concede"
290 PRINT "    1 2 3 4 5 6 7"
300 PRINT TAB(5);
310 FOR D = 11 TO 75
320 T = 10 * (INT(D / 10))
330 IF D - T = 8 THEN LET D = D + 2: PRINT T / 10: PRINT TAB(5);: GOTO 350
340 PRINT CHR$(A(D)); " ";
350 NEXT D: PRINT "     7"
360 PRINT: PRINT: PRINT
370 PRINT "Moves so far:"; MOVE
380 PRINT: PRINT
390 RETURN
400 REM INITIALISE
410 CLS
430 LET E = 42
440 FOR D = 11 TO 75
450 LET T = 10 * (INT(D / 10))
460 IF D - T = 8 THEN LET D = D + 3
470 READ A(D)
480 NEXT D
490 LET MOVE = 0
500 RETURN
510 REM 42 is ASC ("*")
520 REM 79 is ASC("O")
530 DATA 32,32,79,79,79,32,32
540 DATA 32,32,79,79,79,32,32
550 DATA 79,79,79,79,79,79,79
560 DATA 79,79,79,42,79,79,79
570 DATA 79,79,79,79,79,79,79
580 DATA 32,32,79,79,79,32,32
590 DATA 32,32,79,79,79

