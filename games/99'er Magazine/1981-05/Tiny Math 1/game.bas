100 REM  *************** 
110 REM  *             * 
120 REM  * TINY MATH 1 * 
130 REM  *             * 
140 REM  *************** 
150 REM  BY W.K. BALTHROP 
160 REM  99'ER VERSION 5.81.1
170 REM  initialization
180 RANDOMIZE
190 CALL CLEAR
200 CALL SCREEN(16)
210 PRINT TAB(10);"TINY MATH 1"
220 PRINT: : : : : : : : : : :
230 DIM G$(5),W(50)
240 G$(1)="183C7EFFFF7E3C18"
250 G$(2)="3C7EFFFFFFFF7E3C"
260 G$(3)="FFFFC3C3C3C3FFFF"
270 G$(4)="81667E3C3C7E6681"
280 G$(5)="FFFFFFFFFFFFFFFF"
290 DATA 523,494,440,494,523,523,523
291 DATA 494,494,494,523,523,523,523
292 DATA 494,440,494,523,523,523,523
300 DATA 494,494,523,494,440,44000
310 FOR X=1 TO 5
320 CALL CHAR(95+X,G$(X))
330 NEXT X
340 FOR ENT=1 TO 5
350 RESTORE
360 FOR ENR=1 TO 27
370 READ S
380 IF ENR=27 THEN 410
390 CALL SOUND(100,S,5)
400 CALL VCHAR(INT(RND*24)+1,INT(RND*32)+1,95+ENT)
410 NEXT ENR
420 NEXT ENT
430 REM  user inputs
440 CALL CLEAR
450 CALL SCREEN(8)
460 PRINT "DO YOU WANT TO USE SPEECH?"
470 PRINT " 1 FOR YES"
480 INPUT " 2 FOR NO":S
490 IF(S<1)+(S>2)THEN 440
500 CALL CLEAR
510 PRINT "WHAT SHAPE DO YOU WANT TO   USE?"
515 PRINT
520 IF S<>1 THEN 540
530 CALL SAY("WHAT+SHAPE+DO+YOU+WANT+TO+USE")
540 PRINT "1 FOR ";CHR$(96)
550 PRINT
560 PRINT "2 FOR ";CHR$(97)
570 PRINT
580 PRINT "3 FOR ";CHR$(98)
590 PRINT
600 PRINT "4 FOR ";CHR$(99)
610 PRINT
620 PRINT "5 FOR ";CHR$(100)
630 INPUT CA$
640 IF(ASC(CA$)<49)+(ASC(CA$)>54)THEN 630
650 CA=VAL(CA$)
660 IF CA>5 THEN 630
670 CALL CHAR(96,G$(CA))
680 CALL CLEAR
690 PRINT "ENTER THE NUMBER OF SHAPES  YOU WANT, FROM 1 TO 99."
695 PRINT
700 IF S<>1 THEN 730
710 CALL SAY("ENTER+THE+NUMBER+OF+SHAPES+YOU+WANT")
720 CALL SAY("FROM 1 TO+NINETY 9 SHAPES")
730 INPUT "MAXIMUM NUMBER OF SHAPES TO BE ON THE SCREEN ":MNOS
740 PRINT: : :
750 INPUT "MINIMUM NUMBER OF SHAPES TO BE ON THE SCREEN ":MIOS
760 IF MNOS<=MIOS THEN 680
770 IF(MNOS>99)+(MIOS<1)THEN 680
780 CALL CLEAR
785 PRINT "ALL SHAPES ARE RED."
790 PRINT "WHAT SCREEN COLOR DO YOU    WANT?"
800 IF S<>1 THEN 820
810 CALL SAY("ALL+SHAPES+ARE+RED.WHAT+SCREEN+COLOR+DO+YOU+WANT")
820 PRINT
830 PRINT "3: MEDIUM GREEN"
840 PRINT "4: LIGHT GREEN"
850 PRINT "6: LIGHT BLUE"
860 PRINT "8: CYAN"
870 PRINT "11: DARK YELLOW"
880 PRINT "12: LIGHT YELLOW"
890 PRINT "15: GRAY"
900 PRINT "16: WHITE"
910 INPUT COL
920 CALL SCREEN(COL)
930 CALL CLEAR
940 PRINT "ENTER THE TIME YOU WANT THE"
950 PRINT "SHAPES ON THE SCREEN, FROM  1 TO 7 SECONDS."
960 IF S<>1 THEN 980
970 CALL SAY("ENTER+THE+TIME+YOU+WANT+THE+SHAPES+ON+THE+SCREEN,FROM 1 TO 7 SECOND")
980 PRINT: : : :
990 INPUT T
1000 IF T>7 THEN 930
1010 CALL CLEAR
1020 PRINT "DO YOU WANT TO LEARN FIRST?":"ENTER ""Y"" FOR YES":"ENTER ""N"" FOR NO."
1030 IF S<>1 THEN 1050
1040 CALL SAY("DO+YOU+WANT+TO+LEARN+FIRST..YES OR NO")
1050 INPUT LE$
1060 IF LE$="N" THEN 1150
1070 IF LE$<>"Y" THEN 1030
1080 REM  teaching mode control loop
1090 OP=1
1100 GOSUB 1320
1110 GOSUB 2120
1120 GOSUB 2270
1130 OP=OP+1
1140 IF OP<25 THEN 1100
1150 REM  learning mode control loop
1160 LO=1
1170 GOSUB 1320
1180 GOSUB 1600
1190 GOSUB 1660
1200 LO=LO+1
1210 IF LO<51 THEN 1170
1220 REM  end of test. continue or quit
1230 CALL CLEAR
1240 PRINT "DO YOU WANT TO PLAY AGAIN?"
1250 PRINT "ENTER "Y" FOR YES.":"ENTER "N" FOR NO."
1260 IF S<>1 THEN 1280
1270 CALL SAY("DO+YOU+WANT+TO+PLAY+AGAIN")
1280 INPUT NG$
1290 IF NG$="N" THEN 3020
1300 IF NG$="Y" THEN 2900
1310 GOTO 1230
1320 NC=MIOS+INT(RND*(MNOS-MIOS))+1
1330 REM  display invisible dots on the screen
1340 RD=INT(RND*KT*2)+1
1350 IF RD>50 THEN 1340
1360 IF W(RD)=0 THEN 1380
1370 NC=W(RD)
1380 NOS=INT(MNOS/10)
1390 CALL CLEAR
1400 CALL COLOR(9,1,1)
1410 FOR LOOP=1 TO NC
1420 X=10-NOS+(INT(RND*((3+NOS)*2)+1))
1430 IF(X>23)+(X<4)THEN 1420
1440 Y=13-NOS+(INT(RND*((4+NOS)*2)+1))
1450 IF(Y>30)+(Y<3)THEN 1440
1460 CALL GCHAR(X,Y,CH)
1470 IF CH<>32 THEN 1420
1480 CALL GCHAR(X+1,Y,CH)
1490 IF CH<>32 THEN 1420
1500 CALL GCHAR(X-1,Y,CH)
1510 IF CH<>32 THEN 1420
1520 CALL GCHAR(X,Y+1,CH)
1530 IF CH<>32 THEN 1420
1540 CALL GCHAR(X,Y-1,CH)
1550 IF CH<>32 THEN 1420
1560 CALL HCHAR(X,Y,96)
1570 NEXT LOOP
1580 RETURN
1590 REM  blink dots on for a given time delay
1600 CALL COLOR(9,7,1)
1610 FOR LOOP=1 TO T
1612 CALL SOUND(1000,9999,30)
1620 NEXT LOOP
1622 CALL SOUND(1,9999,30)
1630 CALL COLOR(9,1,1)
1640 RETURN
1650 REM  ask for user's guess on how many dots
1660 CALL CLEAR
1670 PRINT "WHAT IS THE NUMBER OF SHAPESPLEASE?"
1680 IF S<>1 THEN 1700
1690 CALL SAY("WHAT+IS+THE+NUMBER+OF+SHAPES PLEASE")
1700 INPUT N$
1710 IF N$="Q" THEN 1230
1720 IF N$>STR$(MNOS)THEN 1680
1730 IF N$<STR$(MIOS)THEN 1680
1740 G=VAL(N$)
1750 IF G<>NC THEN 1920
1760 REM  right answer
1770 CALL CLEAR
1780 PRINT "GOOD, THAT IS RIGHT."
1790 IF S<>1 THEN 1810
1800 CALL SAY("GOOD #THAT IS RIGHT# ")
1810 CALL SOUND(300,440,2,784,2,988,2)
1820 CALL SOUND(400,554,2,659,2,880,2)
1830 FOR TD=1 TO 1000
1840 NEXT TD
1850 FOR ER=1 TO 50
1860 IF W(ER)<>NC THEN 1880
1870 W(ER)=0
1880 NEXT ER
1890 RIGHT=RIGHT+1
1900 RETURN
1910 REM  wrong answer
1920 PRINT "UHOH, THAT IS INCORRECT."
1930 PRINT "THE RIGHT ANSWER IS";NC
1940 IF S<>1 THEN 1980
1950 GOSUB 2270
1960 CALL SAY("UHOH #THAT IS INCORRECT#")
1970 CALL SAY("THE+RIGHT+ANSWER+IS","",NUM$,"",TE$,"")
1980 CALL SOUND(300,440,2,330,2,165,2)
1990 CALL SOUND(400,330,2,220,2,110,2)
2000 CALL COLOR(9,2,1)
2010 FOR V=1 TO 100
2020 NEXT V
2030 W(KT)=NC
2040 KT=KT+1
2050 PRINT "WE WILL TRY AGAIN."
2060 IF S<>1 THEN 2080
2070 CALL SAY("WE+WILL+#TRY AGAIN# ")
2080 FOR TD=1 TO 500
2090 NEXT TD
2100 RETURN
2110 REM  turn on dots permanently. display number of dots
2120 CALL COLOR(9,7,1)
2130 PRINT TAB(10);"*PRESS ANY KEY*"
2140 IF NC<10 THEN 2170
2150 CALL VCHAR(2,5,ASC(STR$(INT(NC/10))))
2160 GOTO 2180
2170 CALL VCHAR(2,5,32)
2180 CALL VCHAR(2,6,ASC(STR$(NC-(INT(NC/10)*10))))
2190 IF S<>1 THEN 2240
2200 NUM$=""
2210 TE$=""
2220 GOSUB 2270
2230 CALL SAY("THERE+ARE","",NUM$,"",TE$,"","SHAPES+ON+THE+SCREEN")
2240 CALL KEY(0,K,STAT)
2250 IF STAT=0 THEN 2240
2260 RETURN
2270 FC=INT(NC/10)
2280 SC=NC-(INT(NC/10)*10)
2290 IF FC=0 THEN 2320
2300 ON FC GOSUB 2540,2710,2730,2750,2770,2790,2810,2830,2850
2310 GOTO 2330
2320 FC$=""
2330 IF SC=0 THEN 2360
2340 GOSUB 2870
2350 GOTO 2370
2360 SC$=""
2370 IF NC>20 THEN 2480
2380 IF NC>9 THEN 2410
2390 NUM$=SC$
2400 RETURN
2410 IF SC>5 THEN 2450
2420 NUM$=FC$
2430 TE$=""
2440 RETURN
2450 NUM$=SC$
2460 TE$=FC$
2470 RETURN
2480 NUM$=FC$
2490 IF SC>0 THEN 2520
2500 TE$=""
2510 RETURN
2520 TE$=SC$
2530 RETURN
2540 IF SC>0 THEN 2570
2550 FC$="TEN"
2560 RETURN
2570 ON SC GOSUB 2590,2610,2630,2650,2670,2690,2690,2690,2690
2580 RETURN
2590 FC$="ELEVEN"
2600 RETURN
2610 FC$="TWELVE"
2620 RETURN
2630 FC$="THIRTEEN"
2640 RETURN
2650 FC$="FOURTEEN"
2660 RETURN
2670 FC$="FIFTEEN"
2680 RETURN
2690 FC$="TEEN"
2700 RETURN
2710 FC$="TWENTY"
2720 RETURN
2730 FC$="THIRTY"
2740 RETURN
2750 FC$="FORTY"
2760 RETURN
2770 FC$="FIFTY"
2780 RETURN
2790 FC$="SIXTY"
2800 RETURN
2810 FC$="SEVENTY"
2820 RETURN
2830 FC$="EIGHTY"
2840 RETURN
2850 FC$="NINETY"
2860 RETURN
2870 SC$=STR$(SC)
2880 RETURN
2890 REM  set up variables for next test
2900 FOR X=1 TO 50
2910 W(X)=0
2920 NEXT X
2930 X=0
2940 Y=0
2950 NC=0
2960 NOS=0
2970 S=0
2980 OP=0
2990 LO=0
2995 CALL COLOR(9,2,1)
2996 CALL CHAR(96,G$(1))
3000 GOTO 440
3010 REM  end of test message
3020 PRINT "YOUR SCORE WAS";RIGHT
3030 PRINT "OUT OF A POSSIBLE 50."
3040 END
