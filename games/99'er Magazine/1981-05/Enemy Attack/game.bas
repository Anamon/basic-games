80 REM  **************** 
90 REM  * ENEMY ATTACK * 
100 REM  **************** 
110 REM  BY CHARLES EHNINGER 
120 REM  99'ER VERSION 5.81.1     
130 OPTION BASE 1
140 DIM C(6,8),D(3,4),P(3),R(4),S(4)
150 CALL CLEAR
160 CALL SCREEN(2)
170 FOR I=1 TO 3
180 READ P(I)
190 NEXT I
200 FOR I=1 TO 4
210 READ R(I),S(I)
220 NEXT I
230 DATA 8,11,7
240 DATA 1,16,5,16,16,5,16,1
250 CALL CHAR(96,"303039FF30303000")
260 CALL CHAR(97,"12343EFC7F2F4A90")
270 CALL CHAR(136,"08")
280 CALL CHAR(128,"08")
290 CALL CHAR(104,"0C0C9CFF9C0C0C")
300 CALL CHAR(105,"12343EFC7F2F4A90")
310 CALL CHAR(112,"1818")
320 CALL CHAR(113,"12343EFC7F2F4A90")
330 CALL CHAR(120,"00000EFC0E")
340 CALL CHAR(121,"12343EFC7F2F4A90")
350 CALL CHAR(122,"0000703F70")
360 CALL COLOR(9,16,1)
370 CALL COLOR(10,2,1)
380 CALL COLOR(11,12,1)
390 CALL COLOR(12,7,1)
400 REM  ********* 
410 REM  * TITLE * 
420 REM  ********* 
430 DISPLAY TAB(10);"ENEMY ATTACK!": : : : : : : : : : : :
440 CALL HCHAR(6,7,104,21)
450 CALL VCHAR(7,27,120,13)
460 CALL HCHAR(20,7,96,21)
470 CALL VCHAR(7,7,122,13)
480 CALL SCREEN(8)
490 FOR F=6 TO 20 STEP 14
500 FOR G=8 TO 26 STEP 8
510 GOSUB 2210
520 NEXT G
530 FOR I=1 TO 500
540 NEXT I
550 GOSUB 580
560 NEXT F
570 GOTO 2300
580 CALL SOUND(300,440,0,-4,0)
590 CALL SOUND(150,523,0,-4,0)
600 CALL SOUND(450,523,0,-4,0)
610 CALL SOUND(150,466,0,-4,0)
620 CALL SOUND(150,440,0,-4,0)
630 CALL SOUND(150,392,0,-4,0)
640 CALL SOUND(450,440,0,-4,0)
650 CALL SOUND(450,466,0,-4,0)
660 CALL SOUND(450,494,0,-4,0)
670 CALL SOUND(450,523,0,-4,0)
680 RETURN
690 GOTO 2300
700 REM  ********* 
710 REM  * STARS * 
720 REM  ********* 
730 F=INT(4*RND)+1
740 CALL COLOR(13,R(F),1)
750 CALL COLOR(14,S(F),1)
760 RETURN
770 REM  ********** 
780 REM  * DEFEND * 
790 REM  ********** 
800 CALL KEY(0,V,W)
810 IF W=0 THEN 1040
820 IF V<>13 THEN 930
830 CALL SOUND(-400,440,0,880,0,-4,0)
840 FOR I=1 TO 3
850 IF D(I,3)<>0 THEN 910
860 D(I,1)=A
870 D(I,2)=31
880 D(I,3)=1
890 D(I,4)=96
900 GOTO 1040
910 NEXT I
920 GOTO 1040
930 CALL SOUND(-400,110,0,139,0,-8,0)
940 IF V<>69 THEN 970
950 E=-1
960 GOTO 1040
970 IF V<>88 THEN 1000
980 E=1
990 GOTO 1040
1000 E=0
1010 REM  ************ 
1020 REM  * DEF FIRE * 
1030 REM  ************ 
1040 GOSUB 730
1050 FOR I=1 TO 3
1060 IF D(I,3)=0 THEN 1320
1070 CALL HCHAR(D(I,1),D(I,2),D(I,4))
1080 IF D(I,2)=1 THEN 1270
1090 D(I,2)=D(I,2)-1
1100 CALL GCHAR(D(I,1),D(I,2),D(I,4))
1110 IF(D(I,4)=32)+(D(I,4)=112)+(D(I,4)>127)<>0 THEN 1300
1120 IF D(I,4)=120 THEN 1270
1130 F=D(I,1)
1140 G=D(I,2)
1150 GOSUB 2210
1160 FOR H=1 TO 6
1170 IF C(H,1)<>D(I,1)THEN 1260
1180 IF D(I,4)<>122 THEN 1220
1190 C(H,5)=0
1200 C(H,6)=0
1210 GOTO 1270
1220 C(H,2)=0
1230 C(H,4)=0
1240 EN=EN-1
1250 GOTO 1270
1260 NEXT H
1270 D(I,2)=0
1280 D(I,3)=0
1290 GOTO 1320
1300 CALL HCHAR(D(I,1),D(I,2),120)
1310 CALL SOUND(-100,110,8,-6,4)
1320 NEXT I
1330 REM  ************ 
1340 REM  * DEF MOVE * 
1350 REM  ************ 
1360 IF E=0 THEN 1540
1370 CALL HCHAR(A,31,L)
1380 A=A+E
1390 IF A THEN 1420
1400 A=1
1410 E=0
1420 IF A<25 THEN 1450
1430 A=24
1440 E=0
1450 CALL GCHAR(A,31,L)
1460 IF(L=32)+(L=112)+(L>127)<>0 THEN 1520
1470 F=A
1480 G=31
1490 GOSUB 2210
1500 B=1
1510 GOTO 1540
1520 CALL HCHAR(A,31,96)
1530 CALL SOUND(50,440,8,-4,0)
1540 RETURN
1550 REM  ********* 
1560 REM  * ENEMY * 
1570 REM  ********* 
1580 GOSUB 730
1590 FOR I=1 TO 6
1600 FR=0
1610 IF C(I,5)<>0 THEN 1700
1620 IF C(I,4)=0 THEN 2160
1630 IF C(I,2)>30 THEN 1900
1640 J=INT(GM*EN*RND)
1650 IF J THEN 1900
1660 C(I,5)=1
1670 C(I,6)=C(I,2)
1680 C(I,8)=C(I,3)
1690 FR=1
1700 CALL HCHAR(C(I,1),C(I,6),C(I,8))
1710 C(I,6)=C(I,6)+1
1720 IF C(I,6)=32 THEN 1850
1730 CALL GCHAR(C(I,1),C(I,6),C(I,8))
1740 IF(C(I,8)=32)+(C(I,8)=112)+(C(1,8)>127)<>0 THEN 1880
1750 F=C(I,1)
1760 G=C(I,6)
1770 GOSUB 2210
1780 IF C(I,8)=96 THEN 2020
1790 FOR H=1 TO 3
1800 IF D(H,2)<>C(I,6)THEN 1840
1810 D(H,2)=0
1820 D(H,3)=0
1830 GOTO 1850
1840 NEXT H
1850 C(I,5)=0
1860 C(I,6)=0
1870 GOTO 1910
1880 CALL HCHAR(C(I,1),C(I,6),122)
1890 CALL SOUND(-200,165,16,-5,12)
1900 IF FR THEN 2160
1910 J=INT(GM*EN*RND)
1920 IF J THEN 2160
1930 CALL HCHAR(C(I,1),C(I,2),C(I,7))
1940 C(I,2)=C(I,2)+1
1950 IF C(I,2)>32 THEN 2020
1960 CALL GCHAR(C(I,1),C(I,2),C(I,7))
1970 IF(C(I,7)=32)+(C(I,7)=112)+(C(I,7)>127)<>0 THEN 2140
1980 F=C(I,1)
1990 G=C(I,2)
2000 GOSUB 2210
2010 IF C(I,7)<>96 THEN 2040
2020 B=1
2030 GOTO 2170
2040 FOR H=1 TO 3
2050 IF D(H,2)<>C(I,2)THEN 2090
2060 D(H,2)=0
2070 D(H,3)=0
2080 GOTO 2100
2090 NEXT H
2100 C(I,2)=0
2110 C(I,4)=0
2120 EN=EN-1
2130 GOTO 2160
2140 CALL HCHAR(C(I,1),C(I,2),C(I,3))
2150 CALL SOUND(-100,659,0,-8,0)
2160 NEXT I
2170 RETURN
2180 REM  ******** 
2190 REM  * BANG * 
2200 REM  ******** 
2210 FOR H=121 TO 97 STEP-8
2220 CALL HCHAR(F,G,H)
2230 CALL SOUND(-1000,110,0,165,0,-7,0)
2240 NEXT H
2250 CALL HCHAR(F,G,32)
2260 RETURN
2270 REM  ********* 
2280 REM  * START * 
2290 REM  ********* 
2300 CALL CLEAR
2310 CALL SCREEN(2)
2320 GM=3
2330 GOSUB 730
2340 B=0
2350 A=12
2360 L=32
2370 FOR I=1 TO 3
2380 D(I,3)=0
2390 D(I,4)=32
2400 NEXT I
2410 RANDOMIZE
2420 FOR I=1 TO 60
2430 F=INT(24*RND)+1
2440 G=INT(32*RND)+1
2450 CALL SOUND(-50,880,8)
2460 IF I>15 THEN 2490
2470 CALL HCHAR(F,G,112)
2480 GOTO 2530
2490 IF INT((F+G)/2)=(F+G)/2 THEN 2520
2500 CALL HCHAR(F,G,128)
2510 GOTO 2530
2520 CALL HCHAR(F,G,136)
2530 NEXT I
2540 CALL HCHAR(A,31,96)
2550 CALL COLOR(10,P(GM),1)
2560 FOR I=1 TO 6
2570 J=INT(24*RND)+1
2580 FOR H=1 TO I-1
2590 IF J=C(H,1)THEN 2570
2600 NEXT H
2610 C(I,1)=J
2620 C(I,2)=1
2630 C(I,3)=104
2640 C(I,4)=1
2650 C(I,5)=0
2660 C(I,6)=1
2670 C(I,7)=32
2680 C(I,8)=104
2690 CALL HCHAR(C(I,1),C(I,2),C(I,3))
2700 CALL SOUND(50,1319,0)
2710 NEXT I
2720 EN=6
2730 GOSUB 800
2740 GOSUB 1580
2750 IF B=1 THEN 2820
2760 IF EN THEN 2730
2770 GM=GM-1
2780 IF GM THEN 2550
2790 CALL CLEAR
2800 DISPLAY TAB(10);"OUR HERO!": : :"YOU HAVE SAVED YOUR COUNTRY": : : : : : : : : : : :
2810 GOTO 2840
2820 CALL CLEAR
2830 DISPLAY TAB(5);"SEE WHAT YOU'VE DONE?": : :"YOU LET THE ENEMY DESTROY":"YOUR COUNTRY!": : : : : : : : : : : :
2840 DISPLAY "WANT TO TRY AGAIN";
2850 CALL SCREEN(8)
2860 INPUT K$
2870 IF SEG$(K$,1,1)="Y" THEN 2300
2880 CALL CLEAR
2890 END
