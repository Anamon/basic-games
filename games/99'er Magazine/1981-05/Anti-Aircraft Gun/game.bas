100 REM  *********************
110 REM  *                   *
120 REM  * ANTI-AIRCRAFT GUN *
130 REM  *                   *
140 REM  *********************
150 REM  BY MARK MOSELEY
160 REM  99'ER VERSION 5.81.1
170 CALL CLEAR
180 CALL SCREEN(8)
190 REM  introduction
200 PRINT TAB(3);"PRESS I FOR INSTRUCTIONS"
210 PRINT TAB(8);"AND N FOR NONE": : : : : : : : : :
220 CALL KEY(0,LP,PL)
230 IF PL=0 THEN 220
240 IF LP=78 THEN 680
250 PRINT TAB(5);"* ANTI-AIRCRAFT GUN *"
260 PRINT
270 PRINT "THE OBJECT OF ANTI-AIRCRAFT"
280 PRINT "IS TO DESTROY AS MANY PLANES"
290 PRINT "AS POSSIBLE. TO FIRE YOUR"
300 PRINT "MISSILE, PRESS Q. TO MOVE"
310 PRINT "LEFT, PRESS S, AND FOR RIGHT"
320 PRINT "PRESS D."
330 PRINT
340 PRINT TAB(9);"* PLANES: *"
350 PRINT
360 PRINT "THE PLANE FIRES A NEWLY-"
370 PRINT "DEVELOPED LASER. THE PLANE"
380 PRINT "MAY COME FROM LEFT OR RIGHT."
390 PRINT "WARNNG! IT HAS A RADAR THAT"
400 PRINT "REMEMBERS YOUR LAST FIRING"
410 PRINT "POSITION AND TRIES TO GET"
420 PRINT "YOU THERE, SO BETTER MOVE"
425 PRINT "AROUND."
430 PRINT: :
440 PRINT "PRESS ANYTHING TO CONTINUE"
450 PRINT
460 CALL KEY(0,KL,LK)
470 IF LK=0 THEN 460
480 PRINT TAB(8):"* BARRIER: *"
490 PRINT
500 PRINT "THE LASER CAN'T PENETRATE"
510 PRINT "THE BARRIER. BUT THE BARRIER"
520 PRINT "CAN SUSTAIN ONLY 5 DIRECT"
530 PRINT "HITS. YOU CAN FIRE WHEN BE-"
540 PRINT "HIND IT. BUT THIS WILL ONLY"
550 PRINT "SHORTEN ITS LIFE."
560 PRINT
570 PRINT TAB(8):"* SCORING: *"
580 PRINT
590 PRINT "PLANES ARE SCORED ACCORDING"
600 PRINT "TO HEIGHT: 5 FOR LOWEST, 20"
610 PRINT "FOR HIGHEST. IF YOUR SCORE"
620 PRINT "IS OVER 100 THEN YOU GET A"
630 PRINT "FREE BONUS GAME."
640 PRINT: : : : :
650 PRINT "PRESS ANYTHING TO CONTINUE"
660 CALL KEY(0,KL,LK)
670 IF LK=0 THEN 660
680 CALL CLEAR
690 CALL COLOR(2,2,8)
700 PRINT "INPUT LEVEL OF DIFFICULTY:"
710 PRINT
720 PRINT "(1) PRO"
730 PRINT
740 PRINT "(2) INTERMEDIATE"
750 PRINT
760 PRINT "(3) NOVICE"
770 PRINT
780 PRINT "(4) BEGINNER"
790 PRINT: : : : : :
800 CALL KEY(0,DIF,XS)
810 IF XS=0 THEN 800
820 REM  PLANE FIRING MORE AS DIFFICULTY INCREASES
830 DIFF=DIF-38
840 M$="0"
850 AA=1
860 ZZ=3
870 CALL CLEAR
880 REM  DEFINE CHARACTERS
890 REM  BA$=BARRIER, L$=LASER, R$=ROCKET, P$ & PR$=PLANE, TL$ &TR$=TANK, D$=DESTRUCTION
900 BA$="FFFFFFFF"
910 D$="2A04412289045220"
920 L$="1818181818181818"
930 R$="1818181818183C7E"
940 P$="603098FFFF983060"
950 PR$="060C19FFFF190C06"
960 TL$="071F7FFFFF7F3F0F"
970 TR$="E0F8FEFFFFFEFCE0"
980 CALL CHAR(120,D$)
990 CALL CHAR(144,L$)
1000 CALL CHAR(97,R$)
1010 CALL CHAR(112,TL$)
1020 CALL CHAR(113,TR$)
1030 CALL CHAR(101,BA$)
1040 CALL CLEAR
1050 BA=0
1060 CALL COLOR(2,16,2)
1070 CALL COLOR(16,2,2)
1080 CALL COLOR(15,12,8)
1090 CALL COLOR(13,3,3)
1100 CALL COLOR(12,7,8)
1110 T=15
1120 REM  INITIAL PRINTING OF TANK
1130 CALL HCHAR(24,T,112)
1140 CALL HCHAR(24,T+1,42)
1150 CALL HCHAR(24,T+2,113)
1160 CALL HCHAR(23,T+1,152)
1170 CALL HCHAR(22,15,101,3)
1180 REM  PRINT GROUND GREEN
1190 CALL HCHAR(23,1,128,15)
1200 CALL HCHAR(23,17,128,15)
1210 CALL HCHAR(24,1,128,14)
1220 CALL HCHAR(24,18,128,14)
1230 REM  A=HEIGHT OF PLANE
1240 RANDOMIZE
1250 A=2*INT(9*RND)+1
1260 IF A=1 THEN 1240
1270 REM  determine plane's direction  
1280 RANDOMIZE
1290 B=INT(2*RND)+1
1300 ON B GOTO 1310,1350
1310 B=30
1320 CALL CHAR(96,PR$)
1330 DIR=-2
1340 GOTO 1380
1350 DIR=2
1360 CALL CHAR(96,P$)
1370 B=2
1380 Y=21
1390 REM  begin loop      
1400 CALL KEY(0,K,S)
1410 REM  81 fires rocket, 83 and 68 move tank 
1420 IF K=81 THEN 1450
1430 IF K=83 THEN 2640
1440 IF K=68 THEN 2770 ELSE 1550
1450 IF Y=21 THEN 1480 ELSE 1470
1460 REM  fire rocket 
1470 CALL VCHAR(Y+2,T+1,32)
1480 CALL VCHAR(Y,T+1,97)
1490 TT=T+1
1500 Y=Y-2
1510 IF Y=-1 THEN 1520 ELSE 1550
1520 CALL VCHAR(1,T+1,32)
1530 GOTO 1380
1540 REM  move plane 
1550 IF DIR=-2 THEN 1570
1560 IF B<3 THEN 1590
1570 CALL VCHAR(A,B-DIR,32)
1580 IF B<2 THEN 1900
1590 CALL VCHAR(A,B,96)
1600 RANDOMIZE
1610 Q=INT(15*RND)+1
1620 REM  will plane fire laser?  
1630 TT=TT-2+INT(Q/2)
1640 IF B=TT THEN 1670
1650 IF Q>DIFF THEN 1670 ELSE 1820
1660 REM  plane will fire laser   
1670 IF BA=5 THEN 1760 ELSE 1680
1680 IF B=16 THEN 1690 ELSE 1760
1690 BA=BA+1
1700 IF BA<>5 THEN 1720
1710 CALL HCHAR(22,15,32,3)
1720 CALL VCHAR(A+1,B,144,21-A)
1730 CALL VCHAR(A+1,B,32,21-A)
1740 CALL SOUND(500,-5,2)
1750 GOTO 1850
1760 CALL VCHAR(A+1,B,144,23-A)
1770 IF B<>T+1 THEN 1790
1780 IF A<>Y+2 THEN 2440
1790 CALL VCHAR(A+1,B,32,22-A)
1800 CALL VCHAR(23,B,128,2)
1810 CALL SOUND(500,-5,2)
1820 IF B>30 THEN 1840 ELSE 1830
1830 IF B<3 THEN 1840 ELSE 1850
1840 CALL VCHAR(A,B,32)
1850 IF A<>Y+2 THEN 1870
1860 IF B=T+1 THEN 2050
1870 B=B+DIR
1880 IF B>32 THEN 1900 ELSE 1890
1890 IF K=81 THEN 1420 ELSE 1400
1900 RANDOMIZE
1910 B=INT(2*RND)+1
1920 REM  determine plane's direction 
1930 ON B GOTO 1940,1980
1940 B=30
1950 CALL CHAR(96,PR$)
1960 DIR=-2
1970 GOTO 2000
1980 DIR=2
1990 CALL CHAR(96,P$)
2000 RANDOMIZE
2010 A=2*INT(9*RND)+1
2020 IF A=1 THEN 2000
2030 GOTO 1890
2040 REM  tank hits plane 
2050 CALL SOUND(1000,-5,2)
2060 REM  a tie - tank wins - reprint tank 
2070 CALL HCHAR(24,T+1,42)
2080 CALL HCHAR(23,T+1,152)
2090 CALL HCHAR(A,B,120)
2100 REM  determine plane's direction 
2110 B=INT(2*RND)+1
2120 ON B GOTO 2130,2170
2130 B=30
2140 DIR=-2
2150 CALL CHAR(96,PR$)
2160 GOTO 2200
2170 DIR=2
2180 CALL CHAR(96,P$)
2190 REM  scoring 
2200 IF A>13 THEN 2210 ELSE 2230
2210 SC=SC+5
2220 GOTO 2300
2230 IF A>7 THEN 2240 ELSE 2260
2240 SC=SC+10
2250 GOTO 2300
2260 IF A<>5 THEN 2290
2270 SC=SC+15
2280 GOTO 2300
2290 SC=SC+20
2300 M$=STR$(SC)
2310 RANDOMIZE
2320 A=2*INT(9*RND)+1
2330 IF A=1 THEN 2310
2340 REM  print score 
2350 FOR I=1 TO LEN(M$)
2360 CV=ASC(SEG$(M$,I,1))
2370 CALL HCHAR(AA,ZZ+I,CV)
2380 NEXT I
2390 GOTO 1380
2400 FOR I=1 TO 1000
2410 NEXT I
2420 GOTO 1040
2430 REM  plane hit tank 
2440 CALL SOUND(500,-6,2)
2450 CALL CLEAR
2460 SX=SX+1
2470 REM  if 2 games played, start over 
2480 IF SX<2 THEN 1040
2490 PRINT TAB(7):"   GAME OVER"
2500 PRINT TAB(7):"YOUR SCORE IS";SC
2510 FOR I=1 TO 10
2520 PRINT
2530 NEXT I
2540 SX=0
2550 IF SC<100 THEN 2600
2560 PRINT TAB(3):"* YOU GET A FREE GAME *"
2570 REM  free game 
2580 SC=0
2590 GOTO 2400
2600 SC=0
2610 REM  go back to start 
2620 GOTO 680
2630 REM  move tank left 
2640 IF T<3 THEN 2650 ELSE 2680
2650 CALL SOUND(250,110,2)
2660 T=1
2670 GOTO 2690
2680 T=T-2
2690 CALL HCHAR(24,T,112)
2700 CALL HCHAR(24,T+1,42)
2710 CALL HCHAR(24,T+2,113)
2720 CALL HCHAR(23,T+1,152)
2730 CALL HCHAR(24,T+3,128,2)
2740 CALL HCHAR(23,T+3,128)
2750 GOTO 1550
2760 REM  move tank right 
2770 IF T>27 THEN 2780 ELSE 2810
2780 CALL SOUND(250,110,2)
2790 T=29
2800 GOTO 2820
2810 T=T+2
2820 CALL HCHAR(24,T,112)
2830 CALL HCHAR(24,T+1,42)
2840 CALL HCHAR(24,T+2,113)
2850 CALL HCHAR(23,T+1,152)
2860 CALL HCHAR(24,T-2,128,2)
2870 CALL HCHAR(23,T-1,128)
2880 GOTO 1550
2890 GOTO 1040
2900 END
