10 REM  
11 RANDOMIZE
12 CALL SCREEN(12)
13 CALL CLEAR
14 PRINT TAB(9);"BATTLE AT SEA"
15 PRINT TAB(14);"BY"
16 PRINT TAB(9);"W.K. BALTHROP"
17 PRINT: : : : : : : : : : :
18 OPTION BASE 1
19 DIM P(10,10),O(10,10),SH(5,5,2)
20 CALL COLOR(14,7,1)
21 CALL COLOR(15,11,1)
22 CALL CHAR(96,"000000FF7F3F1F")
23 CALL CHAR(97,"000000FFFFFFFF")
24 CALL CHAR(98,"3C7EFFFFFFFFFF")
25 CALL CHAR(99,"000000FFFEFCF8")
26 CALL CHAR(100,"103070707070707")
27 CALL CHAR(101,"707070707070707")
28 CALL CHAR(102,"787C7E7E7F7F7C78")
29 CALL CHAR(103,"707070707070101")
30 CALL CHAR(104,"00080403FF7F3F")
31 CALL CHAR(105,"8C4C3CFEFFFFFF")
32 CALL CHAR(106,"01023C3FFFFFFF")
33 CALL CHAR(107,"000204F8FFFEFE")
34 CALL CHAR(108,"1030727478787878")
35 CALL CHAR(109,"7C7C70717A7C7C7C")
36 CALL CHAR(110,"7F7F787C7C7C7A79")
37 CALL CHAR(111,"7078787C7C72711")
38 CALL CHAR(112,"00108867FF7F3F")
39 CALL CHAR(113,"09C5C3F3FFFFFF")
40 CALL CHAR(114,"000204F8FFFEFE")
41 CALL CHAR(115,"1030727478797A7C")
42 CALL CHAR(116,"797A7C7C7F7F787C")
43 CALL CHAR(117,"7C7C7A79787C7C1A")
44 CALL CHAR(118,"0000003FFF7F3F")
45 CALL CHAR(119,"067EFEFFFFFFFF")
46 CALL CHAR(120,"000000E0FCFFFE")
47 CALL CHAR(121,"1030787878787878")
48 CALL CHAR(122,"787C7C7E7E7E7F7F")
49 CALL CHAR(123,"7C7C78787870302")
50 CALL CHAR(124,"03030F1FFF7F3F")
51 CALL CHAR(125,"006060F0FFFEFE")
52 CALL CHAR(126,"1030707078787E7F")
53 CALL CHAR(127,"7C7878707070701")
54 CALL CHAR(128,"FF818181818181FF")
55 CALL CHAR(136,"815E2C366A3C2442")
56 CALL CHAR(144,"81667E3C3C7E6681")
57 CALL SOUND(-3000,220,30,554,20,1047,20,-8,30)
58 PRINT "       BATTLE AT SEA"
59 PRINT:"YOU MUST DESTROY THE ENEMY"
60 PRINT "SHIPS BEFORE THE COMPUTER"
61 PRINT "DESTROYS YOUR SHIPS."
62 PRINT:"TO SET UP YOUR SHIPS YOU"
63 PRINT "MUST ENTER COORDINATES ON"
64 PRINT "THE 10 X 10 GRID ON THE     RIGHT."
65 PRINT "ENTER THE ROW, THEN THE     COLUMN."
66 PRINT "EXAMPLE: A5"
67 PRINT "AFTER YOUR SHIPS ARE SET UP"
68 PRINT "YOU WILL TAKE A SHOT AT THE"
69 PRINT "ENEMY SHIPS BY ENTERING ONE"
70 PRINT "PAIR OF COORDINATES ON THE"
71 PRINT "ENEMY GRID."
72 PRINT "THE COMPUTER WILL THEN"
73 PRINT "TAKE A SHOT AT YOUR SHIPS.": :
74 PRINT "THE COMPUTER CANNOT SEE"
75 PRINT "YOUR SHIPS. YOU CANNOT SEE"
76 PRINT "THE COMPUTER'S SHIPS."
77 PRINT "ENTER ANY KEY TO BEGIN."
78 CALL SOUND(1,-2,30)
79 CALL KEY(0,K,S)
80 IF S=0 THEN 79
81 CALL SCREEN(6)
82 CALL CLEAR
83 PRINT "    COMPUTER      YOU"
84 PRINT: : : : : : : : : : : : : : : : : : : : :
85 FOR X=5 TO 14
86 CALL VCHAR(X,5,X+60)
87 CALL HCHAR(X,6,128,10)
88 CALL HCHAR(X,18,128,10)
89 CALL VCHAR(X,17,X+60)
90 NEXT X
91 FOR X=6 TO 15
92 CALL VCHAR(15,X+12,X+42)
93 CALL VCHAR(15,X,X+42)
94 NEXT X
95 S1$="CARRIER"
96 S2$="BATTLESHIP"
97 S3$="CRUISER"
98 S4$="SUBMARINE"
99 S5$="DESTROYER"
100 FOR S=1 TO 5
101 ON S GOSUB 104,109,114,119,124
102 GOSUB 132
103 GOTO 129
104 PR$=S1$
105 LE=5
106 S=1
107 OS=0
108 RETURN
109 PR$=S2$
110 LE=4
111 S=2
112 OS=8
113 RETURN
114 PR$=S3$
115 LE=3
116 S=3
117 OS=16
118 RETURN
119 PR$=S4$
120 LE=3
121 S=4
122 OS=22
123 RETURN
124 PR$=S5$
125 LE=2
126 S=5
127 OS=28
128 RETURN
129 NEXT S
130 CALL HCHAR(22,1,32,64)
131 GOTO 217
132 L=LEN(PR$)
133 SUS$="ENTER ROW,COL. FOR "&STR$(LE)&" SPACES"
134 FOR X=1 TO LEN(SUS$)
135 SU1$=SEG$(SUS$,X,1)
136 CALL VCHAR(22,X+2,ASC(SU1$))
137 NEXT X
138 PR$=PR$&" SPACE"
139 CALL HCHAR(23,2,32,30)
140 FOR X=1 TO LEN(PR$)
141 SU1$=SEG$(PR$,X,1)
142 CALL VCHAR(23,X+2,ASC(SU1$))
143 NEXT X
144 FOR X=1 TO LE
145 CALL HCHAR(23,20,35)
146 CALL VCHAR(23,21,LE-X+49)
147 CALL KEY(0,K1,ST)
148 IF ST=0 THEN 147
149 IF K1<65 THEN 152
150 IF K1>74 THEN 152
151 GOTO 154
152 CALL SOUND(100,-2,2)
153 GOTO 147
154 CALL VCHAR(23,23,K1)
155 CALL KEY(0,KE,ST)
156 IF ST=-1 THEN 155
157 CALL KEY(0,K2,ST)
158 IF ST=0 THEN 157
159 IF K2<48 THEN 162
160 IF K2>57 THEN 162
161 GOTO 164
162 CALL SOUND(100,-2,2)
163 GOTO 157
164 CALL VCHAR(23,24,K2)
165 SH(S,X,1)=K1-64
166 SH(S,X,2)=K2-47
167 IF P(K1-64,K2-47)>0 THEN 152
168 P(K1-64,K2-47)=S
169 NEXT X
170 GOSUB 529
171 IF SH(S,1,1)=SH(S,2,1)THEN 174
172 X2=1
173 GOTO 175
174 X2=2
175 FOR X3=1 TO LE
176 F=0
177 FOR X1=1 TO LE-X3
178 IF SH(S,X1,X2)=0 THEN 184
179 IF SH(S,X1,X2)<SH(S,X1+1,X2)THEN 184
180 SW=SH(S,X1,X2)
181 SH(S,X1,X2)=SH(S,X1+1,X2)
182 SH(S,X1+1,X2)=SW
183 F=1
184 NEXT X1
185 IF F=0 THEN 187
186 NEXT X3
187 FOR X=1 TO LE-1
188 IF SH(S,X,1)<>SH(S,X+1,1)-1 THEN 191
189 NEXT X
190 GOTO 200
191 FOR X=1 TO LE-1
192 IF SH(S,X,2)<>SH(S,X+1,2)-1 THEN 195
193 NEXT X
194 GOTO 200
195 CALL SOUND(100,-2,2)
196 FOR X=1 TO LE
197 P(SH(S,X,1),SH(S,X,2))=0
198 NEXT X
199 GOTO 139
200 X=S
201 FOR X1=1 TO 5
202 IF SH(X,X1,1)=0 THEN 212
203 IF SH(X,1,1)=SH(X,2,1)THEN 206
204 OSA=1
205 GOTO 207
206 OSA=0
207 P(SH(X,X1,1),SH(X,X1,2))=X
208 IF X>1 THEN 211
209 CALL VCHAR(SH(X,X1,1)+4,SH(X,X1,2)+17,95+X1+OS+((LE-1)*OSA))
210 GOTO 212
211 CALL HCHAR(SH(X,X1,1)+4,SH(X,X1,2)+17,95+X1+OS+(LE*OSA))
212 NEXT X1
213 IF X>1 THEN 216
214 CALL HCHAR(SH(1,4,1)+4,SH(1,4,2)+17,97+((LE-1)*OSA))
215 CALL HCHAR(SH(1,5,1)+4,SH(1,5,2)+17,99+((LE-1)*OSA))
216 RETURN
217 LE=4
218 S=1
219 GOSUB 233
220 LE=3
221 S=2
222 GOSUB 233
223 LE=2
224 S=3
225 GOSUB 233
226 LE=2
227 S=4
228 GOSUB 233
229 LE=1
230 S=5
231 GOSUB 233
232 GOTO 255
233 X2=INT(RND*2)+1
234 IF X2=2 THEN 238
235 X=INT(RND*(10-LE))+1
236 X1=INT(RND*10)+1
237 GOTO 240
238 X=INT(RND*10)+1
239 X1=INT(RND*(10-LE))+1
240 ON X2 GOTO 241,248
241 FOR Y=X TO X+LE
242 IF O(Y,X1)>0 THEN 233
243 NEXT Y
244 FOR Y=X TO X+LE
245 O(Y,X1)=S
246 NEXT Y
247 RETURN
248 FOR Y=X1 TO X1+LE
249 IF O(X,Y)>0 THEN 233
250 NEXT Y
251 FOR Y=X1 TO X1+LE
252 O(X,Y)=S
253 NEXT Y
254 RETURN
255 M1$="MY SHOT"
256 M2$="YOUR SHOT"
257 M3$="SCORE"
258 M4$="COMPUTER"
259 M5$="USER"
260 M6$="YOU MISSED"
261 M7$="I MISSED"
262 M8$="**HIT**"
263 GOTO 272
264 FOR V=1 TO 7
265 CALL HCHAR(18,V+4,ASC(SEG$(M1$,V,1)))
266 NEXT V
267 RETURN
268 FOR V=1 TO 9
269 CALL HCHAR(21,V+4,ASC(SEG$(M2$,V,1)))
270 NEXT V
271 RETURN
272 FOR X=1 TO 5
273 CALL HCHAR(18,X+22,ASC(SEG$(M3$,X,1)))
274 NEXT X
275 FOR X=1 TO 8
276 CALL HCHAR(19,X+15,ASC(SEG$(M4$,X,1)))
277 NEXT X
278 FOR X=1 TO 4
279 CALL HCHAR(19,X+26,ASC(SEG$(M5$,X,1)))
280 NEXT X
281 T=1
282 IF T=0 THEN 285
283 T=0
284 GOTO 312
285 T=1
286 CALL HCHAR(21,3,32,12)
287 CALL HCHAR(22,3,32,7)
288 GOSUB 264
289 IF W>0 THEN 357
290 RANDOMIZE
291 X=INT(10*RND)+1
292 X1=INT(10*RND)+1
293 H=X
294 H1=X1
295 IF P(X,X1)=7 THEN 290
296 IF P(X,X1)=6 THEN 290
297 CALL HCHAR(19,6,H+64)
298 CALL HCHAR(19,7,H1+47)
299 IF P(X,X1)>0 THEN 440
300 GOSUB 304
301 GOTO 282
302 P(X+10,X1)=7
303 CALL HCHAR(23,1,32,32)
304 P(X,X1)=6
305 CALL SOUND(200,-6,2)
306 CALL HCHAR(23,1,32,32)
307 CALL VCHAR(X+4,X1+17,144)
308 FOR Y=1 TO 8
309 CALL VCHAR(23,12+Y,ASC(SEG$(M7$,Y,1)))
310 NEXT Y
311 RETURN
312 CALL HCHAR(18,3,32,12)
313 CALL HCHAR(19,3,32,7)
314 GOSUB 268
315 CALL KEY(0,K1,ST)
316 IF ST=0 THEN 315
317 IF K1<65 THEN 315
318 IF K1>74 THEN 315
319 CALL VCHAR(22,6,K1)
320 CALL KEY(0,KE,ST)
321 IF ST=-1 THEN 320
322 CALL KEY(0,K2,ST)
323 IF ST=0 THEN 322
324 IF K2<48 THEN 322
325 IF K2>57 THEN 322
326 CALL VCHAR(22,7,K2)
327 K3=K1-64
328 K4=K2-47
329 IF O(K3,K4)<6 THEN 333
330 CALL SOUND(50,110,2)
331 CALL HCHAR(22,6,32,7)
332 GOTO 312
333 IF O(K3,K4)=0 THEN 344
334 CALL SOUND(200,220,2,330,2,440,2,-6,2)
335 CALL SOUND(400,110,2,220,2,330,2,-8,2)
336 CALL VCHAR(K3+4,K4+5,136)
337 SF=O(K3,K4)
338 O(K3,K4)=7
339 CALL HCHAR(23,1,32,32)
340 FOR X2=1 TO 7
341 CALL HCHAR(23,13+X2,ASC(SEG$(M8$,X2,1)))
342 NEXT X2
343 GOTO 454
344 CALL SOUND(200,-6,2)
345 CALL HCHAR(23,1,32,32)
346 O(K3,K4)=6
347 FOR X2=1 TO 10
348 CALL VCHAR(23,13+X2,ASC(SEG$(M6$,X2,1)))
349 NEXT X2
350 CALL VCHAR(K3+4,K4+5,144)
351 GOTO 282
352 CH=1
353 GOTO 459
354 CH=0
355 ON SF GOSUB 104,109,114,119,124
356 IF DS(SF)=LE-1 THEN 372
357 IF H=10 THEN 361
358 IF P(H+1,H1)<>7 THEN 360
359 IF W>1 THEN 420 ELSE 400
360 IF H=1 THEN 366
361 IF P(H-1,H1)<>7 THEN 366
362 IF W>1 THEN 420 ELSE 400
363 W2=W
364 W=W1
365 GOTO 350
366 IF H1=10 THEN 370
367 IF P(H,H1+1)<>7 THEN 369
368 IF W>1 THEN 400 ELSE 420
369 IF H1=1 THEN 372
370 IF P(H,H1-1)<>7 THEN 372
371 IF W>1 THEN 400 ELSE 420
372 L1=INT(RND*2)+1
373 ON L1 GOTO 374,382
374 X2=INT(RND*2)+1
375 ON X2 GOTO 376,379
376 X2=1
377 X3=0
378 GOTO 389
379 X2=-1
380 X3=0
381 GOTO 389
382 X3=INT(RND*2)+1
383 ON X3 GOTO 384,387
384 X3=1
385 X2=0
386 GOTO 389
387 X3=-1
388 X2=0
389 IF H+X2>10 THEN 372
390 IF H+X2<1 THEN 372
391 IF H1+X3>10 THEN 372
392 IF H1+X3<1 THEN 372
393 IF P(H+X2,H1+X3)=6 THEN 372
394 IF P(H+X2,H1+X3)=7 THEN 372
395 X=H+X2
396 X1=H1+X3
397 IF P(X,X1)>0 THEN 440
398 GOSUB 304
399 GOTO 282
400 IF H=10 THEN 410
401 H=H+1
402 IF P(H,H1)=7 THEN 400
403 IF P(H,H1)=6 THEN 410
404 X=H
405 X1=H1
406 IF P(X,X1)>0 THEN 440
407 GOSUB 304
408 H=H-1
409 GOTO 282
410 IF H=1 THEN 401
411 H=H-1
412 IF P(H,H1)=7 THEN 410
413 IF P(H,H1)=6 THEN 400
414 X=H
415 X1=H1
416 IF P(X,X1)>0 THEN 440
417 GOSUB 304
418 H=H+1
419 GOTO 282
420 IF H1=10 THEN 430
421 H1=H1+1
422 IF P(H,H1)=7 THEN 420
423 IF P(H,H1)=6 THEN 430
424 X=H
425 X1=H1
426 IF P(X,X1)>0 THEN 440
427 GOSUB 304
428 H1=H1-1
429 GOTO 282
430 IF H1=1 THEN 420
431 H1=H1-1
432 IF P(H,H1)=7 THEN 430
433 IF P(H,H1)=6 THEN 420
434 X=H
435 X1=H1
436 IF P(X,X1)>0 THEN 440
437 GOSUB 304
438 H1=H1+1
439 GOTO 282
440 CALL VCHAR(4+X,17+X1,136)
441 CALL HCHAR(23,1,32,32)
442 GOSUB 264
443 FOR Z=1 TO LEN(M8$)
444 CALL HCHAR(23,14+Z,ASC(SEG$(M8$,Z,1)))
445 NEXT Z
446 CALL SOUND(200,220,2,330,2,440,2,-8,2)
447 CALL SOUND(300,110,0,220,0,330,0,-8,0)
448 SF=P(X,X1)
449 CALL VCHAR(19,6,X+64)
450 CALL VCHAR(19,7,X1+47)
451 P(X,X1)=7
452 H=X
453 H1=X1
454 FOR X2=1 TO 5
455 DS(X2)=0
456 NEXT X2
457 FOR X2=1 TO 10
458 FOR X3=1 TO 10
459 IF CH=1 THEN 461
460 IF T=0 THEN 466
461 IF P(X2,X3)=0 THEN 470
462 IF P(X2,X3)=6 THEN 470
463 IF P(X2,X3)=7 THEN 470
464 DS(P(X2,X3))=DS(P(X2,X3))+1
465 GOTO 470
466 IF O(X2,X3)=0 THEN 470
467 IF O(X2,X3)=6 THEN 470
468 IF O(X2,X3)=7 THEN 470
469 DS(O(X2,X3))=DS(O(X2,X3))+1
470 NEXT X3
471 NEXT X2
472 IF CH=1 THEN 354
473 W=0
474 SC=0
475 FOR Z4=1 TO 5
476 ON Z4 GOSUB 104,109,114,119,124
477 IF DS(Z4)=LE THEN 486
478 IF DS(Z4)=0 THEN 481
479 W=W+1
480 GOTO 486
481 SC=SC+1
482 IF T=0 THEN 485
483 GOSUB 493
484 GOTO 486
485 GOSUB 492
486 NEXT Z4
487 IF T=0 THEN 490
488 W1=W
489 GOTO 282
490 W=W1
491 GOTO 282
492 SCP=SC
493 CALL HCHAR(23,1,32,32)
494 FOR X3=1 TO LEN(PR$)+10
495 CALL HCHAR(23,X3+6,ASC(SEG$(PR$&" DESTROYED",X3,1)))
496 NEXT X3
497 IF T=0 THEN 501
498 CALL VCHAR(20,20,SC+48)
499 IF SC=5 THEN 506
500 RETURN
501 CALL HCHAR(20,27,SC+48)
502 IF SC=5 THEN 506
503 RETURN
504 PRINT "THE COMPUTER WINS AGAIN"
505 GOTO 507
506 PRINT "YOU JUST GOT LUCKY THIS TIME"
507 PRINT "IF YOU WISH TO PLAY AGAIN"
508 PRINT "ENTER "Y",IF NOT ENTER "N""
509 INPUT NG$
510 IF NG$="N" THEN 527
511 IF NG$="Y" THEN 514
512 CALL SOUND(200,110,0)
513 GOTO 507
514 FOR L=1 TO 10
515 FOR L1=1 TO 10
516 P(L,L1)=0
517 O(L,L1)=0
518 NEXT L1
519 NEXT L
520 FOR L=1 TO 5
521 FOR L1=1 TO 5
522 SH(L,L1,1)=0
523 SH(L,L1,2)=0
524 NEXT L1
525 NEXT L
526 GOTO 81
527 CALL CLEAR
528 STOP
529 NNN=0
530 AAA=0
531 FOR X=1 TO LE-1
532 IF NNN=1 THEN 535
533 IF SH(S,X,1)=SH(S,X+1,1)THEN 538
534 IF AAA=1 THEN 195
535 IF SH(S,X,2)<>SH(S,X+1,2)THEN 195
536 NNN=1
537 GOTO 539
538 AAA=1
539 NEXT X
540 RETURN
541 END
