100 REM  ***************** 
110 REM  * BATTLE AT SEA * 
120 REM  ***************** 
130 REM  99'ER VERSION               7.81.1 
140 REM  BY W.K. BALTHROP 
150 REM  
160 REM  
170 REM  
180 RANDOMIZE
190 CALL SCREEN(12)
200 CALL CLEAR
210 PRINT TAB(9);"BATTLE AT SEA"
220 PRINT TAB(14);"BY"
230 PRINT TAB(9);"W.K. BALTHROP"
240 PRINT: : : : : : : : : : :
250 OPTION BASE 1
260 DIM P(10,10),O(10,10),SH(5,5,2)
270 CALL COLOR(14,7,1)
280 CALL COLOR(15,11,1)
290 CALL CHAR(96,"000000FF7F3F1F")
300 CALL CHAR(97,"000000FFFFFFFF")
310 CALL CHAR(98,"3C7EFFFFFFFFFF")
320 CALL CHAR(99,"000000FFFEFCF8")
330 CALL CHAR(100,"1030707070707070")
340 CALL CHAR(101,"7070707070707070")
350 CALL CHAR(102,"787C7E7E7F7F7C78")
360 CALL CHAR(103,"7070707070701010")
370 CALL CHAR(104,"00080403FF7F3F")
380 CALL CHAR(105,"8C4C3CFEFFFFFF")
390 CALL CHAR(106,"01023C3FFFFFFF")
400 CALL CHAR(107,"000204F8FFFEFE")
410 CALL CHAR(108,"1030727478787878")
420 CALL CHAR(109,"7C7C70717A7C7C7C")
430 CALL CHAR(110,"7F7F787C7C7C7A79")
440 CALL CHAR(111,"7078787C7C727110")
450 CALL CHAR(112,"00108867FF7F3F")
460 CALL CHAR(113,"09C5C3F3FFFFFF")
470 CALL CHAR(114,"000204F8FFFEFE")
480 CALL CHAR(115,"1030727478797A7C")
490 CALL CHAR(116,"797A7C7C7F7F787C")
500 CALL CHAR(117,"7C7C7A79787C7C1A")
510 CALL CHAR(118,"0000003FFF7F3F")
520 CALL CHAR(119,"067EFEFFFFFFFF")
530 CALL CHAR(120,"000000E0FCFFFE")
540 CALL CHAR(121,"1030787878787878")
550 CALL CHAR(122,"787C7C7E7E7E7F7F")
560 CALL CHAR(123,"7C7C787878703020")
570 CALL CHAR(124,"03030F1FFF7F3F")
580 CALL CHAR(125,"006060F0FFFEFE")
590 CALL CHAR(126,"1030707078787E7F")
600 CALL CHAR(127,"7C78787070707010")
610 CALL CHAR(128,"FF818181818181FF")
620 CALL CHAR(136,"815E2C366A3C2442")
630 CALL CHAR(144,"81667E3C3C7E6681")
640 CALL SOUND(-3000,220,30,554,20,1047,20,-8,30)
650 PRINT "       BATTLE AT SEA"
660 PRINT:"YOU MUST DESTROY THE ENEMY"
670 PRINT "SHIPS BEFORE THE COMPUTER"
680 PRINT "DESTROYS YOUR SHIPS."
690 PRINT:"TO SET UP YOUR SHIPS YOU"
700 PRINT "MUST ENTER COORDINATES ON"
710 PRINT "THE 10 X 10 GRID ON THE     RIGHT."
720 PRINT "ENTER THE ROW, THEN THE     COLUMN."
730 PRINT "EXAMPLE: A5"
740 PRINT "AFTER YOUR SHIPS ARE SET UP"
750 PRINT "YOU WILL TAKE A SHOT AT THE"
760 PRINT "ENEMY SHIPS BY ENTERING ONE"
770 PRINT "PAIR OF COORDINATES ON THE"
780 PRINT "ENEMY GRID."
790 PRINT "THE COMPUTER WILL THEN"
800 PRINT "TAKE A SHOT AT YOUR SHIPS.": :
810 PRINT "THE COMPUTER CANNOT SEE"
820 PRINT "YOUR SHIPS. YOU CANNOT SEE"
830 PRINT "THE COMPUTER'S SHIPS."
840 PRINT "ENTER ANY KEY TO BEGIN."
850 CALL SOUND(1,-2,30)
860 CALL KEY(0,K,S)
870 IF S=0 THEN 860
880 CALL SCREEN(6)
890 CALL CLEAR
900 PRINT "    COMPUTER      YOU"
910 PRINT: : : : : : : : : : : : : : : : : : : : :
920 FOR X=5 TO 14
930 CALL VCHAR(X,5,X+60)
940 CALL HCHAR(X,6,128,10)
950 CALL HCHAR(X,18,128,10)
960 CALL VCHAR(X,17,X+60)
970 NEXT X
980 FOR X=6 TO 15
990 CALL VCHAR(15,X+12,X+42)
1000 CALL VCHAR(15,X,X+42)
1010 NEXT X
1020 S1$="CARRIER"
1030 S2$="BATTLESHIP"
1040 S3$="CRUISER"
1050 S4$="SUBMARINE"
1060 S5$="DESTROYER"
1070 FOR S=1 TO 5
1080 ON S GOSUB 1110,1160,1210,1260,1310
1090 GOSUB 1390
1100 GOTO 1360
1110 PR$=S1$
1120 LE=5
1130 S=1
1140 OS=0
1150 RETURN
1160 PR$=S2$
1170 LE=4
1180 S=2
1190 OS=8
1200 RETURN
1210 PR$=S3$
1220 LE=3
1230 S=3
1240 OS=16
1250 RETURN
1260 PR$=S4$
1270 LE=3
1280 S=4
1290 OS=22
1300 RETURN
1310 PR$=S5$
1320 LE=2
1330 S=5
1340 OS=28
1350 RETURN
1360 NEXT S
1370 CALL HCHAR(22,1,32,64)
1380 GOTO 2230
1390 L=LEN(PR$)
1400 SUS$="ENTER ROW,COL. FOR "&STR$(LE)&" SPACES"
1410 FOR X=1 TO LEN(SUS$)
1420 SU1$=SEG$(SUS$,X,1)
1430 CALL VCHAR(22,X+2,ASC(SU1$))
1440 NEXT X
1450 PR$=PR$&" SPACE"
1460 CALL HCHAR(23,2,32,30)
1470 FOR X=1 TO LEN(PR$)
1480 SU1$=SEG$(PR$,X,1)
1490 CALL VCHAR(23,X+2,ASC(SU1$))
1500 NEXT X
1510 FOR X=1 TO LE
1520 CALL HCHAR(23,20,35)
1530 CALL VCHAR(23,21,LE-X+49)
1540 CALL KEY(0,K1,ST)
1550 IF ST=0 THEN 1540
1560 IF K1<65 THEN 1590
1570 IF K1>74 THEN 1590
1580 GOTO 1610
1590 CALL SOUND(100,-2,2)
1600 GOTO 1540
1610 CALL VCHAR(23,23,K1)
1620 CALL KEY(0,KE,ST)
1630 IF ST=-1 THEN 1620
1640 CALL KEY(0,K2,ST)
1650 IF ST=0 THEN 1640
1660 IF K2<48 THEN 1690
1670 IF K2>57 THEN 1690
1680 GOTO 1710
1690 CALL SOUND(100,-2,2)
1700 GOTO 1640
1710 CALL VCHAR(23,24,K2)
1720 SH(S,X,1)=K1-64
1730 SH(S,X,2)=K2-47
1735 IF P(K1-64,K2-47)>0 THEN 1590
1740 P(K1-64,K2-47)=S
1750 NEXT X
1760 GOSUB 5350
1770 IF SH(S,1,1)=SH(S,2,1)THEN 1800
1780 X2=1
1790 GOTO 1810
1800 X2=2
1810 FOR X3=1 TO LE
1820 F=0
1830 FOR X1=1 TO LE-X3
1840 IF SH(S,X1,X2)=0 THEN 1900
1850 IF SH(S,X1,X2)<SH(S,X1+1,X2)THEN 1900
1860 SW=SH(S,X1,X2)
1870 SH(S,X1,X2)=SH(S,X1+1,X2)
1880 SH(S,X1+1,X2)=SW
1890 F=1
1900 NEXT X1
1910 IF F=0 THEN 1930
1920 NEXT X3
1930 FOR X=1 TO LE-1
1940 IF SH(S,X,1)<>SH(S,X+1,1)-1 THEN 1970
1950 NEXT X
1960 GOTO 2060
1970 FOR X=1 TO LE-1
1980 IF SH(S,X,2)<>SH(S,X+1,2)-1 THEN 2010
1990 NEXT X
2000 GOTO 2060
2010 CALL SOUND(100,-2,2)
2020 FOR X=1 TO LE
2030 P(SH(S,X,1),SH(S,X,2))=0
2040 NEXT X
2050 GOTO 1460
2060 X=S
2070 FOR X1=1 TO 5
2080 IF SH(X,X1,1)=0 THEN 2180
2090 IF SH(X,1,1)=SH(X,2,1)THEN 2120
2100 OSA=1
2110 GOTO 2130
2120 OSA=0
2130 P(SH(X,X1,1),SH(X,X1,2))=X
2140 IF X>1 THEN 2170
2150 CALL VCHAR(SH(X,X1,1)+4,SH(X,X1,2)+17,95+X1+OS+((LE-1)*OSA))
2160 GOTO 2180
2170 CALL HCHAR(SH(X,X1,1)+4,SH(X,X1,2)+17,95+X1+OS+(LE*OSA))
2180 NEXT X1
2190 IF X>1 THEN 2220
2200 CALL HCHAR(SH(1,4,1)+4,SH(1,4,2)+17,97+((LE-1)*OSA))
2210 CALL HCHAR(SH(1,5,1)+4,SH(1,5,2)+17,99+((LE-1)*OSA))
2220 RETURN
2230 LE=4
2240 S=1
2250 GOSUB 2390
2260 LE=3
2270 S=2
2280 GOSUB 2390
2290 LE=2
2300 S=3
2310 GOSUB 2390
2320 LE=2
2330 S=4
2340 GOSUB 2390
2350 LE=1
2360 S=5
2370 GOSUB 2390
2380 GOTO 2610
2390 X2=INT(RND*2)+1
2400 IF X2=2 THEN 2440
2410 X=INT(RND*(10-LE))+1
2420 X1=INT(RND*10)+1
2430 GOTO 2460
2440 X=INT(RND*10)+1
2450 X1=INT(RND*(10-LE))+1
2460 ON X2 GOTO 2470,2540
2470 FOR Y=X TO X+LE
2480 IF O(Y,X1)>0 THEN 2390
2490 NEXT Y
2500 FOR Y=X TO X+LE
2510 O(Y,X1)=S
2520 NEXT Y
2530 RETURN
2540 FOR Y=X1 TO X1+LE
2550 IF O(X,Y)>0 THEN 2390
2560 NEXT Y
2570 FOR Y=X1 TO X1+LE
2580 O(X,Y)=S
2590 NEXT Y
2600 RETURN
2610 M1$="MY SHOT"
2620 M2$="YOUR SHOT"
2630 M3$="SCORE"
2640 M4$="COMPUTER"
2650 M5$="USER"
2660 M6$="YOU MISSED"
2670 M7$="I MISSED"
2680 M8$="**HIT**"
2690 GOTO 2780
2700 FOR V=1 TO 7
2710 CALL HCHAR(18,V+4,ASC(SEG$(M1$,V,1)))
2720 NEXT V
2730 RETURN
2740 FOR V=1 TO 9
2750 CALL HCHAR(21,V+4,ASC(SEG$(M2$,V,1)))
2760 NEXT V
2770 RETURN
2780 FOR X=1 TO 5
2790 CALL HCHAR(18,X+22,ASC(SEG$(M3$,X,1)))
2800 NEXT X
2810 FOR X=1 TO 8
2820 CALL HCHAR(19,X+15,ASC(SEG$(M4$,X,1)))
2830 NEXT X
2840 FOR X=1 TO 4
2850 CALL HCHAR(19,X+26,ASC(SEG$(M5$,X,1)))
2860 NEXT X
2870 T=1
2880 IF T=0 THEN 2910
2890 T=0
2900 GOTO 3180
2910 T=1
2920 CALL HCHAR(21,3,32,12)
2930 CALL HCHAR(22,3,32,7)
2940 GOSUB 2700
2950 IF W>0 THEN 3630
2960 RANDOMIZE
2970 X=INT(10*RND)+1
2980 X1=INT(10*RND)+1
2990 H=X
3000 H1=X1
3010 IF P(X,X1)=7 THEN 2960
3020 IF P(X,X1)=6 THEN 2960
3030 CALL HCHAR(19,6,H+64)
3040 CALL HCHAR(19,7,H1+47)
3050 IF P(X,X1)>0 THEN 4460
3060 GOSUB 3100
3070 GOTO 2880
3080 P(X+10,X1)=7
3090 CALL HCHAR(23,1,32,32)
3100 P(X,X1)=6
3110 CALL SOUND(200,-6,2)
3120 CALL HCHAR(23,1,32,32)
3130 CALL VCHAR(X+4,X1+17,144)
3140 FOR Y=1 TO 8
3150 CALL VCHAR(23,12+Y,ASC(SEG$(M7$,Y,1)))
3160 NEXT Y
3170 RETURN
3180 CALL HCHAR(18,3,32,12)
3190 CALL HCHAR(19,3,32,7)
3200 GOSUB 2740
3210 CALL KEY(0,K1,ST)
3220 IF ST=0 THEN 3210
3230 IF K1<65 THEN 3210
3240 IF K1>74 THEN 3210
3250 CALL VCHAR(22,6,K1)
3260 CALL KEY(0,KE,ST)
3270 IF ST=-1 THEN 3260
3280 CALL KEY(0,K2,ST)
3290 IF ST=0 THEN 3280
3300 IF K2<48 THEN 3280
3310 IF K2>57 THEN 3280
3320 CALL VCHAR(22,7,K2)
3330 K3=K1-64
3340 K4=K2-47
3350 IF O(K3,K4)<6 THEN 3390
3360 CALL SOUND(50,110,2)
3370 CALL HCHAR(22,6,32,7)
3380 GOTO 3180
3390 IF O(K3,K4)=0 THEN 3500
3400 CALL SOUND(200,220,2,330,2,440,2,-6,2)
3410 CALL SOUND(400,110,2,220,2,330,2,-8,2)
3420 CALL VCHAR(K3+4,K4+5,136)
3430 SF=O(K3,K4)
3440 O(K3,K4)=7
3450 CALL HCHAR(23,1,32,32)
3460 FOR X2=1 TO 7
3470 CALL HCHAR(23,13+X2,ASC(SEG$(M8$,X2,1)))
3480 NEXT X2
3490 GOTO 4600
3500 CALL SOUND(200,-6,2)
3510 CALL HCHAR(23,1,32,32)
3520 O(K3,K4)=6
3530 FOR X2=1 TO 10
3540 CALL VCHAR(23,13+X2,ASC(SEG$(M6$,X2,1)))
3550 NEXT X2
3560 CALL VCHAR(K3+4,K4+5,144)
3570 GOTO 2880
3580 CH=1
3590 GOTO 4650
3600 CH=0
3610 ON SF GOSUB 1110,1160,1210,1260,1310
3620 IF DS(SF)=LE-1 THEN 3780
3630 IF H=10 THEN 3670
3640 IF P(H+1,H1)<>7 THEN 3660
3650 IF W>1 THEN 4260 ELSE 4060
3660 IF H=1 THEN 3720
3670 IF P(H-1,H1)<>7 THEN 3720
3680 IF W>1 THEN 4260 ELSE 4060
3690 W2=W
3700 W=W1
3710 GOTO 3560
3720 IF H1=10 THEN 3760
3730 IF P(H,H1+1)<>7 THEN 3750
3740 IF W>1 THEN 4060 ELSE 4260
3750 IF H1=1 THEN 3780
3760 IF P(H,H1-1)<>7 THEN 3780
3770 IF W>1 THEN 4060 ELSE 4260
3780 L1=INT(RND*2)+1
3790 ON L1 GOTO 3800,3880
3800 X2=INT(RND*2)+1
3810 ON X2 GOTO 3820,3850
3820 X2=1
3830 X3=0
3840 GOTO 3950
3850 X2=-1
3860 X3=0
3870 GOTO 3950
3880 X3=INT(RND*2)+1
3890 ON X3 GOTO 3900,3930
3900 X3=1
3910 X2=0
3920 GOTO 3950
3930 X3=-1
3940 X2=0
3950 IF H+X2>10 THEN 3780
3960 IF H+X2<1 THEN 3780
3970 IF H1+X3>10 THEN 3780
3980 IF H1+X3<1 THEN 3780
3990 IF P(H+X2,H1+X3)=6 THEN 3780
4000 IF P(H+X2,H1+X3)=7 THEN 3780
4010 X=H+X2
4020 X1=H1+X3
4030 IF P(X,X1)>0 THEN 4460
4040 GOSUB 3100
4050 GOTO 2880
4060 IF H=10 THEN 4160
4070 H=H+1
4080 IF P(H,H1)=7 THEN 4060
4090 IF P(H,H1)=6 THEN 4160
4100 X=H
4110 X1=H1
4120 IF P(X,X1)>0 THEN 4460
4130 GOSUB 3100
4140 H=H-1
4150 GOTO 2880
4160 IF H=1 THEN 4070
4170 H=H-1
4180 IF P(H,H1)=7 THEN 4160
4190 IF P(H,H1)=6 THEN 4060
4200 X=H
4210 X1=H1
4220 IF P(X,X1)>0 THEN 4460
4230 GOSUB 3100
4240 H=H+1
4250 GOTO 2880
4260 IF H1=10 THEN 4360
4270 H1=H1+1
4280 IF P(H,H1)=7 THEN 4260
4290 IF P(H,H1)=6 THEN 4360
4300 X=H
4310 X1=H1
4320 IF P(X,X1)>0 THEN 4460
4330 GOSUB 3100
4340 H1=H1-1
4350 GOTO 2880
4360 IF H1=1 THEN 4260
4370 H1=H1-1
4380 IF P(H,H1)=7 THEN 4360
4390 IF P(H,H1)=6 THEN 4260
4400 X=H
4410 X1=H1
4420 IF P(X,X1)>0 THEN 4460
4430 GOSUB 3100
4440 H1=H1+1
4450 GOTO 2880
4460 CALL VCHAR(4+X,17+X1,136)
4470 CALL HCHAR(23,1,32,32)
4480 GOSUB 2700
4490 FOR Z=1 TO LEN(M8$)
4500 CALL HCHAR(23,14+Z,ASC(SEG$(M8$,Z,1)))
4510 NEXT Z
4520 CALL SOUND(200,220,2,330,2,440,2,-8,2)
4530 CALL SOUND(300,110,0,220,0,330,0,-8,0)
4540 SF=P(X,X1)
4550 CALL VCHAR(19,6,X+64)
4560 CALL VCHAR(19,7,X1+47)
4570 P(X,X1)=7
4580 H=X
4590 H1=X1
4600 FOR X2=1 TO 5
4610 DS(X2)=0
4620 NEXT X2
4630 FOR X2=1 TO 10
4640 FOR X3=1 TO 10
4650 IF CH=1 THEN 4670
4660 IF T=0 THEN 4720
4670 IF P(X2,X3)=0 THEN 4760
4680 IF P(X2,X3)=6 THEN 4760
4690 IF P(X2,X3)=7 THEN 4760
4700 DS(P(X2,X3))=DS(P(X2,X3))+1
4710 GOTO 4760
4720 IF O(X2,X3)=0 THEN 4760
4730 IF O(X2,X3)=6 THEN 4760
4740 IF O(X2,X3)=7 THEN 4760
4750 DS(O(X2,X3))=DS(O(X2,X3))+1
4760 NEXT X3
4770 NEXT X2
4780 IF CH=1 THEN 3600
4790 W=0
4800 SCORE=0
4810 FOR Z4=1 TO 5
4820 ON Z4 GOSUB 1110,1160,1210,1260,1310
4830 IF DS(Z4)=LE THEN 4920
4840 IF DS(Z4)=0 THEN 4870
4850 W=W+1
4860 GOTO 4920
4870 SCORE=SCORE+1
4880 IF T=0 THEN 4910
4890 GOSUB 4990
4900 GOTO 4920
4910 GOSUB 4980
4920 NEXT Z4
4930 IF T=0 THEN 4960
4940 W1=W
4950 GOTO 2880
4960 W=W1
4970 GOTO 2880
4980 SCP=SCORE
4990 CALL HCHAR(23,1,32,32)
5000 FOR X3=1 TO LEN(PR$)+10
5010 CALL HCHAR(23,X3+6,ASC(SEG$(PR$&" DESTROYED",X3,1)))
5020 NEXT X3
5030 IF T=0 THEN 5070
5040 CALL VCHAR(20,20,SCORE+48)
5050 IF SCORE=5 THEN 5120
5060 RETURN
5070 CALL HCHAR(20,27,SCORE+48)
5080 IF SCORE=5 THEN 5120
5090 RETURN
5100 PRINT "THE COMPUTER WINS AGAIN"
5110 GOTO 5130
5120 PRINT "YOU JUST GOT LUCKY THIS TIME"
5130 PRINT "IF YOU WISH TO PLAY AGAIN"
5140 PRINT "ENTER ""Y"",IF NOT ENTER ""N"""
5150 INPUT NG$
5160 IF NG$="N" THEN 5330
5170 IF NG$="Y" THEN 5200
5180 CALL SOUND(200,110,0)
5190 GOTO 5130
5200 FOR L=1 TO 10
5210 FOR L1=1 TO 10
5220 P(L,L1)=0
5230 O(L,L1)=0
5240 NEXT L1
5250 NEXT L
5260 FOR L=1 TO 5
5270 FOR L1=1 TO 5
5280 SH(L,L1,1)=0
5290 SH(L,L1,2)=0
5300 NEXT L1
5310 NEXT L
5320 GOTO 880
5330 CALL CLEAR
5340 STOP
5350 NNN=0
5360 AAA=0
5370 FOR X=1 TO LE-1
5380 IF NNN=1 THEN 5410
5390 IF SH(S,X,1)=SH(S,X+1,1)THEN 5440
5400 IF AAA=1 THEN 2010
5410 IF SH(S,X,2)<>SH(S,X+1,2)THEN 2010
5420 NNN=1
5430 GOTO 5450
5440 AAA=1
5450 NEXT X
5460 RETURN
5470 END
