5 CLS: COLOR 12
10 REM  "ABSTRACT"
15 PRINT TAB(36); "Abstract": PRINT: PRINT
20 REM
25 RANDOMIZE TIMER
30 GOSUB 9000
40 DIM A(3), B(3)
50 COLOR 10: PRINT "Do you need instructions (Y/N)";
60 INPUT Q$: COLOR 15
70 IF LEFT$(Q$, 1) = "N" OR LEFT$(Q$, 1) = "n" THEN 90
80 GOSUB 1000
90 PRINT
100 LET F$ = "I forget to tell you that"
110 LET G = 0
120 GOSUB 2000
129 REM "MAINLINE"
130 LET G = G + 1
140 GOSUB 3000
150 GOSUB 4000
160 GOSUB 5000
170 IF M1 = 3 THEN 190
175 IF G < 20 THEN 130
180 PRINT "It was:"; A(1) * 100 + A(2) * 10 + A(3)
185 GOTO 240
190 PRINT "You got it -- ";
200 IF G < 13 THEN 230
210 PRINT "finally!"
220 GOTO 240
230 PRINT "in only"; G; "guesses!"
240 COLOR 10: PRINT: PRINT "Another round (Y/N)";
250 INPUT Q$: COLOR 15
260 IF LEFT$(Q$, 1) = "Y" OR LEFT$(Q$, 1) = "y" THEN 90
270 PRINT: PRINT "So long, then."
280 END
999 REM  "INSTRUCTIONS"
1000 COLOR 14: PRINT
1010 PRINT "I am holding a 3-digit number... can you guess what it is?"
1020 PRINT "When you guess, I will tell you:"
1030 COLOR 11: PRINT
1040 PRINT "   Askew    - A digit is in the wrong place."
1070 PRINT "   Astute   - A digit is in the right place."
1090 PRINT "   Abstract - A digit is incorrect."
1100 PRINT: COLOR 15
1110 RETURN
1999 REM  "COMPUTER'S NUMBER"
2000 FOR I = 1 TO 3
2010 LET A(I) = INT(10 * RND(1))
2020 IF I = 2 THEN 2070
2030 IF I = 3 THEN 2060
2035 IF A(3) = A(1) THEN 2010
2040 NEXT I
2050 RETURN
2060 IF A(3) = A(2) THEN 2010
2065 IF A(3) = A(1) THEN 2010
2070 IF A(2) = A(1) THEN 2010
2080 GOTO 2040
2999 REM  "PLAYER INPUT"
3000 G$ = STR$(G): G$ = RIGHT$(G$, LEN(G$) - 1)
3005 COLOR 10: PRINT "Guess #"; G$;
3010 INPUT Q: COLOR 15
3020 IF Q <= 999 THEN 3050
3030 PRINT "Too big -- can be only 3 digits.": PRINT
3040 GOTO 3000
3050 GOSUB 3300
3060 IF B(1) = B(2) THEN 3100
3070 IF B(2) = B(3) THEN 3100
3080 IF B(3) = B(1) THEN 3100
3090 RETURN
3100 PRINT F$;
3110 LET F$ = "Pay attention,"
3120 PRINT " my number has no two digits the same.": PRINT
3140 GOTO 3000
3299 REM  "PARSE PLAYER NUMBER"
3300 LET A1 = Q
3310 LET B(1) = INT(A1 / 100)
3320 LET B(2) = INT(A1 / 10) - B(1) * 10
3330 LET B(3) = A1 - B(1) * 100 - B(2) * 10
3340 RETURN
3999 REM  "GET CLUES"
4000 PRINT
4010 GOSUB 4400
4020 GOSUB 4600
4030 RETURN
4399 REM  "COUNT ASTUTE CLUES"
4400 LET M1 = 0
4410 FOR I = 1 TO 3
4420 IF A(I) <> B(I) THEN 4440
4430 LET M1 = M1 + 1
4440 NEXT I
4449 REM  "COUNT ABSTRACT CLUES"
4450 LET M2 = 0
4460 FOR I = 1 TO 3
4470 IF A(1) = B(I) THEN 4490
4472 IF A(2) = B(I) THEN 4490
4474 IF A(3) = B(I) THEN 4490
4480 LET M2 = M2 + 1
4490 NEXT I
4500 RETURN
4599 REM  "COUNT ASKEW CLUES"
4600 LET M3 = 0
4610 IF A(1) = B(2) THEN GOSUB 4680
4620 IF A(1) = B(3) THEN GOSUB 4680
4630 IF A(2) = B(1) THEN GOSUB 4680
4640 IF A(2) = B(3) THEN GOSUB 4680
4650 IF A(3) = B(2) THEN GOSUB 4680
4660 IF A(3) = B(1) THEN GOSUB 4680
4670 RETURN
4680 LET M3 = M3 + 1
4690 RETURN
4999 REM  "PRINT CLUES"
5000 LET M = M1
5010 GOSUB 5100
5020 LET M = M2
5030 GOSUB 5200
5040 LET M = M3
5050 GOSUB 5300
5060 PRINT
5070 RETURN
5100 LET M$ = "Astute"
5110 GOTO 5500
5200 LET M$ = "Abstract"
5210 GOTO 5500
5300 LET M$ = "Askew"
5500 IF M = 0 THEN 5540
5510 COLOR 13: FOR I = 1 TO M
5520 PRINT "    "; M$
5530 NEXT I: COLOR 15
5540 RETURN
9000 REM  "RANDOM NUMBER ROUTINE"
9010 LET Z = RND(1)
9020 RETURN

