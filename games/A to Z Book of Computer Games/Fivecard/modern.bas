5 CLS: COLOR 12
10 REM  "FIVECARD"
15 PRINT TAB(36); "Fivecard": PRINT: PRINT
20 REM
25 RANDOMIZE TIMER
30 DIM D(52)
40 DIM A(5), A1(5), A2(10)
50 DIM B(5), B1(5), B2(10)
60 DIM H(13), R(10)
70 COLOR 10: PRINT "Want the rules (Y/N)";
80 INPUT Q$: COLOR 15
90 IF LEFT$(Q$, 1) = "N" OR LEFT$(Q$, 1) = "n" THEN 190
100 COLOR 14: PRINT
110 PRINT "You and I wll play 5-card stud.  The ante is $5.  Betting limit is $20."
120 PRINT "I call all bets and we split on tie hands.  We have $200 each, and the game"
130 PRINT "ends when one of us goes broke.  Betting is allowed only once, after two cards"
140 PRINT "apiece are dealt.  The deck is shuffled before each round."
150 COLOR 15
190 GOSUB 9000
195 PRINT
200 LET Y = 200
210 LET M = Y
215 LET Q = 0
220 PRINT
230 LET P = 1
240 GOSUB 7000
250 LET Q = 0
260 IF M = 0 THEN 290
270 IF Y = 0 THEN 340
280 GOTO 360
290 PRINT "I'm busted!"
300 COLOR 10: PRINT: PRINT "Another game (Y/N)";
310 INPUT Q$: COLOR 15
320 IF LEFT$(Q$, 1) = "Y" OR LEFT$(Q$, 1) = "y" THEN 200
330 END
340 PRINT "You're broke!"
350 GOTO 300
360 GOSUB 2000
370 PRINT "You"; TAB(30); "Me"
375 FOR I = 1 TO 2
380 GOSUB 3400
390 NEXT I
400 COLOR 10: PRINT TAB(15); "Bet";
410 INPUT Q: COLOR 15
415 LET Q = ABS(Q)
420 IF Q > 0 THEN 450
430 PRINT "Huh?"
440 GOTO 400
450 IF Q < 21 THEN 480
460 PRINT "The house limit is $20."
470 GOTO 400
480 IF Q <= L THEN 510
490 L$ = STR$(L): L$ = RIGHT$(L$, LEN(L$) - 1)
495 PRINT "The limit is now only $"; L$; "."
500 GOTO 400
510 GOSUB 7000
520 FOR I = 3 TO 5
530 GOSUB 3400
540 NEXT I
550 GOSUB 1000
560 GOSUB 6000
570 COLOR 13: PRINT "--> "; C$;
580 LET P = 2
590 GOSUB 1000
600 GOSUB 6000
610 PRINT TAB(30); "--> "; C$: PRINT: COLOR 15
620 GOSUB 5000
630 GOTO 220
1000 REM  "HAND ANALYZER"
1010 FOR I = 1 TO 13
1020 LET H(I) = 0
1030 NEXT I
1040 FOR I = 1 TO 5
1050 GOSUB 1620
1060 LET H(J) = H(J) + 1
1070 NEXT I
1080 FOR I = 1 TO 10
1090 LET R(I) = 0
1100 NEXT I
1110 FOR I = 1 TO 13
1120 LET J = H(I)
1130 IF J = 0 THEN 1250
1145 IF H(I) <> H(I - 1) THEN 1160
1150 LET R(6) = R(6) + J
1160 IF J <> 2 THEN 1210
1170 IF R(9) = 0 THEN 1200
1180 LET R(8) = I
1190 GOTO 1210
1200 LET R(9) = I
1210 IF J <> 3 THEN 1230
1220 LET R(7) = I
1230 IF J <> 4 THEN 1250
1240 LET R(3) = I
1250 NEXT I
1260 IF R(6) = 5 THEN 1280
1270 LET R(6) = 0
1280 FOR I = 13 TO 1 STEP -1
1290 LET R(10) = I
1300 IF H(I) <> 0 THEN 1320
1310 NEXT I
1320 IF R(7) = 0 THEN 1350
1330 IF R(8) = 0 THEN 1350
1340 LET R(4) = R(7)
1350 FOR I = 1 TO 5
1360 GOSUB 1530
1370 IF J <> R(5) THEN 1440
1380 NEXT I
1390 LET R(5) = 6
1400 IF R(6) = 0 THEN 1440
1410 LET R(2) = R(10)
1420 IF R(10) <> 13 THEN 1440
1430 LET R(1) = 13
1440 IF P = 2 THEN 1490
1450 FOR I = 1 TO 10
1460 LET A2(I) = R(I)
1470 NEXT I
1480 RETURN
1490 FOR I = 1 TO 10
1500 LET B2(I) = R(I)
1510 NEXT I
1520 RETURN
1530 IF P = 2 THEN 1590
1540 LET R(5) = A1(1)
1550 LET J = A1(I)
1560 IF R(5) = J THEN 1580
1570 LET R(5) = 0
1580 RETURN
1590 LET R(5) = B1(1)
1600 LET J = B1(I)
1610 GOTO 1560
1620 IF P = 2 THEN 1650
1630 LET J = A(I)
1640 RETURN
1650 LET J = B(I)
1660 RETURN
1999 REM  "DRAW HANDS"
2000 GOSUB 8000
2010 FOR I = 1 TO 5
2020 GOSUB 8100
2030 LET A(I) = C
2040 LET A1(I) = S
2050 GOSUB 8100
2060 LET B(I) = C
2070 LET B1(I) = S
2080 NEXT I
2090 RETURN
2999 REM  "SET UP CARD PRINT"
3000 DATA 2,3,4,5,6,7,8,9,10
3010 DATA Jack,Queen,King,Ace
3020 FOR I1 = 1 TO 13
3030 READ C$
3040 IF C = I1 THEN 3060
3050 NEXT I1
3060 RESTORE
3070 LET S$ = " of Hearts"
3080 IF S = 1 THEN 3140
3090 LET S$ = " of Clubs"
3100 IF S = 2 THEN 3140
3110 LET S$ = " of Diamonds"
3120 IF S = 3 THEN 3140
3130 LET S$ = " of Spades"
3140 RETURN
3399 REM  "CARD PRINTER"
3400 LET C = A(I)
3410 LET S = A1(I)
3420 GOSUB 3000
3430 COLOR 11: PRINT C$; S$;
3440 LET C = B(I)
3450 LET S = B1(I)
3460 GOSUB 3000
3470 PRINT TAB(30); C$; S$: COLOR 15
3480 RETURN
4999 REM  "PICK THE NUMBER"
5000 FOR I = 1 TO 9
5010 LET A2(10) = A2(10) + A2(I)
5020 LET B2(10) = B2(10) + B2(I)
5030 NEXT I
5040 FOR I = 1 TO 10
5050 IF A2(I) + B2(I) <> 0 THEN 5070
5060 NEXT I
5065 GOTO 5190
5070 IF A2(I) = B2(I) THEN 5160
5080 IF A2(I) > B2(I) THEN 5130
5090 PRINT: PRINT TAB(15); "I";
5100 LET M = M + K
5110 PRINT " win $"; K / 2
5122 Y$ = STR$(Y): IF Y >= 0 THEN Y$ = RIGHT$(Y$, LEN(Y$) - 1)
5123 M$ = STR$(M): IF M >= 0 THEN M$ = RIGHT$(M$, LEN(M$) - 1)
5115 PRINT "You = $"; Y$; TAB(30); "Me = $"; M$
5120 RETURN
5130 PRINT: PRINT TAB(15); "You";
5140 LET Y = Y + K
5150 GOTO 5110
5160 LET A2(I) = 0
5170 LET B2(I) = 0
5172 LET A2(10) = 0
5174 LET B2(10) = 0
5180 GOTO 5000
5190 PRINT: PRINT TAB(15); "Tie Hand!": COLOR 15
5200 LET M = M + K / 2
5210 LET Y = Y + K / 2
5220 GOTO 5115
5999 REM  "PRINT HAND TYPE"
6000 DATA "Royal Flush","Straight Flush"
6010 DATA "4 of a Kind","Full House","Flush"
6020 DATA "Straight","3 of a Kind","2 Pairs"
6030 DATA "Pair","High Card"
6040 FOR I = 1 TO 13
6050 READ Q$
6060 NEXT I
6070 FOR I = 1 TO 10
6080 READ C$
6090 IF R(I) <> 0 THEN 6110
6100 NEXT I
6110 RESTORE
6120 RETURN
6999 REM  "ADD SCORE"
7000 LET M = M - Q
7010 LET Y = Y - Q
7020 LET K = Q + Q
7030 LET L = 20
7040 IF M < L THEN 7050
7044 IF Y > L THEN 7060
7046 LET L = Y
7048 GOTO 7060
7050 LET L = M
7055 IF Y < M THEN 7046
7060 LET Q = 0
7070 RETURN
7999 REM  "GENERATE DECK"
8000 FOR I = 1 TO 52
8010 LET D(I) = I
8020 NEXT I
8030 RETURN
8099 REM  "DRAW CARDS"
8100 LET C = INT(100 * RND(1))
8110 IF C < 1 THEN 8100
8120 IF C > 52 THEN 8100
8130 IF D(C) = 0 THEN 8100
8140 LET D(C) = 0
8150 LET S = 1
8160 IF C > 13 THEN 8180
8170 RETURN
8180 LET C = C - 13
8190 LET S = S + 1
8200 GOTO 8160
9000 REM  "RANDOM NUMBER ROUTINE"
9010 LET Z = RND(1)
9020 RETURN

