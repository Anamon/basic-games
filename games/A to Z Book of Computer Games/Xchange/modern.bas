5 CLS: COLOR 12
10 REM "XCHANGE"
15 PRINT TAB(36); "Xchange": PRINT: PRINT
20 REM
25 RANDOMIZE TIMER
30 GOSUB 9000
40 LET M1$ = "Invalid character."
50 LET M2$ = "Illegal move."
60 LET M3$ = "You're the winner!"
70 LET A$ = "*"
80 DIM X$(9), Y$(9)
90 COLOR 10: PRINT "Do you want instructions (Y/N)";
100 INPUT Q$: COLOR 15
110 IF LEFT$(Q$, 1) = "N" OR LEFT$(Q$, 1) = "n" THEN 160
120 IF LEFT$(Q$, 1) = "Y" OR LEFT$(Q$, 1) = "y" THEN 150
130 PRINT "Huh?"
140 GOTO 90
150 GOSUB 1000
160 COLOR 10: PRINT "Number of players (1 or 2)";
170 INPUT P: COLOR 15
180 IF P = 1 THEN 210
190 IF P = 2 THEN 210
200 GOTO 160
210 GOSUB 2000
220 GOSUB 3000
225 IF Q$ = "X" OR Q$ = "x" THEN 280
230 IF P <> 2 THEN 250
240 GOSUB 4000
250 GOSUB 5000
260 GOSUB 6000
270 IF I <> 8 THEN 220
280 PRINT
290 COLOR 10: PRINT "Another game (Y/N)";
300 INPUT Q$: COLOR 15
310 IF LEFT$(Q$, 1) = "Y" OR LEFT$(Q$, 1) = "y" THEN 160
320 PRINT: PRINT "So long..."
330 END
1000 COLOR 14: PRINT
1010 PRINT "One or two may play.  If two, you take turns.  A grid looks like this:"
1020 COLOR 11: PRINT
1030 PRINT "    F G D"
1040 PRINT "    A H *"
1045 PRINT "    E B C"
1050 COLOR 14: PRINT
1055 PRINT "But it should look like this:"
1060 COLOR 11: PRINT
1065 PRINT "    A B C"
1070 PRINT "    D E F"
1080 PRINT "    G H *"
1090 COLOR 14: PRINT
1100 PRINT "You may exchange any one letter with the '*', but only one that's adjacent:"
1110 PRINT "above, below, left, or right.  Not all puzzles are possible, and you may enter"
1115 PRINT "'X' to give up."
1120 PRINT
1150 PRINT "Here we go..."
1155 PRINT: COLOR 15
1160 RETURN
1999 REM  "SCRAMBLER"
2000 DATA A,B,C,D,E,F,G,H,*
2010 FOR I = 1 TO 9
2020 READ X$(I)
2030 NEXT I
2040 RESTORE
2050 FOR I = 1 TO 9
2060 LET R = INT(10 * RND(1))
2070 IF R < 1 THEN 2060
2080 LET X$ = X$(I)
2090 LET X$(I) = X$(R)
2100 LET X$(R) = X$
2110 NEXT I
2120 FOR I = 1 TO 9
2130 LET Y$(I) = X$(I)
2140 NEXT I
2150 GOSUB 5000
2160 RETURN
2999 REM "PLAYER-X MOVES"
3000 COLOR 10: PRINT "Move";
3010 INPUT Q$: COLOR 15
3012 IF Q$ >= "a" AND Q$ <= "z" THEN Q$ = CHR$(ASC(Q$) - 32)
3015 IF Q$ = "X" OR Q$ = "x" THEN 3200
3020 IF Q$ <> A$ THEN 3050
3030 PRINT M2$
3040 GOTO 3000
3050 FOR I = 1 TO 9
3060 IF Q$ = X$(I) THEN 3100
3070 NEXT I
3080 PRINT M1$
3090 GOTO 3000
3100 FOR J = 1 TO 9
3110 IF X$(J) = A$ THEN 3130
3120 NEXT J
3130 IF I + 1 = J THEN 3180
3140 IF I + 3 = J THEN 3180
3150 IF I - 1 = J THEN 3180
3160 IF I - 3 = J THEN 3180
3170 GOTO 3030
3180 LET X$(J) = X$(I)
3190 LET X$(I) = A$
3200 RETURN
3999 REM "PLAYER-Y MOVES"
4000 COLOR 10: PRINT TAB(16); "Move";
4010 INPUT Q$: COLOR 15
4012 IF Q$ >= "a" AND Q$ <= "z" THEN Q$ = CHR$(ASC(Q$) - 32)
4020 IF Q$ <> A$ THEN 4050
4030 PRINT M2$
4040 GOTO 4000
4050 FOR I = 1 TO 9
4060 IF Q$ = Y$(I) THEN 4100
4070 NEXT I
4080 PRINT TAB(16); M1$
4090 GOTO 4000
4100 FOR J = 1 TO 9
4110 IF Y$(J) = A$ THEN 4130
4120 NEXT J
4130 IF I + 1 = J THEN 4180
4140 IF I + 3 = J THEN 4180
4150 IF I - 1 = J THEN 4180
4160 IF I - 3 = J THEN 4180
4170 GOTO 4030
4180 LET Y$(J) = Y$(I)
4190 LET Y$(I) = A$
4200 RETURN
4999 REM  "PRINT GRIDS"
5000 PRINT: COLOR 11
5010 FOR I = 1 TO 9 STEP 3
5020 PRINT "   ";: FOR J = I TO I + 2
5030 PRINT " "; X$(J);
5040 NEXT J
5050 IF P = 2 THEN 5100
5060 PRINT
5070 NEXT I
5080 PRINT
5090 COLOR 15: RETURN
5100 PRINT TAB(16);: FOR J = I TO I + 2
5110 PRINT " "; Y$(J);
5120 NEXT J
5130 GOTO 5060
5999 REM  "WINNER CHECK"
6000 FOR I = 1 TO 8
6010 READ X$
6020 IF X$(I) <> X$ THEN 6070
6030 NEXT I
6040 PRINT M3$: I = 8
6050 RESTORE
6060 RETURN
6070 IF P <> 2 THEN 6050
6080 FOR I = 1 TO 8
6090 READ Y$
6100 IF Y$(I) <> Y$ THEN 6050
6110 NEXT I
6120 PRINT TAB(16); M3$: I = 8
6130 GOTO 6050
9000 REM  "RANDOM NUMBER ROUTINE"
9010 LET Z = RND(1)
9020 RETURN

