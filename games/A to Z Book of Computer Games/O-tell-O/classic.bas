10 REM  "OTELLO"
20 REM
25 RANDOMIZE TIMER
30 DIM B(8, 8)
40 DIM L$(8), N$(8)
50 DATA A,1,B,2,C,3,D,4
60 DATA E,5,F,6,G,7,H,8
70 FOR I = 1 TO 8
80 READ L$(I), N$(I)
90 NEXT I
100 PRINT "WANT INSTRUCTIONS (Y OR N)";
110 INPUT Q$
120 IF Q$ = "N" THEN 140
130 GOSUB 1000
140 GOSUB 2000
150 GOSUB 3000
160 GOSUB 4000
170 IF T <> 0 THEN 210
180 GOSUB 7000
190 IF W = 1 THEN 250
200 GOTO 150
204 IF Q$ = " " THEN 160
206 GOTO 150
210 IF T = 1 THEN 204
220 PRINT "STALEMATE (Y OR N)";
230 INPUT Q$
240 IF Q$ <> "Y" THEN 150
250 PRINT "SCORES   O = "; O; "   X ="; X
260 PRINT
270 PRINT "ANOTHER GAME (Y OR N)";
280 INPUT Q$
290 IF Q$ = "Y" THEN 140
300 PRINT "BYE"
310 END
1000 PRINT "TWO PLAYERS COMPETE ON AN"
1010 PRINT "8-BY-8 BOARD.  ONE HAS 'X', THE"
1020 PRINT "OTHER HAS 'O'.  IN YOUR TURN,"
1030 PRINT "PLACE YOUR MARK NEXT TO ONE OF"
1040 PRINT "HIS SO THAT YOU MAKE A 'ROW'"
1050 PRINT "(VERTICAL, HORIZONTAL, DIAGONAL)"
1060 PRINT "WITH YOUR'S ON THE ENDS."
1070 PRINT "WHEN YOU DO, YOU 'FLIP' ALL OF"
1080 PRINT "HIS TO BE YOUR'S."
1090 PRINT "IF YOU CAN'T PLAY, PASS (NO"
1100 PRINT "ENTRY)."
1110 PRINT "GAME IS OVER WHEN YOU BOTH HAVE"
1120 PRINT "TO PASS, OR THE BOARD IS FULL."
1130 PRINT "THE PLAYER WITH THE MOST PIECES"
1140 PRINT "WINS THE GAME."
1150 PRINT "..........READY";
1160 INPUT Q$
1170 RETURN
1999 REM  "FIRST BOARD"
2000 LET P$ = "O"
2010 LET P1$ = "X"
2020 LET P = 1
2030 LET P1 = 2
2040 LET W = 0
2050 FOR I = 1 TO 8
2060 FOR J = 1 TO 8
2070 LET B(I, J) = W
2080 NEXT J
2090 NEXT I
2100 LET B(4, 4) = P
2110 LET B(5, 5) = P
2120 LET B(4, 5) = P1
2130 LET B(5, 4) = P1
2140 RETURN
2999 REM  "PRINT BOARD"
3000 PRINT
3010 GOSUB 3140
3020 FOR I = 1 TO 8
3030 PRINT I; " ";
3040 FOR J = 1 TO 8
3050 IF B(I, J) <> 0 THEN 3070
3060 PRINT ". ";
3070 IF B(I, J) <> 1 THEN 3090
3080 PRINT "O ";
3090 IF B(I, J) <> 2 THEN 3110
3100 PRINT "X ";
3110 NEXT J
3120 PRINT I
3130 NEXT I
3135 PRINT
3140 PRINT "    A B C D E F G H"
3150 PRINT
3160 LET T = 0
3170 RETURN
3999 REM  "PLAYER INPUT"
4000 LET Q$ = " "
4010 LET Q1$ = Q$
4020 PRINT P$; " MOVE (C,R)";
4030 INPUT Q$, Q1$
4040 IF Q$ = " " THEN 4180
4050 GOSUB 4400
4060 IF I > 0 THEN 4090
4070 PRINT "I DON'T UNDERSTAND"
4080 GOTO 4000
4090 IF B(I, J) = 0 THEN 4120
4100 PRINT "OCCUPIED SPACE"
4110 GOTO 4000
4120 LET E = 0
4130 GOSUB 5000
4140 GOSUB 6000
4150 IF E <> 0 THEN 4200
4160 PRINT "ILLEGAL MOVE"
4170 GOTO 4000
4180 PRINT "PASS"
4190 LET T = T + 1
4200 LET Q = P
4210 LET P = P1
4220 LET P1 = Q
4230 LET Q1$ = P$
4240 LET P$ = P1$
4250 LET P1$ = Q1$
4260 RETURN
4399 REM  "CONVERT INPUT"
4400 FOR I = 1 TO 8
4410 IF Q$ = N$(I) THEN 4460
4420 IF Q$ = L$(I) THEN 4500
4430 NEXT I
4440 LET I = 0
4450 RETURN
4460 FOR J = 1 TO 8
4470 IF Q1$ = N$(I) THEN 4450
4480 NEXT J
4490 GOTO 4440
4500 LET J = I
4510 FOR I = 1 TO 8
4520 IF Q1$ = N$(I) THEN 4450
4530 NEXT I
4540 GOTO 4440
4999 REM  "HORIZONTAL & VERTICAL"
5000 FOR K = 1 TO 4
5010 LET R = I
5020 LET R1 = I
5030 LET C = J
5040 LET C1 = J
5050 GOSUB 5200
5055 NEXT K
5060 RETURN
5199 REM  "EAST"
5200 IF K <> 1 THEN 5400
5210 IF C + 1 > 8 THEN 5340
5220 IF B(R, C + 1) = 0 THEN 5340
5230 IF B(R, C + 1) = P THEN 5270
5240 LET C = C + 1
5260 GOTO 5210
5270 IF C = J THEN 5340
5290 IF C1 > C THEN 5330
5300 LET B(R, C1) = P
5310 LET C1 = C1 + 1
5320 GOTO 5290
5330 LET E = E + 1
5340 RETURN
5399 REM  "WEST"
5400 IF K <> 2 THEN 5600
5410 IF C - 1 < 1 THEN 5340
5420 IF B(R, C - 1) = 0 THEN 5340
5430 IF B(R, C - 1) = P THEN 5470
5440 LET C = C - 1
5460 GOTO 5410
5470 IF C = J THEN 5340
5490 IF C1 < C THEN 5330
5500 LET B(R, C1) = P
5510 LET C1 = C1 - 1
5520 GOTO 5490
5599 REM  "SOUTH"
5600 IF K <> 3 THEN 5800
5610 IF R + 1 > 8 THEN 5340
5620 IF B(R + 1, C) = 0 THEN 5340
5630 IF B(R + 1, C) = P THEN 5670
5640 LET R = R + 1
5660 GOTO 5610
5670 IF R = I THEN 5340
5690 IF R1 > R THEN 5330
5700 LET B(R1, C) = P
5710 LET R1 = R1 + 1
5720 GOTO 5690
5799 REM  "NORTH"
5800 REM
5810 IF R - 1 < 1 THEN 5340
5820 IF B(R - 1, C) = 0 THEN 5340
5830 IF B(R - 1, C) = P THEN 5870
5840 LET R = R - 1
5860 GOTO 5810
5870 IF R = I THEN 5340
5890 IF R1 < R THEN 5330
5900 LET B(R1, C) = P
5910 LET R1 = R1 - 1
5920 GOTO 5890
5999 REM  "DIAGONALS"
6000 FOR K = 1 TO 4
6010 LET R = I
6020 LET R1 = I
6030 LET C = J
6040 LET C1 = J
6050 GOSUB 6200
6055 NEXT K
6060 RETURN
6199 REM  "NORTHEAST"
6200 IF K <> 1 THEN 6400
6210 IF C + 1 > 8 THEN 6340
6215 IF R - 1 < 1 THEN 6340
6220 IF B(R - 1, C + 1) = 0 THEN 6340
6230 IF B(R - 1, C + 1) = P THEN 6270
6240 LET C = C + 1
6245 LET R = R - 1
6260 GOTO 6210
6270 IF R = I THEN 6340
6290 IF C1 > C THEN 6330
6300 LET B(R1, C1) = P
6310 LET C1 = C1 + 1
6315 LET R1 = R1 - 1
6320 GOTO 6290
6330 LET E = E + 1
6340 RETURN
6399 REM  "SOUTHWEST"
6400 IF K <> 2 THEN 6600
6410 IF C - 1 < 1 THEN 6340
6415 IF R + 1 > 8 THEN 6340
6420 IF B(R + 1, C - 1) = 0 THEN 6340
6430 IF B(R + 1, C - 1) = P THEN 6470
6440 LET C = C - 1
6445 LET R = R + 1
6460 GOTO 6410
6470 IF R = I THEN 6340
6490 IF C1 < C THEN 6330
6500 LET B(R1, C1) = P
6510 LET C1 = C1 - 1
6515 LET R1 = R1 + 1
6520 GOTO 6490
6599 REM  "SOUTHEAST"
6600 IF K <> 3 THEN 6800
6610 IF R + 1 > 8 THEN 6340
6615 IF C + 1 > 8 THEN 6340
6620 IF B(R + 1, C + 1) = 0 THEN 6340
6630 IF B(R + 1, C + 1) = P THEN 6670
6640 LET C = C + 1
6645 LET R = R + 1
6660 GOTO 6610
6670 IF R = I THEN 6340
6690 IF C1 > C THEN 6330
6700 LET B(R1, C1) = P
6710 LET C1 = C1 + 1
6715 LET R1 = R1 + 1
6720 GOTO 6690
6799 REM  "NORTHWEST"
6800 REM
6810 IF R - 1 < 1 THEN 6340
6815 IF C - 1 < 1 THEN 6340
6820 IF B(R - 1, C - 1) = 0 THEN 6340
6830 IF B(R - 1, C - 1) = P THEN 6870
6840 LET C = C - 1
6845 LET R = R - 1
6860 GOTO 6810
6870 IF R = I THEN 6340
6890 IF C1 < C THEN 6330
6900 LET B(R1, C1) = P
6910 LET C1 = C1 - 1
6915 LET R1 = R1 - 1
6920 GOTO 6890
6999 REM  "SCOREKEEPING"
7000 LET X = 0
7010 LET O = 0
7020 FOR I = 1 TO 8
7030 FOR J = 1 TO 8
7040 IF B(I, J) <> 1 THEN 7060
7050 LET O = O + 1
7060 IF B(I, J) <> 2 THEN 7080
7070 LET X = X + 1
7080 NEXT J
7090 NEXT I
7100 IF X + O <> 64 THEN 7120
7110 LET W = 1
7120 RETURN

