100 CALL CLEAR
200 PRINT TAB(10);"SHENANDOAH": : :"  Across the wide Missouri": : : : : : : : : : : :"programmed by Jim Peterson"
210 PRINT: : :"ARE YOU IN EXTENDED BASIC?": :
220 CALL KEY(3,K,ST)
230 IF ST=0 THEN 220
240 IF K=89 THEN 250
245 BXB=1
246 GOTO 300
250 BXB=3
300 FOR D=1 TO 800
400 NEXT D
500 DIM S(24)
600 RANDOMIZE
700 M$="4218005A007E9981005A24DBC31824243C5A7EA56618003CDB66BD3CA542187E5AC324425A18A51866810081187E423CBDDBC3"
800 R=1
900 FOR CH=40 TO 136 STEP 8
1000 CALL CHAR(CH,SEG$(M$,INT(43*RND+1)*2-1,16))
1100 CALL HCHAR(R,1,CH,64)
1200 R=R+2*ABS(R<23)
1300 NEXT CH
1400 R=0
1500 FOR SET=2 TO 14
1600 X=INT(14*RND+2)
1700 Y=INT(14*RND+2)
1800 IF Y=X THEN 1700
1900 CALL COLOR(SET,X,Y)
2000 NEXT SET
2100 CALL CLEAR
2200 CALL COLOR(1,5,5)
2300 CALL VCHAR(1,29,1,192)
2400 CALL SCREEN(16)
2500 F=262
2600 FOR N=0 TO 23
2700 S(N)=INT(F*1.059463094^N)
2800 CALL SOUND(-999,S(N),0)
2900 NEXT N
3000 DATA 2,1,1,1,6,1,1,1,6,2,6,1,1,1,6,1,8,8,1,10,10,1,11,11,1,15,6,3,13,6,2,13,11
3100 DATA 1,18,10,1,17,17,4,15,11,1,11,15,1,13,13,1,15,11,1,13,13,1,10,10,3,13,10
3200 DATA 2,13,13,2,13,10,1,15,10,1,10,15,2,15,15,1,15,10,1,10,10,1,13,13,1,10,10
3300 DATA 1,8,3,3,6,3,2,6,6,2,8,8,4,10,1,1,10,6,1,6,6,1,10,10,1,15,15
3400 DATA 2,13,1,2,13,5,2,13,10
3500 DATA 1,6,6,1,8,8,6,10,6,2,3,3,2,8,5,1,8,1,3,6,1,7,6,1
3600 A=1
3700 B=1
3800 E=5
3900 FOR J=1 TO 144 STEP 3
4000 CALL HCHAR(A,E,32,T*4)
4100 CALL HCHAR(A+1,E,32,T*4)
4200 CALL HCHAR(B,E,32,T*4)
4300 CALL HCHAR(B+1,E,32,T*4)
4400 READ T,A,B
4500 E=17-T*2
4600 CALL HCHAR(A,E,32+INT((A+1)/2)*8,T*4)
4700 CALL HCHAR(A+1,E,32+INT((A+1)/2)*8,T*4)
4800 CALL HCHAR(B,E,32+INT((B+1)/2)*8,T*4)
4900 CALL HCHAR(B+1,E,32+INT((B+1)/2)*8,T*4)
5000 FOR D=1 TO T*BXB
5100 CALL SOUND(-999,S(A),0,S(B),7)
5200 NEXT D
5300 NEXT J
5400 LL=0
5405 FOR SET=2 TO 14
5410 X=INT(15*RND+2)
5420 Y=INT(15*RND+2)
5430 IF Y=X THEN 5420
5440 CALL COLOR(SET,X,Y)
5450 CALL SOUND(-999,S(6),LL,S(1),LL)
5460 LL=LL+2
5500 NEXT SET
5600 RESTORE
5700 GOTO 3900
