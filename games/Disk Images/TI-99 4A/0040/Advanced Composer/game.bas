100 DATA ADVANCED COMPOSER
110 DATA @1980 TEXAS INSTRUMENTS
130 REM  CASSETTE VERSION 
140 REM  
200 DIM H(71),S(300),F$(7),S$(21)
210 DEF PAD$(X)=SEG$(STR$(X)&"  ",1,3)
215 DEF CTR$(X$)=SEG$("             ",1,13-LEN(X$)/2)&X$
220 DEF AMP(V)=174-3*ASC(SEG$(R$,V,1))
230 DEF BK=ASC(R$)=32
250 CALL CLEAR
251 CALL SCREEN(8)
252 CALL CHAR(64,"3C4299A1A199423C")
270 READ M$,C$
275 PRINT CTR$(M$): : : : :CTR$(C$): : : : : : : : : : :
300 READ X$,R$
310 X$=X$&R$
320 FOR I=0 TO 11
325 H(I)=40000
327 NEXT I
330 H1=2^(1/12)
332 H(12)=110
334 FOR I=13 TO 71
336 H(I)=H(I-1)*H1
338 NEXT I
350 W=1
352 T=38
353 DU=-1500
354 O=23
358 K=3
360 A1=3
362 A2=9
364 A3=6
370 T$="60"
375 K$="C "
380 VN=2
382 GOSUB 5230
385 E=0
387 CS=0
390 DATA 8@6=@?;37=<>@=0@@@@@@@@@@@@@@@@A/6//////@/9@5N:@
395 DATA @@OQ@TVX@.?747=/@IFEP@HJYL@@MKZ@@RCSWGNDUB@@@12
400 RESTORE 490
401 FOR I=1 TO 9
402 CALL COLOR(I,2,8)
403 IF I>6 THEN 408
404 READ R$
406 CALL CHAR(I+95+64*(I=6),R$)
408 NEXT I
490 DATA 00784444784844
491 DATA 007C407840407C
492 DATA 003844447C4444
493 DATA 00784444444478
494 DATA 0044442810101
495 DATA 4040586848506
496 PRINT "  PRESS ENTER TO CONTINUE"
497 CALL KEY(0,KEY,ST)
498 IF ST=0 THEN 497
500 CALL CLEAR
502 CALL VCHAR(1,31,1,96)
505 CALL SCREEN(5)
510 PRINT CTR$(M$): :
512 FOR I=1 TO 4
513 READ C$,R$
514 PRINT " ";C$;TAB(18);R$
516 NEXT I
518 DATA MODE  MANUAL,TEMPO  60,VOICE 1/2,KEY    C
519 DATA WHERE 1,OCTAVE 2,END   0,AMPS   978
520 PRINT:" SONGS IN MEMORY:": :
522 FOR I=1 TO 6
530 PRINT " ";SEG$(F$(I),1,9)
540 NEXT I
550 PRINT: : : : : : :
1000 CALL HCHAR(23,3,32,28)
1005 FOR I=1 TO 5
1010 CALL HCHAR(23,I+3,I+95)
1015 NEXT I
1090 RF=1
1100 CALL COLOR(9,2,8)
1102 CALL SCREEN(5)
1105 CALL KEY(0,CH,ST)
1107 IF ST<1 THEN 1105
1110 CALL COLOR(9,8,8)
1115 C=ASC(SEG$(X$,CH,1))-64
1117 FOR KP=1 TO RF
1120 IF C<1 THEN 1500
1125 GOSUB 1200
1130 GOTO 1900
1200 IF M*(V=0)THEN 1300
1202 N=H(C+K-O*(C>1)-1)
1205 CALL SOUND(200,N,1)
1210 IF M=0 THEN 1245
1225 S(VO+W)=C-O*(C>1)-1
1230 W=W+1
1235 IF W<=WM THEN 1245
1237 W=W-1
1240 CALL SCREEN(7)
1245 RETURN
1300 IF VN<3 THEN 1240
1301 C=C-12*(CH=46)*(C=14)
1302 N2=0
1303 N3=0
1304 IF C=1 THEN 1320
1305 N2=C+38+13*(C>13)
1310 B=W-BM*INT(W/BM)-(BM=1)
1315 N3=C+22-7*(B<>1)+12*((B=BD)+(C>13))
1320 S(V2+W)=N2
1325 S(V3+W)=N3
1330 CALL SOUND(DU,H(S(W)+K),A1,H(N2+K),A2,H(N3+K),A3)
1335 GOTO 1230
1400 RF=POS("!@#$%'&*(",CHR$(CH),1)
1410 GOTO 1100
1500 ERR=5
1501 R=3-C+4*(C<-4)
1503 CO=10-17*(C<-4)
1504 IF C=0 THEN 1100
1510 IF C<-8 THEN 1530
1520 ON-C GOSUB 2000,5000,3000,6300,4100,4000,4200,5100
1522 RF=1
1525 GOTO 1100
1530 ON-8-C GOSUB 6000,6400,6200,7000,7100,7200,8800,8700,1400,5200
1535 IF CS THEN 350
1540 IF(C>-11)*(CH<>9)THEN 1900
1545 RF=1
1550 IF C<-16 THEN 1100 ELSE 1000
1900 CALL KEY(0,ZC,ST)
1910 IF ZC=13 THEN 1090
1920 NEXT KP
1930 GOTO 1100
2000 M=CH=6
2005 R$=SEG$("MANUALRECORD",1-6*M,6)
2010 GOTO 9100
3000 IF CH=4 THEN 3100
3005 W=W+(W-E-1)*(CH=10)
3007 IF CH<>63 THEN 3020
3010 W=1
3020 R=6
3025 CO=10
3030 R$=PAD$(W)
3035 GOTO 9100
3100 L=3
3105 GOSUB 9600
3110 IF(X=0)+(X>WM)THEN 3105
3115 W=X
3120 RETURN
4000 L=2
4010 GOSUB 9200
4020 K=POS(" A BC D EF G",SEG$(R$,1,1),1)-2
4025 IF K<0 THEN 4010
4035 K1=POS("% #",SEG$(R$,2,1),1)
4040 IF K1=0 THEN 4010
4045 K=K+K1-2-12*(R$="A%")
4052 K$=R$
4055 RETURN
4100 L=2
4105 GOSUB 9600
4110 IF X=0 THEN 4105
4115 T=(99-X)*2
4117 T$=R$
4120 RETURN
4200 L=1
4205 GOSUB 9600
4210 IF(X<1)+(X>3)THEN 4205
4215 O=12*X-1
4220 RETURN
5000 L=1
5005 GOSUB 9200
5010 V=POS("A123",SEG$(R$,1,1),1)-1
5015 IF(V<0)+(V>VN)THEN 5005
5017 BM=RF
5018 BD=VAL(SEG$("999344559",BM,1))
5020 V=V+(V=0)*(VN=1)
5025 VO=V2*(V-1)
5035 VF=V-(V=0)
5040 VT=V-VN*(V=0)
5050 RETURN
5100 L=3
5105 GOSUB 9600
5110 A1=AMP(1)
5115 A2=AMP(2)
5120 A3=-AMP(3)*(V3>0)
5145 RETURN
5200 L=1
5205 R=5
5210 CO=12
5215 GOSUB 9200
5220 VN=POS("123",R$,1)
5225 IF VN=0 THEN 5215
5226 IF VN*WM=300 THEN 5145
5227 W=1
5229 GOSUB 6300
5230 WM=300/VN
5232 V2=-WM*(VN>1)
5235 V3=-2*WM*(VN=3)
5240 VO=0
5245 V=1
5247 IF(CH=0)+CS THEN 5035
5250 CALL HCHAR(5,10,49)
5255 CALL GCHAR(7,29,A3)
5260 A3=30+3*(V3>0)*(A3-48)
5290 GOTO 5035
6000 W=W+(CH=60)
6010 IF W=0 THEN 6090
6012 IF V=0 THEN 6100
6015 CALL SOUND(200,H(S(VO+W)+K),1)
6020 W=W-(CH=62)
6030 IF CH>9 THEN 1235
6032 FOR J=VF TO VT
6035 FOR I=W TO E-RF
6037 S(I+VO)=S(I+VO+RF)
6040 NEXT I
6042 NEXT J
6050 RETURN
6090 W=W+1
6095 GOTO 1240
6100 CALL SOUND(300,H(S(W)+K),A1,H(S(V2+W)+K),A2,H(S(V3+W)+K),A3)
6105 GOTO 6020
6200 IF E+RF>=WM THEN 1240
6202 FOR J=VT TO VF
6205 FOR I=E TO W STEP-1
6210 S(I+RF+VO)=S(I+VO)
6215 NEXT I
6220 NEXT J
6230 RETURN
6300 E=W-1
6302 GOSUB 3010
6304 R=7
6305 R$=PAD$(E)
6310 GOTO 9100
6400 IF V=0 THEN 6500
6405 FOR W=W TO E
6410 CALL SOUND(DU,H(S(VO+W)+K),1)
6412 IF CH=3 THEN 6435
6415 CALL KEY(0,ZC,ST)
6420 IF ZC=13 THEN 3020
6425 FOR J=1 TO T
6430 NEXT J
6435 NEXT W
6440 GOTO 3010
6500 FOR W=W TO E
6510 CALL SOUND(DU,H(S(W)+K),A1,H(S(V2+W)+K),A2,H(S(V3+W)+K),A3)
6512 IF CH=3 THEN 6535
6515 CALL KEY(0,ZC,ST)
6520 IF ZC=13 THEN 3020
6525 FOR J=1 TO T
6530 NEXT J
6535 NEXT W
6540 GOTO 3010
7000 R$="LOAD"
7005 GOSUB 9700
7010 IF BK THEN 7290
7012 IF CS THEN 7500
7015 IF N=0 THEN 7005
7020 R$=F$(N)
7022 VN=ASC(SEG$(R$,10,1))
7024 E=ASC(SEG$(R$,11,1))
7026 T=VAL(SEG$(R$,12,3))
7028 K=ASC(SEG$(R$,15,1))
7030 T$=SEG$(R$,16,2)
7035 K$=SEG$(R$,18,2)
7040 A=3*N-2
7042 R=1
7055 CALL HCHAR(5,12,48+VN)
7057 GOSUB 5230
7060 GOSUB 6302
7062 CO=27
7065 R=4
7067 R$=T$
7069 GOSUB 9100
7070 R=5
7072 R$=K$
7075 GOSUB 9100
7079 R=1
7080 FOR J=1 TO VN
7081 VO=(J-1)*WM
7082 CALL HCHAR(5,10,48+J)
7084 FOR I=1 TO E
7086 S(VO+I)=ASC(SEG$(S$(A),R,1))
7087 R=R+1+125*(R=125)
7088 A=A-(R=1)
7090 NEXT I
7092 NEXT J
7095 V=0
7097 CALL HCHAR(5,10,65)
7099 GOTO 5020
7100 R$="SAVE"
7105 GOSUB 9700
7110 IF BK THEN 7290
7112 IF CS THEN 7600
7115 IF A+N=0 THEN 7105
7120 IF N THEN 7130
7122 N=A
7127 R=10+N
7128 CO=4
7129 GOSUB 9100
7130 A=3*N-2
7132 S$(A)=""
7134 S$(A+1)=""
7135 F$(N)=R$&CHR$(VN)&CHR$(E)&PAD$(T)&CHR$(K)&T$&K$
7140 FOR J=1 TO VN
7141 CALL HCHAR(5,10,48+J)
7142 VO=(J-1)*WM
7144 FOR I=1 TO E
7145 S$(A)=S$(A)&CHR$(S(VO+I))
7146 A=A-(LEN(S$(A))=125)
7148 NEXT I
7155 NEXT J
7190 GOTO 7095
7200 R$="UNSAVE"
7205 GOSUB 9700
7210 IF BK THEN 7290
7212 IF CS THEN 7205
7215 IF N=0 THEN 7205
7220 F$(N)=""
7222 R=10+N
7226 CALL HCHAR(R,4,32,10)
7290 RETURN
7500 CALL CLEAR
7505 OPEN #1:"CS1",INPUT,INTERNAL,FIXED 128
7510 INPUT #1:R$
7515 IF R$="EOT" THEN 7580
7520 GOSUB 9730
7525 IF A=0 THEN 7580
7530 F$(A)=R$
7535 J=ASC(SEG$(R$,11,1))
7540 FOR I=1 TO INT((J+124)/125)
7545 INPUT #1:S$(3*A-3+I)
7550 NEXT I
7555 GOTO 7510
7580 GOTO 7670
7600 CALL CLEAR
7605 OPEN #1:"CS1",OUTPUT,INTERNAL,FIXED 128
7610 FOR I=1 TO 6
7615 IF F$(I)="" THEN 7660
7620 PRINT #1:F$(I)
7625 A=3*I-2
7630 PRINT #1:S$(A)
7635 A=A+1
7640 IF S$(A)>"" THEN 7630
7660 NEXT I
7665 PRINT #1:"EOT"
7670 CLOSE #1
7675 RETURN
8700 R$="OKAY TO ZERO"
8705 GOSUB 8900
8710 IF R$<>"Y" THEN 8790
8715 FOR I=1 TO 300
8720 S(I)=0
8725 NEXT I
8790 RETURN
8800 R$="OKAY TO QUIT"
8805 GOSUB 8900
8810 IF R$<>"Y" THEN 8790
8830 CALL SCREEN(8)
8832 CALL CLEAR
8835 STOP
8900 R$=R$&"? N"
8902 GOSUB 9000
8905 CO=I+2
8910 L=1
8915 GOSUB 9200
8930 RETURN
9000 R=23
9010 CO=4
9020 CALL HCHAR(23,3,32,28)
9100 CALL HCHAR(R,CO,32,LEN(R$))
9105 FOR I=1 TO LEN(R$)
9110 CALL HCHAR(R,CO+I-1,ASC(SEG$(R$,I,1)))
9115 NEXT I
9120 RETURN
9200 CALL SCREEN(ERR)
9202 ERR=7
9204 R$=""
9205 ZC=CO
9210 ZE=CO+L-1
9215 CALL GCHAR(R,ZC,ZU)
9220 FOR ZB=0 TO 3
9225 CALL KEY(0,ZK,ZS)
9230 IF ZS<1 THEN 9315
9235 IF ZK<32 THEN 9270
9240 CALL HCHAR(R,ZC,ZK)
9245 ZC=ZC-(ZC<ZE)
9250 CALL GCHAR(R,ZC,ZU)
9255 CALL KEY(0,ZK,ZS)
9260 CALL HCHAR(R,ZC,30)
9265 IF ZS=1 THEN 9235 ELSE 9220
9270 CALL HCHAR(R,ZC,ZU)
9275 IF ZK=13 THEN 9330
9280 ZC=ZC-(ZC>COL)*(ZK=8)+(ZC<ZE)*(ZK=9)
9285 IF ZK<>7 THEN 9215
9300 CALL HCHAR(R,CO,32,L)
9305 GOTO 9205
9315 CALL HCHAR(R,ZC,30+(30-ZU)*(ZB>1))
9320 NEXT ZB
9325 GOTO 9220
9330 FOR ZC=CO TO ZE
9335 CALL GCHAR(R,ZC,ZU)
9340 R$=R$&CHR$(ZU)
9345 NEXT ZC
9347 CALL SCREEN(5)
9350 RETURN
9600 GOSUB 9200
9602 X=0
9610 FOR I=1 TO L
9615 C$=SEG$(R$,I,1)
9620 IF(C$=" ")*(CH>1)THEN 9630
9625 IF(C$<"0")+(C$>"9")THEN 9600
9627 X=10*X+VAL(C$)
9630 NEXT I
9690 RETURN
9700 IF ERR=7 THEN 9710
9702 GOSUB 9000
9705 CO=I+4
9707 L=9
9710 GOSUB 9200
9711 CS=R$="CS1      "
9712 IF BK+CS THEN 9790
9730 A=0
9732 FOR N=1 TO 7
9734 IF R$=SEG$(F$(N),1,9)THEN 9790
9736 A=A+N*(A=0)*(F$(N)="")
9738 NEXT N
9740 N=0
9790 RETURN
