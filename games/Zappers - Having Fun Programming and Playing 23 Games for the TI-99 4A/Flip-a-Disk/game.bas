100 REM FLIP-A-DISK
110 CALL SCREEN(13)
120 CALL CLEAR
130 RESTORE
140 T$="003C7E7E7E7E3C00"
150 CALL CHAR(128,T$)
160 CALL CHAR(136,T$)
170 CALL CHAR(137,"0000001818000000")
180 CALL COLOR(13,16,1)
190 PRINT "   SETTING UP -- PLEASE             BE PATIENT": : : : : : : : :
200 DIM A(10,10),B(10,10),C(10,10),I4(8),J4(8),CASE(64)
210 FOR X=1 TO 10
220 FOR Y=1 TO 10
230 A(X,Y)=0
240 B(X,Y)=0
250 NEXT Y
260 NEXT X
270 FOR X=1 TO 5
280 FOR Y=1 TO 5
290 READ C(X,Y)
300 C(11-X,11-Y)=C(X,Y)
310 C(X,11-Y)=C(X,Y)
320 C(11-X,Y)=C(X,Y)
330 NEXT Y
340 NEXT X
350 DATA 0,0,0,0,0,0,9,6,7,5,0,6,-8,-4,-3,0,7,-4,4,0,0,5,-3,0,0
360 FOR X=1 TO 64
370 CASE(X)=1
380 NEXT X
390 FOR X=2 TO 7
400 CASE(X)=2
410 CASE(X+56)=2
420 CASE(8*X-7)=3
430 CASE(8*X)=3
440 NEXT X
450 BL=-1
460 C1=2
470 H1=2
480 N1=4
490 Z=0
500 WH=1
510 D$=CHR$(128)&CHR$(137)&CHR$(136)
520 FOR X=1 TO 8
530 READ I4(X),J4(X)
540 NEXT X
550 DATA 0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1
560 A(5,5)=WH
570 A(6,6)=WH
580 A(5,6)=BL
590 A(6,5)=BL
600 FOR I=4 TO 7
610 FOR J=4 TO 7
620 B(I,J)=1
630 NEXT J
640 NEXT I
650 B(5,5)=2
660 B(5,6)=2
670 B(6,5)=2
680 B(6,6)=2
690 INPUT "DO YOU WANT BLACK OR WHITE  (B OR W): ":QUERY$
700 COMP=1
710 HUMAN=-1
720 IF QUERY$="W" THEN 770
730 IF QUERY$<>"B" THEN 690
740 COMP=-1
750 HUMAN=1
760 GOSUB 2100
770 INPUT "DO YOU WANT TO GO FIRST?    (Y OR N) ":QUERY$
780 IF SEG$(QUERY$,1,1)="N" THEN 820
790 IF SEG$(QUERY$,1,1)<>"Y" THEN 770
800 PRINT :
810 GOTO 1270
820 B1=-10
830 I3=0
840 J3=0
850 T1=COMP
860 T2=HUMAN
870 I=2
880 FOR J=2 TO 9
890 IF B(I,J)<>1 THEN 1010
900 U=-1
910 GOSUB 1850
920 IF S1=0 THEN 1010
930 C9=C(I,J)+.1*S1
940 IF C9<B1 THEN 1010
950 IF C9>B1 THEN 980
960 R=INT(RND*10)
970 IF R<5 THEN 1010
980 B1=C9
990 I3=I
1000 J3=J
1010 NEXT J
1020 I=I+1
1030 IF I<10 THEN 880
1040 IF B1>-10 THEN 1090
1050 PRINT "I HAVE TO FORFEIT MY MOVE"
1060 IF Z=1 THEN 1710
1070 Z=1
1080 GOTO 1270
1090 Z=0
1100 PRINT "    I MOVE TO [";STR$(I3-1);", ";CHR$(63+J3);"]"
1110 I=I3
1120 J=J3
1130 U=1
1140 B(I,J)=2
1150 GOSUB 1850
1160 GOSUB 2210
1170 C1=C1+S1+1
1180 H1=H1-S1
1190 N1=N1+1
1200 PRINT :"THAT GIVES ME";S1;"PIECE";
1210 IF S1<=1 THEN 1240
1220 PRINT "S":
1230 PRINT
1240 GOSUB 2100
1250 IF H1=0 THEN 1710
1260 IF N1=64 THEN 1710
1270 T1=HUMAN
1280 T2=COMP
1290 PRINT "PLEASE ENTER YOUR MOVE      (ROW, COLUMN): [";
1300 CALL KEY(3,KEY,STATUS)
1310 IF STATUS=0 THEN 1300
1320 IF (KEY<48)+(KEY>56)THEN 1300
1330 PRINT CHR$(KEY);", ";
1340 I=KEY-48
1350 CALL KEY(3,KEY,STATUS)
1360 IF STATUS=0 THEN 1350
1370 IF KEY=ASC("Q")THEN 1710
1380 IF (KEY<65)+(KEY>73)THEN 1350
1390 PRINT CHR$(KEY);"]"
1400 IF I<>0 THEN 1460
1410 INPUT "ARE YOU FORFEITING YOUR     TURN? ":QUERY$
1420 IF SEG$(QUERY$,1,1)<>"Y" THEN 1290
1430 IF Z=1 THEN 1710
1440 Z=1
1450 GOTO 820
1460 J=KEY-63
1470 I=I+1
1480 IF A(I,J)=0 THEN 1510
1490 PRINT : :"SORRY, THAT SQUARE IS       OCCUPIED, TRY AGAIN."::
1500 GOTO 1290
1510 U=-1
1520 GOSUB 1850
1530 IF S1>0 THEN 1560
1540 PRINT : :"SORRY, THAT DOES NOT FLANK AROW, TRY AGAIN": :
1550 GOTO 1290
1560 Z=0
1570 PRINT : :"THAT GIVES YOU";S1;"PIECE";
1580 IF S1<=1 THEN 1600
1590 PRINT "S":
1600 U=1
1610 GOSUB 2210
1620 GOSUB 2280
1630 B(I,J)=2
1640 GOSUB 1850
1650 H1=H1+S1+1
1660 C1=C1-S1
1670 N1=N1+1
1680 GOSUB 2100
1690 IF (C1=0)+(N1=64)THEN 1710
1700 GOTO 820
1710 PRINT "YOU HAVE";H1;"PIECES, AND":"I HAVE";C1;"PIECES"
1720 IF H1=C1 THEN 1780
1730 IF H1>C1 THEN 1800
1740 PRINT "SORRY OLD CHAP! I'M AFRAID  I WON THAT ONE"
1750 IF C1-H1<20 THEN 1810
1760 PRINT "WHY DON'T YOU TAKE UP       TENNIS OR SOMETHING?"
1770 GOTO 1810
1780 PRINT : :"IT'S A TIE, BY GOLLY! WELL, WE BOTH KNOW WE'RE THE BEST"
1790 GOTO 1810
1800 PRINT "YOU WON, YOU SON OF A GUN!":"I DON'T WANT TO PLAY WITH   YOU ANYMORE!": :
1810 INPUT "ALL RIGHT, WOULD YOU LIKE TOPLAY ANOTHER GAME?":QUERY$
1820 IF SEG$(QUERY$,1,1)="Y" THEN 120
1830 IF SEG$(QUERY$,1,1)<>"N" THEN 1810
1840 END
1850 S1=0
1860 FOR K=1 TO 8
1870 I5=I4(K)
1880 J5=J4(K)
1890 I6=I+I5
1900 J6=J+J5
1910 S3=0
1920 IF A(I6,J6)<>T2 THEN 2080
1930 S3=S3+1
1940 I6=I6+I5
1950 J6=J6+J5
1960 IF A(I6,J6)=T1 THEN 1990
1970 IF A(I6,J6)=0 THEN 2080
1980 GOTO 1930
1990 S1=S1+S3
2000 IF U<>1 THEN 2080
2010 I6=I
2020 J6=J
2030 FOR K1=0 TO S3
2040 A(I6,J6)=T1
2050 I6=I6+I5
2060 J6=J6+J5
2070 NEXT K1
2080 NEXT K
2090 RETURN
2100 REM PRINT THE BOARD
2110 PRINT : :"    A B C D E F G H"
2120 FOR I=2 TO 9
2130 PRINT I-1;
2140 FOR J=2 TO 9
2150 PRINT " ";SEG$(D$,A(I,J)+2,1);
2160 NEXT J
2170 PRINT
2180 NEXT I
2190 PRINT : :
2200 RETURN
2210 FOR K=1 TO 8
2220 I5=I4(K)
2230 J5=J4(K)
2240 IF B(I+I5,J+J5)>0 THEN 2260
2250 B(I+I5,J+J5)=1
2260 NEXT K
2270 RETURN
2280 SUBS=8*(I-2)+J-1
2290 ON CASE(SUBS)GOTO 2300,2470,2310
2300 RETURN
2310 IF I=3 THEN 2400
2320 IF (A(I-2,J)=HUMAN)+(A(I+1,J)=COMP) THEN 2370
2330 C(I-1,J)=-4
2340 IF I<>4 THEN 2380
2350 C(I-1,J)=-8
2360 GOTO 2380
2370 C(I-1,J)=8
2380 IF I<>8 THEN 2400
2390 RETURN
2400 IF (A(I+2,J)=HUMAN)+(A(I-1,J)=COMP) THEN 2450
2410 C(I+1,J)=-4
2420 IF I<>7 THEN 2440
2430 C(I+1,J)=-8
2440 RETURN
2450 C(I+1,J)=8
2460 RETURN
2470 IF J=3 THEN 2560
2480 IF (A(I,J-2)=HUMAN)+(A(I,J+1)=COMP) THEN 2530
2490 C(I,J-1)=-4
2500 IF J<>4 THEN 2540
2510 C(I,J-1)=-8
2520 GOTO 2540
2530 C(I,J-1)=8
2540 IF J<>8 THEN 2560
2550 RETURN
2560 IF (A(I,J+2)=HUMAN)+(A(I,J-1)=COMP) THEN 2610
2570 C(I,J+1)=-4
2580 IF I<>7 THEN 2600
2590 C(I,J+1)=-8
2600 RETURN
2610 C(I,J+1)=8
2620 RETURN
