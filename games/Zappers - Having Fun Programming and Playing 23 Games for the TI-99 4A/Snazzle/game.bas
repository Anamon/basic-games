100 REM SNAZZLE
110 RANDOMIZE
120 DIM S(100,2),TABLE(26)
130 TABLE(5)=1
140 TABLE(4)=2
150 TABLE(24)=3
160 TABLE(19)=4
170 FOR LEVEL=1 TO 3
180 CALL CLEAR
190 PRINT "   YOU ARE NOW ENTERING": : : : : : : : : :
200 PRINT "L    EEEE V  V  EEEE L"
210 PRINT "L    E    V  V  E    L"
220 PRINT "L    EEE  V  V  EEE  L"
230 PRINT "L    E     VV   E    L"
240 PRINT "LLLL EEEE  VV   EEEE LLLL"
250 PRINT : : :TAB(11);"# ";LEVEL
260 FOR T=1 TO 1000
270 NEXT T
280 CALL CLEAR
290 SCORE=0
300 FOR I=1 TO L
310 S(I,1)=0
320 S(I,2)=0
330 NEXT I
340 ON LEVEL GOSUB 1150,1160,1200
350 X=INT(RND*28)+2
360 Y=INT(RND*22)+2
370 CALL GCHAR(Y,X,T)
380 IF T<>32 THEN 350
390 D=INT(RND*4)+1
400 RC=31
410 CALL CHAR(128,"FFFFFFFFFFFFFFFF")
420 CALL COLOR(13,5,1)
430 CALL CHAR(136,"FFFFFFFFFFFFFFFF")
440 CALL CHAR(96,"00FF7E4C4C7EFF00")
450 CALL COLOR(14,7,1)
460 CALL HCHAR(1,1,128,RC)
470 CALL HCHAR(24,1,128,RC)
480 CALL VCHAR(1,1,128,24)
490 CALL VCHAR(1,RC,128,24)
500 L=4
510 GOSUB 1090
520 REM
530 FOR I=0 TO L
540 IF S(I,2)=0 THEN 560
550 CALL HCHAR(S(I,2),S(I,1),32)
560 S(I,1)=X
570 S(I,2)=Y
580 CALL GCHAR(Y,X,T)
590 IF T<>32 THEN 790
600 CALL HCHAR(Y,X,136)
610 CALL KEY(3,KEY,STATUS)
620 IF STATUS THEN 740
630 ON D GOSUB 660,680,700,720
640 NEXT I
650 GOTO 530
660 Y=Y-1
670 RETURN
680 X=X+1
690 RETURN
700 Y=Y+1
710 RETURN
720 X=X-1
730 RETURN
740 IF (KEY<65)+(KEY>90)THEN 630
750 KEY=KEY-64
760 IF TABLE(KEY)=0 THEN 630
770 D=TABLE(KEY)
780 GOTO 630
790 REM
800 IF (T=128)+(T=136)THEN 1010
810 CALL SOUND(50,1700,0)
820 CALL SOUND(50,892,0)
830 L=L+3
840 SCORE=SCORE+1
850 IF SCORE=10 THEN 920
860 SCORE$=STR$(SCORE)
870 FOR J=1 TO LEN(SCORE$)
880 CALL HCHAR(1,J+10,ASC(SEG$(SCORE$,J,1)))
890 NEXT J
900 GOSUB 1090
910 GOTO 600
920 FOR I=1 TO 16
930 CALL SCREEN(I)
940 CALL SOUND(50,I*110,0)
950 NEXT I
960 NEXT LEVEL
970 CALL CLEAR
980 PRINT "CONGRATULATIONS!"
990 PRINT " YOU HAVE WON": : : : : :
1000 END
1010 FOR I=4 TO 1 STEP -.25
1020 CALL SOUND(50,I*110,0)
1030 CALL SCREEN(15)
1040 CALL SCREEN(2)
1050 NEXT I
1060 FOR T=1 TO 1000
1070 NEXT T
1080 END
1090 RX=INT(RND*(RC-2))+2
1100 RY=INT(RND*22)+2
1110 CALL GCHAR(RY,RX,T)
1120 IF T<>32 THEN 1090
1130 CALL HCHAR(RY,RX,96)
1140 REM
1150 RETURN
1160 CALL HCHAR(4,4,128,22)
1170 CALL HCHAR(12,12,128,6)
1180 CALL HCHAR(20,4,128,22)
1190 RETURN
1200 FOR I=5 TO 25 STEP 5
1210 CALL VCHAR(7,I,128,17)
1220 NEXT I
1230 CALL HCHAR(4,12,128,26)
1240 RETURN
