100 REM QUBIC
110 CALL CLEAR
120 Z9=0
130 PRINT TAB(5);"THIS IS THE GAME OF": :TAB(8);" -- QUBIC -- ": :TAB(7);"3-D TIC-TAC-TOE": : : : : : : :
140 INPUT "DO YOU WANT INSTRUCTIONS?   (Y OR N): ":QUERY$
150 IF SEG$(QUERY$,1,1)="Y" THEN 2110
160 IF SEG$(QUERY$,1,1)="N" THEN 190
170 PRINT "PLEASE TYPE Y OR N,         NOT ";QUERY$
180 GOTO 130
190 DIM X(64),L(76),M(76,4),Y(16)
200 DEF FNL(I)=X(M(I,1))+X(M(I,2))+X(M(I,3))+X(M(I,4))
210 DEF FNM(M)=M+110+6*INT((M-1)/4)+60*INT((M-1)/16)
220 FOR II=1 TO 16
230 READ Y(II)
240 NEXT II
250 FOR II=1 TO 76
260 FOR JJ=1 TO 4
270 READ M(II,JJ)
280 NEXT JJ
290 NEXT II
300 INPUT "DO YOU WANT TO MOVE FIRST   (Y/N) ":QUERY$
310 CALL CLEAR
320 IF SEG$(QUERY$,1,1)="Y" THEN 360
330 IF SEG$(QUERY$,1,1)="N" THEN 450
340 PRINT "PLEASE TYPE Y OR N,         NOT ";QUERY$
350 GOTO 300
360 GOSUB 1960
370 INPUT "ENTER YOUR MOVE ":K1,K2,K3
380 GOSUB 1920
390 IF (K1<1)+(K2<1)+(K3<1)+(K1>4)+(K2>4)+(K3>4)+(K1<>INT(K1))+(K2<>INT(K2))+(K3<>INT(K3))THEN 370
400 MM=16*K1+4*K2+K3-20
410 IF X(MM)=0 THEN 440
420 PRINT "THAT SQUARE IS TAKEN.       PLEASE TRY AGAIN"
430 GOTO 370
440 X(MM)=1
450 GOSUB 1260
460 T=0
470 S=0
480 FOR I=1 TO 76
490 IF L(I)<>4 THEN 560
500 PRINT "CONGRATULATIONS!"
510 PRINT FNM(M(I,1));FNM(M(I,2));FNM(M(I,3));FNM(M(I,4))
520 PRINT
530 PRINT "FINAL POSITION"
540 GOSUB 1960
550 GOTO 1160
560 IF L(I)<>15 THEN 580
570 S=I
580 IF L(I)<>3 THEN 600
590 T=I
600 NEXT I
610 IF S=0 THEN 700
620 I=S
630 FOR J=1 TO 4
640 MM=M(I,J)
650 IF X(MM)>0 THEN 690
660 X(MM)=5
670 PRINT "MACHINE MOVES TO ";FNM(MM): :
680 GOTO 520
690 NEXT J
700 IF T=0 THEN 1010
710 I=T
720 FOR J=1 TO 4
730 MM=M(I,J)
740 IF X(MM)>0 THEN 780
750 X(MM)=5
760 PRINT "NICE TRY -- I WILL MOVE TO ";FNM(MM)
770 GOTO 360
780 NEXT J
790 FOR I=1 TO 76
800 LL=FNL(I)
810 IF INT(LL)<>2 THEN 870
820 IF LL>2 THEN 1700
830 FOR J=1 TO 4
840 IF X(M(I,J))>0 THEN 860
850 X(M(I,J))=.125
860 NEXT J
870 NEXT I
880 GOSUB 1260
890 FOR I=1 TO 76
900 IF (L(I)=.5)+(L(I)=.375)THEN 1800
910 NEXT I
920 GOTO 1380
930 FOR Z=1 TO 16
940 IF X(Y(Z))=0 THEN 970
950 NEXT Z
960 GOTO 1300
970 MM=Y(Z)
980 X(MM)=5
990 PRINT "I WILL MOVE TO ";FNM(MM): :
1000 GOTO 360
1010 FOR I=1 TO 76
1020 LL=FNL(I)
1030 IF INT(LL)<>10 THEN 1090
1040 IF LL>10 THEN 1700
1050 FOR J=1 TO 4
1060 IF X(M(I,J))>0 THEN 1080
1070 X(M(I,J))=.125
1080 NEXT J
1090 NEXT I
1100 GOSUB 1260
1110 FOR I=1 TO 76
1120 IF (L(I)=.5)+(L(I)=5.375)THEN 1800
1130 NEXT I
1140 GOSUB 1920
1150 GOTO 790
1160 Z9=Z9+1
1170 IF Z9=2 THEN 2090
1180 INPUT "ANOTHER GAME? ":QUERY$
1190 IF SEG$(QUERY$,1,1)="Y" THEN 300
1200 IF SEG$(QUERY$,1,1)="N" THEN 1230
1210 PRINT "PLEASE TYPE Y OR N,        NOT ";QUERY$
1220 GOTO 1180
1230 END
1240 REM
1250 REM
1260 FOR S=1 TO 76
1270 L(S)=FNL(S)
1280 NEXT S
1290 RETURN
1300 FOR MM=1 TO 64
1310 IF X(MM)>0 THEN 1350
1320 X(MM)=5
1330 PRINT "I LIKE";FNM(MM)
1340 GOTO 360
1350 NEXT MM
1360 PRINT "THE GAME IS A DRAW."
1370 GOTO 1160
1380 FOR K=1 TO 72 STEP 4
1390 P=INT(L(K))+INT(L(K+1))+INT(L(K+2))+INT(L(K+3))
1400 IF (P=4)+(P=9)THEN 1440
1410 NEXT K
1420 GOSUB 1920
1430 GOTO 930
1440 S=.125
1450 FOR I=K TO K+3
1460 GOTO 1810
1470 NEXT I
1480 S=0
1490 GOTO 1450
1500 DATA 1,49,52,4,13,61,64,16,22,39,23,38,26,42,27,43
1510 DATA 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20
1520 DATA 21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38
1530 DATA 39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56
1540 DATA 57,58,59,60,61,62,63,64
1550 DATA 1,17,33,49,2,18,34,50,3,19,35,41,4,20,36,52
1560 DATA 5,21,37,53,6,22,38,54,7,23,39,55,8,24,40,56
1570 DATA 9,25,41,57,10,26,42,58,11,27,43,59,12,28,44,60
1580 DATA 13,29,45,61,14,30,46,62,15,31,47,63,16,32,48,64
1590 DATA 1,5,9,13,17,21,25,29,33,37,41,45,49,53,57,61
1600 DATA 2,6,10,14,18,22,26,30,34,38,42,46,50,54,58,62
1610 DATA 3,7,11,15,19,23,27,31,35,39,43,47,51,55,59,63
1620 DATA 4,8,12,16,20,24,28,32,36,40,44,48,52,56,60,64
1630 DATA 1,6,11,16,17,22,27,32,33,38,43,48,49,54,59,64
1640 DATA 13,10,7,4,29,26,23,20,45,42,39,36,61,58,55,52
1650 DATA 1,21,41,61,2,22,42,62,3,23,43,63,4,24,44,64
1660 DATA 49,37,25,13,50,38,26,14,51,39,27,15,52,40,28,16
1670 DATA 1,18,35,52,5,22,39,56,9,26,43,60,13,30,47,64
1680 DATA 49,34,19,4,53,38,23,8,57,42,27,12,61,46,31,16
1690 DATA 1,22,43,64,16,27,38,49,4,23,42,16,13,26,39,52
1700 FOR J=1 TO 4
1710 IF X(M(I,J))<>.125 THEN 1790
1720 X(M(I,J))=5
1730 IF LL<5 THEN 1760
1740 PRINT "LET'S SEE YOU GET OUT OF    THIS! I MOVE TO";
1750 GOTO 1770
1760 PRINT "YOU FOX! JUST IN THE NICK   OF TIME I MOVE TO";
1770 PRINT FNM(M(I,J))
1780 GOTO 360
1790 NEXT J
1800 S=.125
1810 IF I-INT(I/4)*4>1 THEN 1840
1820 A=1
1830 GOTO 1850
1840 A=2
1850 FOR J=A TO 5-A STEP 5-2*A
1860 IF X(M(I,J))=S THEN 1890
1870 NEXT J
1880 GOTO 1470
1890 X(M(I,J))=5
1900 PRINT "I TAKE";
1910 GOTO 1770
1920 FOR I=1 TO 64
1930 X(I)=INT(X(I))
1940 NEXT I
1950 RETURN
1960 A$="O.X"
1970 FOR I1=1 TO 13 STEP 4
1980 FOR J1=I1 TO I1+48 STEP 16
1990 FOR K1=J1 TO J1+3
2000 LL=ABS(X(K1)-2)
2010 PRINT SEG$(A$,LL,1);
2020 NEXT K1
2030 PRINT " ";
2040 NEXT J1
2050 PRINT
2060 NEXT I1
2070 PRINT
2080 RETURN
2090 STOP
2100 END
2110 REM INSTRUCTIONS
2120 PRINT : :"QUBIC IS A THREE DIMENSIONALVERSION OF TIC-TAC-TOE. THE OBJECT OF THE GAME IS TO GET";
2130 PRINT "FOUR IN A ROW. COORDINATES":"ARE SPECIFIED AS LEVEL, ROW AND COLUMN WHERE EACH IS A  NUMBER FROM 1";
2140 PRINT "TO 4. PICTURE":"THE LEVELS AS BEING STACKED ON TOP OF EACH OTHER WITH   THE LEFTMOST AT THE BOTTOM."
2150 GOTO 190
