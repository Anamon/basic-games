100 REM TIC TAC TOE
110 CALL CLEAR
120 PRINT "WELCOME TO ...": : : : : : : :
130 CALL SOUND(2000,220,0)
140 CALL SOUND(2000,328,0)
150 CALL SOUND(2000,440,0)
160 CALL SOUND(400,560,0,417,0,692,0)
170 CALL SOUND(1000,560,0,417,0,656,0)
180 PRINT TAB(23);"TOE": : :
190 PRINT TAB(13);"TAC": : :
200 PRINT TAB(3);"TIC": : : : :
210 OPTION BASE 1
220 DIM BOARD(3,3),PTS(8,3,2),PRIO(3,3),CASE(4)
230 CASE(1)=6
240 CASE(2)=1
250 CASE(3)=5
260 CASE(4)=2
270 FOR I=1 TO 3
280 FOR J=1 TO 3
290 BOARD(I,J)=0
300 READ PRIO(I,J)
310 NEXT J
320 NEXT I
330 DATA 2,1,2,1,3,1,2,1,2
340 FOR J=1 TO 8
350 FOR I=1 TO 3
360 READ PTS(J,I,1),PTS(J,I,2)
370 NEXT I
380 NEXT J
390 DATA 1,1,2,1,3,1,1,2,2,2,3,2,1,3,2,3
400 DATA 3,3,1,1,1,2,1,3,2,1,2,2,2,3,3,1
410 DATA 3,2,3,3,1,1,2,2,3,3,3,1,2,2,1,3
420 INPUT "WANT X'S OR O'S? ":QUERY$
430 D$="X.O"
440 IF SEG$(QUERY$,1,1)="X" THEN 470
450 IF SEG$(QUERY$,1,1)<>"O" THEN 420
460 D$="O.X"
470 INPUT "SHALL I GO FIRST (Y/N)? ":QUERY$
480 COUNT=-1
490 IF QUERY$="Y" THEN 640
500 IF QUERY$="N" THEN 530
510 PRINT :"TYPE Y OR N, NOT ";QUERY$;"!"
520 GOTO 470
530 GOSUB 1120
540 PRINT : :"ENTER YOUR MOVE: ";
550 CALL KEY(3,KEY,STATUS)
560 IF STATUS=0 THEN 550
570 IF (KEY<49)+(KEY>57)THEN 550
580 MOVE=KEY-48
590 X=INT((MOVE-1)/3)+1
600 Y=MOVE-X*3+3
610 IF BOARD(X,Y)<>0 THEN 550
620 PRINT CHR$(KEY)
630 BOARD(X,Y)=1
640 FOR T=1 TO 4
650 FOR I=1 TO 8
660 SUM=0
670 FOR J=1 TO 3
680 SUM=SUM+BOARD(PTS(I,J,1),PTS(I,J,2))
690 NEXT J
700 X=-(CASE(T)=SUM+3)*CASE(T)
710 IF X=6 THEN 1270
720 IF X=1 THEN 900
730 IF X=2 THEN 950
740 IF X<>5 THEN 770
750 GOSUB 1060
760 GOTO 530
770 NEXT I
780 NEXT T
785 MX=0
790 FOR I=1 TO 3
800 FOR J=1 TO 3
810 IF BOARD(I,J)<>0 THEN 860
820 IF PRIO(I,J)<=MX THEN 860
830 MX=PRIO(I,J)
840 X=I
850 Y=J
860 NEXT J
870 NEXT I
880 BOARD(X,Y)=-1
890 GOTO 530
900 GOSUB 1060
910 GOSUB 1120
920 PRINT : :"I WIN!!!": : : :
930 PRINT "BETTER LUCK NEXT TIME."
940 END
950 MX=0
960 FOR J=1 TO 3
970 IF BOARD(PTS(I,J,1),PTS(I,J,2))<>0 THEN 1020
980 IF PRIO(PTS(I,J,1),PTS(I,J,2))<=MX THEN 1020
990 X=PTS(I,J,1)
1000 Y=PTS(I,J,2)
1010 MX=PRIO(PTS(I,J,1),PTS(I,J,2))
1020 NEXT J
1030 IF MX=0 THEN 770
1040 BOARD(X,Y)=-1
1050 GOTO 530
1060 FOR J=1 TO 3
1070 IF BOARD(PTS(I,J,1),PTS(I,J,2))=0 THEN 1100
1080 NEXT J
1090 STOP
1100 BOARD(PTS(I,J,1),PTS(I,J,2))=-1
1110 RETURN
1120 REM DISPLAY THE BOARD
1130 COUNT=COUNT+1
1140 IF COUNT=4 THEN 1290
1150 PRINT : :
1160 FOR I=1 TO 3
1170 FOR J=1 TO 3
1180 K=I*3-3+J
1190 IF BOARD(I,J)=0 THEN 1220
1200 PRINT " ";SEG$(D$,2-BOARD(I,J),1);" ";
1210 GOTO 1230
1220 PRINT K;
1230 NEXT J
1240 PRINT
1250 NEXT I
1260 RETURN
1270 PRINT : : :"YOU WIN!!"
1280 END
1290 PRINT : :"THE GAME IS A TIE."
