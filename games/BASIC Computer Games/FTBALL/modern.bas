5 CLS: COLOR 12
10 PRINT TAB(37); "FTBALL"
20 PRINT TAB(31); "Creative Computing"
25 PRINT TAB(29); "Morristown, New Jersey"
30 PRINT: PRINT: RANDOMIZE TIMER: COLOR 15
220 PRINT "This is Dartmouth Championship Football.": PRINT: COLOR 14
230 PRINT "You will quarterback Dartmouth.  Call plays as follows:"
235 PRINT: COLOR 13
240 PRINT , "1 = Simple Run", "5 = Punt"
243 PRINT , "2 = Tricky Run", "6 = Quick Kick"
246 PRINT , "3 = Short Pass", "7 = Place Kick"
250 PRINT , "4 = Loss Pass": COLOR 15
260 PRINT
270 COLOR 10: PRINT "Choose your opponent";
280 INPUT O$(1): COLOR 15
290 O$(0) = "Dartmouth"
300 PRINT
310 LET S(0) = 0: LET S(1) = 0
320 REM
330 DIM L$(20)
340 FOR I = 1 TO 20: READ L$(I): NEXT I
350 DATA "kick","receive","yard ","Run back for","Ball on "
360 DATA "yard line.","Simple run","Tricky run","Short pass"
370 DATA "Long pass","Punt","Quick kick","Place kick","loss."
380 DATA "No gain.","gain.","Touchdown","Touchback","Safety!!!"
385 DATA "JUNK"
390 LET P = INT(RND(1) * 2)
400 PRINT O$(P); " won the toss!"
410 'DEF FNF(X)=1-2*P
420 'DEF FNG(Z)=P*(X1-X)+(1-P)*(X-X1)
430 IF P = 0 THEN 470
440 PRINT O$(1); " elects to receive."
450 PRINT
460 GOTO 580
470 COLOR 10: PRINT "Do you elect to kick or receive (K/R)";
480 INPUT A$: COLOR 15
485 IF LEFT$(A$, 1) = "K" OR LEFT$(A$, 1) = "k" THEN A$ = "kick"
486 IF LEFT$(A$, 1) = "R" OR LEFT$(A$, 1) = "r" THEN A$ = "receive"
490 PRINT
500 FOR E = 1 TO 2
510 IF A$ = L$(E) THEN 550
520 NEXT E
530 PRINT "Incorrect answer -- please select 'K' or 'R'";
540 GOTO 480
550 IF E = 2 THEN 580
560 LET P = 1
580 LET X = 40 + (1 - P) * 20
590 LET Y = INT(200 * (RND(1) - .5) ^ 3 + 55)
600 PRINT Y; L$(3); "kickoff."
610 LET X = X - (1 - 2 * P) * Y
620 IF ABS(X - 50) >= 50 THEN 700
630 LET Y = INT(50 * RND(1) ^ 2) + (1 - P) * INT(50 * RND(1) ^ 4)
640 LET X = X + (1 - 2 * P) * Y
650 IF ABS(X - 50) >= 50 THEN 655
651 PRINT Y; L$(3); "runback."
652 GOTO 720
655 PRINT L$(4);
660 GOTO 2600
700 PRINT "Touchback for "; O$(P); "."
710 LET X = 20 + P * 60
720 REM FIRST DOWN
730 GOSUB 800
740 LET X1 = X
750 LET D = 1
760 IF P = 1 THEN COLOR 11: ELSE COLOR 13
765 PRINT: PRINT "*** First down for "; O$(P); " ***": COLOR 15
780 PRINT
790 GOTO 860
800 REM PRINT POSITION
810 IF X > 50 THEN 840
820 PRINT L$(5); O$(0); X; L$(6)
830 GOTO 850
840 PRINT L$(5); O$(1); 100 - X; L$(6)
850 RETURN
860 REM NEW PLAY
870 LET T = T + 1
880 IF T = 30 THEN 1060
890 IF T < 50 THEN 940
900 IF RND(1) > .2 THEN 940
910 PRINT "End of game!!!"
920 PRINT "Final score:  ";: COLOR 11: PRINT O$(0); ":"; S(0); "  ";: COLOR 13: PRINT O$(1); ":"; S(1): COLOR 15
930 END
940 IF P = 1 THEN 1870
950 COLOR 10: PRINT "Next play (1-7)";
960 INPUT Z: COLOR 15
970 IF Z <> INT(Z) THEN 990
980 IF ABS(Z - 4) <= 3 THEN 1010
990 PRINT "Illegal play number -- retry";
1000 GOTO 960
1010 LET F = 0
1020 PRINT L$(Z + 6); ".  ";
1030 LET R = RND(1) * (.98 + (1 - 2 * P) * .02)
1040 LET R1 = RND(1)
1050 ON Z GOTO 1110, 1150, 1260, 1480, 1570, 1570, 1680
1060 REM  JEAN'S SPECIAL
1070 IF RND(1) > 1 / 3 THEN 940
1080 COLOR 12: PRINT "Game delayed.  Dog on field.": COLOR 15
1090 PRINT
1100 GOTO 940
1110 REM  SIMPLE RUN
1120 LET Y = INT(24 * (R - .5) ^ 3 + 3)
1130 IF RND(1) < .05 THEN 1180
1140 GOTO 2190
1150 REM  TRICKY RUN
1160 LET Y = INT(20 * R - 5)
1170 IF RND(1) > .1 THEN 2190
1180 LET F = -1
1190 LET X3 = X
1200 LET X = X + (1 - 2 * P) * Y
1210 IF ABS(X - 50) >= 50 THEN 1240
1220 PRINT "*** Fumble after ";
1230 GOTO 2230
1240 PRINT "*** Fumble."
1250 GOTO 2450
1260 REM  SHORT PASS
1270 LET Y = INT(60 * (R1 - .5) ^ 3 + 10)
1280 IF R < .05 THEN 1330
1290 IF R < .15 THEN 1390
1300 IF R < .55 THEN 1420
1310 PRINT "Complete.  ";
1320 GOTO 2190
1330 IF D = 4 THEN 1420
1340 PRINT "Intercepted."
1350 LET F = -1
1360 LET X = X + (1 - 2 * P) * Y
1370 IF ABS(X - 50) >= 50 THEN 2450
1380 GOTO 2300
1390 PRINT "Passer tackled. ";
1400 LET Y = -INT(10 * R1)
1410 GOTO 2190
1420 LET Y = 0
1430 IF RND(1) < .3 THEN 1460
1440 PRINT "Incomplete. ";
1450 GOTO 2190
1460 PRINT "Batted down. ";
1470 GOTO 2190
1480 REM  LONG PASS
1490 LET Y = INT(160 * (R1 - .5) ^ 3 + 30)
1500 IF R < .1 THEN 1330
1510 IF R < .3 THEN 1540
1520 IF R < .75 THEN 1420
1530 GOTO 1310
1540 PRINT "Passer tackled. ";
1550 LET Y = -INT(15 * R1 + 3)
1560 GOTO 2190
1570 REM  PUNT OR KICK
1580 LET Y = INT(100 * (R - .5) ^ 3 + 35)
1590 IF D = 4 THEN 1610
1600 LET Y = INT(Y * 1.3)
1610 PRINT Y; L$(3); "punt."
1620 IF ABS(X + Y * (1 - 2 * P) - 50) >= 50 THEN 1670
1630 IF D < 4 THEN 1670
1640 LET Y1 = INT(R1 ^ 2 * 20)
1650 PRINT Y1; L$(3); "run back."
1660 LET Y = Y - Y1
1670 GOTO 1350
1680 REM  PLACE KICK
1690 LET Y = INT(100 * (R - .5) ^ 3 + 35)
1700 IF R1 > .15 THEN 1740
1710 PRINT "Kick is blocked!"
1720 LET X = X - 5 * (1 - 2 * P)
1730 LET P = 1 - P
1740 GOTO 720
1750 LET X = X + (1 - 2 * P) * Y
1760 IF ABS(X - 50) >= 60 THEN 1810
1770 PRINT "Kick is short."
1780 IF ABS(X - 50) >= 50 THEN 2710
1790 P = 1 - P
1800 GOTO 630
1810 IF R1 > .5 THEN 1840
1820 PRINT "Kick is off to the side."
1830 GOTO 2710
1840 PRINT "Field goal!!!"
1850 LET S(P) = S(P) + 3
1860 GOTO 2640
1870 REM  OPPONENT'S PLAY
1880 IF D > 1 THEN 1940
1890 IF RND(1) > 1 / 3 THEN 1920
1900 LET Z = 3
1910 GOTO 1010
1920 LET Z = 1
1930 GOTO 1010
1940 IF D = 4 THEN 2090
1950 IF 10 + X - X1 < 5 THEN 1890
1960 IF X < 5 THEN 1890
1970 IF X <= 10 THEN 2160
1980 IF X > X1 THEN 2020
1990 LET A = INT(2 * RND(1))
2000 LET Z = 2 + A * 2
2010 GOTO 1010
2020 IF D < 3 THEN 1990
2030 IF X < 45 THEN 1990
2040 IF RND(1) > 1 / 4 THEN 2070
2050 LET Z = 6
2060 GOTO 1010
2070 LET Z = 4
2080 GOTO 1010
2090 IF X > 30 THEN 2140
2100 IF 10 + X - X1 < 3 THEN 1890
2110 IF X < 3 THEN 1890
2120 LET Z = 7
2130 GOTO 1010
2140 LET Z = 5
2150 GOTO 1010
2160 LET A = INT(2 * RND(1))
2170 LET Z = 2 + A
2180 GOTO 1010
2190 REM GAIN OR LOSS
2200 LET X3 = X
2210 LET X = X + (1 - 2 * P) * Y
2220 IF ABS(X - 50) >= 50 THEN 2450
2230 IF Y = 0 THEN 2250
2240 PRINT ABS(Y); L$(3);
2250 PRINT L$(15 + SGN(Y))
2280 IF ABS(X3 - 50) > 40 THEN 2300
2290 IF RND(1) < .1 THEN 2860
2300 GOSUB 800
2310 IF F = 0 THEN 2340
2320 LET P = 1 - P
2330 GOTO 740
2340 IF (P * (X1 - X) + (1 - P) * (X - X1)) >= 10 THEN 740
2350 IF D = 4 THEN 2320
2360 LET D = D + 1
2370 PRINT "Down:";: COLOR 12: PRINT D; " ";: COLOR 15
2380 IF (X1 - 50) * (1 - 2 * P) < 40 THEN 2410
2390 PRINT "Goal to go."
2400 GOTO 2420
2410 PRINT "Yards to go:";: COLOR 12: PRINT 10 - (P * (X1 - X) + (1 - P) * (X - X1)): COLOR 15
2420 PRINT
2440 GOTO 860
2450 REM BALL IN END-ZONE
2460 IF X >= 100 THEN 2490
2470 LET E = 0
2480 GOTO 2500
2490 LET E = 1
2500 ON 1 + E - F * 2 + P * 4 GOTO 2510, 2590, 2760, 2710, 2590, 2510, 2710, 2760
2510 REM SAFETY
2520 LET S(1 - P) = S(1 - P) + 2
2530 PRINT L$(19)
2540 GOSUB 2800
2550 PRINT O$(P); " kicks off from its 20 yard line."
2560 LET X = 20 + P * 60
2570 LET P = 1 - P
2580 GOTO 590
2590 REM OFFENSIVE TD
2600 PRINT L$(17); "!!!"
2610 IF RND(1) > .8 THEN 2680
2620 LET S(P) = S(P) + 7
2630 PRINT "Kick is good."
2640 GOSUB 2800
2650 PRINT O$(P); " kicks off."
2660 LET P = 1 - P
2670 GOTO 580
2680 PRINT "Kick is off to the side."
2690 LET S(P) = S(P) + 6
2700 GOTO 2640
2710 REM TOUCHBACK
2720 PRINT L$(18)
2730 LET P = 1 - P
2740 LET X = 20 + P * 60
2750 GOTO 720
2760 REM DEFENSIVE TD
2770 PRINT L$(17); " for "; O$(1 - P); "!!!"
2780 LET P = 1 - P
2790 GOTO 2600
2800 REM SCORE
2810 PRINT
2820 PRINT "Score:  ";: COLOR 11: PRINT S(0);: COLOR 15: PRINT " to ";: COLOR 13: PRINT S(1): COLOR 15
2830 PRINT
2840 PRINT
2850 RETURN
2860 REM PENALTY
2870 LET P3 = INT(2 * RND(1))
2880 PRINT O$(P3); " offsides -- penalty of 5 yards."
2890 PRINT
2900 PRINT
2910 IF P3 = 0 THEN 2980
2920 COLOR 10: PRINT "Do you accept the penalty (Y/N)";
2930 INPUT A$: COLOR 15
2940 IF LEFT$(A$, 1) = "N" OR LEFT$(A$, 1) = "n" THEN 2300
2950 IF LEFT$(A$, 1) = "Y" OR LEFT$(A$, 1) = "y" THEN 3110
2960 COLOR 10: PRINT "Type 'Y' or 'N'";
2970 GOTO 2930
2980 REM OPPONENT'S STRATEGY ON PENALTY
2990 IF P = 1 THEN 3040
3000 IF Y <= 0 THEN 3080
3010 IF F < 0 THEN 3080
3020 IF (P * (X1 - X) + (1 - P) * (X - X1)) < 3 * D - 2 THEN 3080
3030 GOTO 3100
3040 IF Y <= 5 THEN 3100
3050 IF F < 0 THEN 3100
3060 IF D < 4 THEN 3080
3070 IF (P * (X1 - X) + (1 - P) * (X - X1)) < 10 THEN 3100
3080 PRINT "Penalty refused."
3090 GOTO 2300
3100 PRINT "Penalty accepted."
3110 LET F = 0
3120 LET D = D - 1
3130 IF P <> P3 THEN 3160
3140 LET X = X3 - (1 - 2 * P) * 5
3150 GOTO 2300
3160 LET X = X3 + (1 - 2 * P) * 5
3170 GOTO 2300
3180 END

